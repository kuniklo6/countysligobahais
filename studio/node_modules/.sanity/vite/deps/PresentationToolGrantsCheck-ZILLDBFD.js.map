{
  "version": 3,
  "sources": ["../../../sanity/node_modules/uuid/dist/esm-browser/regex.js", "../../../sanity/node_modules/uuid/dist/esm-browser/validate.js", "../../../sanity/node_modules/uuid/dist/esm-browser/parse.js", "../../../sanity/node_modules/uuid/dist/esm-browser/stringify.js", "../../../sanity/node_modules/uuid/dist/esm-browser/rng.js", "../../../sanity/node_modules/uuid/dist/esm-browser/md5.js", "../../../sanity/node_modules/uuid/dist/esm-browser/v35.js", "../../../sanity/node_modules/uuid/dist/esm-browser/v3.js", "../../../sanity/node_modules/uuid/dist/esm-browser/native.js", "../../../sanity/node_modules/uuid/dist/esm-browser/v4.js", "../../../sanity/node_modules/uuid/dist/esm-browser/sha1.js", "../../../sanity/node_modules/uuid/dist/esm-browser/v5.js", "../../../@sanity/preview-url-secret/src/withoutSecretSearchParams.ts", "../../../@sanity/preview-url-secret/src/generateSecret.ts", "../../../@sanity/preview-url-secret/src/togglePreviewAccessSharing.ts", "../../../path-to-regexp/src/index.ts", "../../../@sanity/preview-url-secret/src/createPreviewSecret.ts", "../../../@sanity/preview-url-secret/src/toggleVercelProtectionBypass.ts", "../../../sanity/src/presentation/features/PostMessageFeatures.tsx", "../../../sanity/src/presentation/machines/presentation-machine.ts", "../../../sanity/src/presentation/overlays/SharedStateProvider.tsx", "../../../sanity/src/presentation/panels/Panel.tsx", "../../../sanity/src/presentation/util/debounce.ts", "../../../sanity/src/presentation/panels/usePanelsStorage.ts", "../../../sanity/src/presentation/panels/util.ts", "../../../sanity/src/presentation/panels/Panels.tsx", "../../../sanity/src/presentation/components/ErrorCard.tsx", "../../../sanity/src/presentation/paneRouter/ChildLink.tsx", "../../../sanity/src/presentation/paneRouter/ReferenceChildLink.tsx", "../../../sanity/src/presentation/paneRouter/PresentationPaneRouterProvider.tsx", "../../../sanity/src/presentation/editor/DocumentListPane.tsx", "../../../sanity/src/presentation/editor/DocumentPane.tsx", "../../../sanity/src/presentation/editor/DocumentPanel.tsx", "../../../sanity/src/presentation/editor/usePreviewState.ts", "../../../sanity/src/presentation/editor/ContentEditor.tsx", "../../../sanity/src/presentation/panels/usePanelId.ts", "../../../sanity/src/presentation/panels/PanelResizer.tsx", "../../../sanity/src/presentation/PresentationContent.tsx", "../../../sanity/src/presentation/PresentationNavigateProvider.tsx", "../../../sanity/src/presentation/useLocalState.ts", "../../../sanity/src/presentation/PresentationNavigator.tsx", "../../../sanity/src/presentation/PresentationParamsProvider.tsx", "../../../sanity/src/presentation/PresentationProvider.tsx", "../../../sanity/src/presentation/useAllowPatterns.ts", "../../../sanity/src/presentation/util/encodeStudioPerspective.ts", "../../../sanity/src/presentation/useId.ts", "../../../sanity/src/presentation/preview/IFrame.tsx", "../../../sanity/src/presentation/preview/OpenPreviewButton.tsx", "../../../sanity/src/presentation/useTargetOrigin.ts", "../../../sanity/src/presentation/preview/PreviewLocationInput.tsx", "../../../sanity/src/presentation/preview/SharePreviewMenu.tsx", "../../../sanity/src/presentation/preview/PreviewHeader.tsx", "../../../sanity/src/presentation/preview/Preview.tsx", "../../../sanity/src/presentation/util/warnOnce.ts", "../../../sanity/src/presentation/useDocumentsOnPage.ts", "../../../sanity/src/presentation/useMainDocument.ts", "../../../sanity/src/presentation/util/parse.ts", "../../../sanity/src/presentation/useParams.ts", "../../../sanity/src/presentation/usePopups.ts", "../../../sanity/src/presentation/usePresentationPerspective.ts", "../../../sanity/src/presentation/useStatus.ts", "../../../sanity/src/presentation/PresentationTool.tsx", "../../../sanity/src/presentation/actors/create-preview-secret.ts", "../../../sanity/src/presentation/actors/read-shared-secret.ts", "../../../sanity/src/presentation/actors/resolve-allow-patterns.ts", "../../../sanity/src/presentation/actors/resolve-initial-url.ts", "../../../sanity/src/presentation/actors/resolve-preview-mode.ts", "../../../sanity/src/presentation/actors/resolve-preview-mode-url.ts", "../../../sanity/src/presentation/actors/resolve-url-from-preview-search-param.ts", "../../../sanity/src/presentation/machines/preview-url.ts", "../../../sanity/src/presentation/usePreviewUrlActorRef.ts", "../../../sanity/src/presentation/useReportInvalidPreviewSearchParam.tsx", "../../../sanity/src/presentation/useVercelBypassSecret.ts", "../../../sanity/src/presentation/PresentationToolGrantsCheck.tsx"],
  "sourcesContent": ["export default /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;\n", "import REGEX from './regex.js';\nfunction validate(uuid) {\n    return typeof uuid === 'string' && REGEX.test(uuid);\n}\nexport default validate;\n", "import validate from './validate.js';\nfunction parse(uuid) {\n    if (!validate(uuid)) {\n        throw TypeError('Invalid UUID');\n    }\n    let v;\n    return Uint8Array.of((v = parseInt(uuid.slice(0, 8), 16)) >>> 24, (v >>> 16) & 0xff, (v >>> 8) & 0xff, v & 0xff, (v = parseInt(uuid.slice(9, 13), 16)) >>> 8, v & 0xff, (v = parseInt(uuid.slice(14, 18), 16)) >>> 8, v & 0xff, (v = parseInt(uuid.slice(19, 23), 16)) >>> 8, v & 0xff, ((v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000) & 0xff, (v / 0x100000000) & 0xff, (v >>> 24) & 0xff, (v >>> 16) & 0xff, (v >>> 8) & 0xff, v & 0xff);\n}\nexport default parse;\n", "import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n", "let getRandomValues;\nconst rnds8 = new Uint8Array(16);\nexport default function rng() {\n    if (!getRandomValues) {\n        if (typeof crypto === 'undefined' || !crypto.getRandomValues) {\n            throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n        }\n        getRandomValues = crypto.getRandomValues.bind(crypto);\n    }\n    return getRandomValues(rnds8);\n}\n", "function md5(bytes) {\n    const words = uint8ToUint32(bytes);\n    const md5Bytes = wordsToMd5(words, bytes.length * 8);\n    return uint32ToUint8(md5Bytes);\n}\nfunction uint32ToUint8(input) {\n    const bytes = new Uint8Array(input.length * 4);\n    for (let i = 0; i < input.length * 4; i++) {\n        bytes[i] = (input[i >> 2] >>> ((i % 4) * 8)) & 0xff;\n    }\n    return bytes;\n}\nfunction getOutputLength(inputLength8) {\n    return (((inputLength8 + 64) >>> 9) << 4) + 14 + 1;\n}\nfunction wordsToMd5(x, len) {\n    const xpad = new Uint32Array(getOutputLength(len)).fill(0);\n    xpad.set(x);\n    xpad[len >> 5] |= 0x80 << len % 32;\n    xpad[xpad.length - 1] = len;\n    x = xpad;\n    let a = 1732584193;\n    let b = -271733879;\n    let c = -1732584194;\n    let d = 271733878;\n    for (let i = 0; i < x.length; i += 16) {\n        const olda = a;\n        const oldb = b;\n        const oldc = c;\n        const oldd = d;\n        a = md5ff(a, b, c, d, x[i], 7, -680876936);\n        d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n        c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n        b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n        a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n        d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n        c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n        b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n        a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n        d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n        c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n        b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n        a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n        d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n        c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n        b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n        a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n        d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n        c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n        b = md5gg(b, c, d, a, x[i], 20, -373897302);\n        a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n        d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n        c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n        b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n        a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n        d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n        c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n        b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n        a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n        d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n        c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n        b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n        a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n        d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n        c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n        b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n        a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n        d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n        c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n        b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n        a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n        d = md5hh(d, a, b, c, x[i], 11, -358537222);\n        c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n        b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n        a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n        d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n        c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n        b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n        a = md5ii(a, b, c, d, x[i], 6, -198630844);\n        d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n        c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n        b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n        a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n        d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n        c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n        b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n        a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n        d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n        c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n        b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n        a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n        d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n        c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n        b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n        a = safeAdd(a, olda);\n        b = safeAdd(b, oldb);\n        c = safeAdd(c, oldc);\n        d = safeAdd(d, oldd);\n    }\n    return Uint32Array.of(a, b, c, d);\n}\nfunction uint8ToUint32(input) {\n    if (input.length === 0) {\n        return new Uint32Array();\n    }\n    const output = new Uint32Array(getOutputLength(input.length * 8)).fill(0);\n    for (let i = 0; i < input.length; i++) {\n        output[i >> 2] |= (input[i] & 0xff) << ((i % 4) * 8);\n    }\n    return output;\n}\nfunction safeAdd(x, y) {\n    const lsw = (x & 0xffff) + (y & 0xffff);\n    const msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n    return (msw << 16) | (lsw & 0xffff);\n}\nfunction bitRotateLeft(num, cnt) {\n    return (num << cnt) | (num >>> (32 - cnt));\n}\nfunction md5cmn(q, a, b, x, s, t) {\n    return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\nfunction md5ff(a, b, c, d, x, s, t) {\n    return md5cmn((b & c) | (~b & d), a, b, x, s, t);\n}\nfunction md5gg(a, b, c, d, x, s, t) {\n    return md5cmn((b & d) | (c & ~d), a, b, x, s, t);\n}\nfunction md5hh(a, b, c, d, x, s, t) {\n    return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\nfunction md5ii(a, b, c, d, x, s, t) {\n    return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\nexport default md5;\n", "import parse from './parse.js';\nimport { unsafeStringify } from './stringify.js';\nexport function stringToBytes(str) {\n    str = unescape(encodeURIComponent(str));\n    const bytes = new Uint8Array(str.length);\n    for (let i = 0; i < str.length; ++i) {\n        bytes[i] = str.charCodeAt(i);\n    }\n    return bytes;\n}\nexport const DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexport const URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexport default function v35(version, hash, value, namespace, buf, offset) {\n    const valueBytes = typeof value === 'string' ? stringToBytes(value) : value;\n    const namespaceBytes = typeof namespace === 'string' ? parse(namespace) : namespace;\n    if (typeof namespace === 'string') {\n        namespace = parse(namespace);\n    }\n    if (namespace?.length !== 16) {\n        throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');\n    }\n    let bytes = new Uint8Array(16 + valueBytes.length);\n    bytes.set(namespaceBytes);\n    bytes.set(valueBytes, namespaceBytes.length);\n    bytes = hash(bytes);\n    bytes[6] = (bytes[6] & 0x0f) | version;\n    bytes[8] = (bytes[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = bytes[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(bytes);\n}\n", "import md5 from './md5.js';\nimport v35, { DNS, URL } from './v35.js';\nexport { DNS, URL } from './v35.js';\nfunction v3(value, namespace, buf, offset) {\n    return v35(0x30, md5, value, namespace, buf, offset);\n}\nv3.DNS = DNS;\nv3.URL = URL;\nexport default v3;\n", "const randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default { randomUUID };\n", "import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nexport default v4;\n", "function f(s, x, y, z) {\n    switch (s) {\n        case 0:\n            return (x & y) ^ (~x & z);\n        case 1:\n            return x ^ y ^ z;\n        case 2:\n            return (x & y) ^ (x & z) ^ (y & z);\n        case 3:\n            return x ^ y ^ z;\n    }\n}\nfunction ROTL(x, n) {\n    return (x << n) | (x >>> (32 - n));\n}\nfunction sha1(bytes) {\n    const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n    const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n    const newBytes = new Uint8Array(bytes.length + 1);\n    newBytes.set(bytes);\n    newBytes[bytes.length] = 0x80;\n    bytes = newBytes;\n    const l = bytes.length / 4 + 2;\n    const N = Math.ceil(l / 16);\n    const M = new Array(N);\n    for (let i = 0; i < N; ++i) {\n        const arr = new Uint32Array(16);\n        for (let j = 0; j < 16; ++j) {\n            arr[j] =\n                (bytes[i * 64 + j * 4] << 24) |\n                    (bytes[i * 64 + j * 4 + 1] << 16) |\n                    (bytes[i * 64 + j * 4 + 2] << 8) |\n                    bytes[i * 64 + j * 4 + 3];\n        }\n        M[i] = arr;\n    }\n    M[N - 1][14] = ((bytes.length - 1) * 8) / Math.pow(2, 32);\n    M[N - 1][14] = Math.floor(M[N - 1][14]);\n    M[N - 1][15] = ((bytes.length - 1) * 8) & 0xffffffff;\n    for (let i = 0; i < N; ++i) {\n        const W = new Uint32Array(80);\n        for (let t = 0; t < 16; ++t) {\n            W[t] = M[i][t];\n        }\n        for (let t = 16; t < 80; ++t) {\n            W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);\n        }\n        let a = H[0];\n        let b = H[1];\n        let c = H[2];\n        let d = H[3];\n        let e = H[4];\n        for (let t = 0; t < 80; ++t) {\n            const s = Math.floor(t / 20);\n            const T = (ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t]) >>> 0;\n            e = d;\n            d = c;\n            c = ROTL(b, 30) >>> 0;\n            b = a;\n            a = T;\n        }\n        H[0] = (H[0] + a) >>> 0;\n        H[1] = (H[1] + b) >>> 0;\n        H[2] = (H[2] + c) >>> 0;\n        H[3] = (H[3] + d) >>> 0;\n        H[4] = (H[4] + e) >>> 0;\n    }\n    return Uint8Array.of(H[0] >> 24, H[0] >> 16, H[0] >> 8, H[0], H[1] >> 24, H[1] >> 16, H[1] >> 8, H[1], H[2] >> 24, H[2] >> 16, H[2] >> 8, H[2], H[3] >> 24, H[3] >> 16, H[3] >> 8, H[3], H[4] >> 24, H[4] >> 16, H[4] >> 8, H[4]);\n}\nexport default sha1;\n", "import sha1 from './sha1.js';\nimport v35, { DNS, URL } from './v35.js';\nexport { DNS, URL } from './v35.js';\nfunction v5(value, namespace, buf, offset) {\n    return v35(0x50, sha1, value, namespace, buf, offset);\n}\nv5.DNS = DNS;\nv5.URL = URL;\nexport default v5;\n", "import {\n  urlSearchParamPreviewPathname,\n  urlSearchParamPreviewPerspective,\n  urlSearchParamPreviewSecret,\n  urlSearchParamVercelProtectionBypass,\n  urlSearchParamVercelSetBypassCookie,\n} from './constants'\n\n/** @alpha */\nexport function withoutSecretSearchParams(url: URL): URL {\n  const newUrl = new URL(url)\n  const {searchParams} = newUrl\n  searchParams.delete(urlSearchParamPreviewPathname)\n  searchParams.delete(urlSearchParamPreviewSecret)\n  searchParams.delete(urlSearchParamPreviewPerspective)\n  searchParams.delete(urlSearchParamVercelProtectionBypass)\n  searchParams.delete(urlSearchParamVercelSetBypassCookie)\n  return newUrl\n}\n\n/** @alpha */\nexport function hasSecretSearchParams(url: URL): boolean {\n  return url.searchParams.has(urlSearchParamPreviewSecret)\n}\n\n/** @alpha */\nexport function setSecretSearchParams(\n  url: URL,\n  secret: string | null,\n  redirectTo: string,\n  perspective: string,\n): URL {\n  const newUrl = new URL(url)\n  const {searchParams} = newUrl\n  // Preview secrets are added when preview mode is setup with an `enable` endpoint\n  if (secret) {\n    searchParams.set(urlSearchParamPreviewSecret, secret)\n    searchParams.set(urlSearchParamPreviewPathname, redirectTo)\n  }\n  // Always set the perspective that's being used\n  searchParams.set(urlSearchParamPreviewPerspective, perspective)\n\n  return newUrl\n}\n", "/* eslint-disable @typescript-eslint/no-non-null-assertion */\n/** @internal */\nexport function generateUrlSecret(): string {\n  // Try using WebCrypto if available\n  if (typeof crypto !== 'undefined') {\n    // Generate a random array of 16 bytes\n    const array = new Uint8Array(16)\n    crypto.getRandomValues(array)\n\n    // Convert the array to a URL-safe string\n    let key = ''\n    for (let i = 0; i < array.length; i++) {\n      // Convert each byte to a 2-digit hexadecimal number\n      key += array[i]!.toString(16).padStart(2, '0')\n    }\n\n    // Replace '+' and '/' from base64url to '-' and '_'\n    key = btoa(key).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/[=]+$/, '')\n\n    return key\n  }\n  // If not fallback to Math.random\n  return Math.random().toString(36).slice(2)\n}\n", "import type {SanityClient} from '@sanity/client'\n\nimport type {SanityClientLike} from './types'\n\nimport {schemaIdSingleton as _id, schemaTypeSingleton as _type, apiVersion, tag} from './constants'\nimport {generateUrlSecret} from './generateSecret'\n\n/** @internal */\nexport async function enablePreviewAccessSharing(\n  _client: SanityClient,\n  source: string,\n  studioUrl: string,\n  userId?: string,\n): Promise<{secret: string}> {\n  const client = _client.withConfig({apiVersion})\n  const newSecret = generateUrlSecret()\n  const patch = client.patch(_id).set({secret: newSecret, studioUrl, userId})\n  await client\n    .transaction()\n    .createIfNotExists({_id, _type, source, studioUrl, userId})\n    .patch(patch)\n    .commit({tag})\n\n  return {secret: newSecret}\n}\n\n/** @internal */\nexport async function disablePreviewAccessSharing(\n  _client: SanityClient,\n  source: string,\n  studioUrl: string,\n  userId?: string,\n): Promise<void> {\n  const client = _client.withConfig({apiVersion})\n  const patch = client.patch(_id).set({secret: null, studioUrl, userId})\n  await client\n    .transaction()\n    .createIfNotExists({_id, _type, source, studioUrl, userId})\n    .patch(patch)\n    .commit({tag})\n}\n\nexport type {SanityClientLike}\n", "/**\n * Tokenizer results.\n */\ninterface LexToken {\n  type:\n    | \"OPEN\"\n    | \"CLOSE\"\n    | \"PATTERN\"\n    | \"NAME\"\n    | \"CHAR\"\n    | \"ESCAPED_CHAR\"\n    | \"MODIFIER\"\n    | \"END\";\n  index: number;\n  value: string;\n}\n\n/**\n * Tokenize input string.\n */\nfunction lexer(str: string): LexToken[] {\n  const tokens: LexToken[] = [];\n  let i = 0;\n\n  while (i < str.length) {\n    const char = str[i];\n\n    if (char === \"*\" || char === \"+\" || char === \"?\") {\n      tokens.push({ type: \"MODIFIER\", index: i, value: str[i++] });\n      continue;\n    }\n\n    if (char === \"\\\\\") {\n      tokens.push({ type: \"ESCAPED_CHAR\", index: i++, value: str[i++] });\n      continue;\n    }\n\n    if (char === \"{\") {\n      tokens.push({ type: \"OPEN\", index: i, value: str[i++] });\n      continue;\n    }\n\n    if (char === \"}\") {\n      tokens.push({ type: \"CLOSE\", index: i, value: str[i++] });\n      continue;\n    }\n\n    if (char === \":\") {\n      let name = \"\";\n      let j = i + 1;\n\n      while (j < str.length) {\n        const code = str.charCodeAt(j);\n\n        if (\n          // `0-9`\n          (code >= 48 && code <= 57) ||\n          // `A-Z`\n          (code >= 65 && code <= 90) ||\n          // `a-z`\n          (code >= 97 && code <= 122) ||\n          // `_`\n          code === 95\n        ) {\n          name += str[j++];\n          continue;\n        }\n\n        break;\n      }\n\n      if (!name) throw new TypeError(`Missing parameter name at ${i}`);\n\n      tokens.push({ type: \"NAME\", index: i, value: name });\n      i = j;\n      continue;\n    }\n\n    if (char === \"(\") {\n      let count = 1;\n      let pattern = \"\";\n      let j = i + 1;\n\n      if (str[j] === \"?\") {\n        throw new TypeError(`Pattern cannot start with \"?\" at ${j}`);\n      }\n\n      while (j < str.length) {\n        if (str[j] === \"\\\\\") {\n          pattern += str[j++] + str[j++];\n          continue;\n        }\n\n        if (str[j] === \")\") {\n          count--;\n          if (count === 0) {\n            j++;\n            break;\n          }\n        } else if (str[j] === \"(\") {\n          count++;\n          if (str[j + 1] !== \"?\") {\n            throw new TypeError(`Capturing groups are not allowed at ${j}`);\n          }\n        }\n\n        pattern += str[j++];\n      }\n\n      if (count) throw new TypeError(`Unbalanced pattern at ${i}`);\n      if (!pattern) throw new TypeError(`Missing pattern at ${i}`);\n\n      tokens.push({ type: \"PATTERN\", index: i, value: pattern });\n      i = j;\n      continue;\n    }\n\n    tokens.push({ type: \"CHAR\", index: i, value: str[i++] });\n  }\n\n  tokens.push({ type: \"END\", index: i, value: \"\" });\n\n  return tokens;\n}\n\nexport interface ParseOptions {\n  /**\n   * Set the default delimiter for repeat parameters. (default: `'/'`)\n   */\n  delimiter?: string;\n  /**\n   * List of characters to automatically consider prefixes when parsing.\n   */\n  prefixes?: string;\n}\n\n/**\n * Parse a string for the raw tokens.\n */\nexport function parse(str: string, options: ParseOptions = {}): Token[] {\n  const tokens = lexer(str);\n  const { prefixes = \"./\", delimiter = \"/#?\" } = options;\n  const result: Token[] = [];\n  let key = 0;\n  let i = 0;\n  let path = \"\";\n\n  const tryConsume = (type: LexToken[\"type\"]): string | undefined => {\n    if (i < tokens.length && tokens[i].type === type) return tokens[i++].value;\n  };\n\n  const mustConsume = (type: LexToken[\"type\"]): string => {\n    const value = tryConsume(type);\n    if (value !== undefined) return value;\n    const { type: nextType, index } = tokens[i];\n    throw new TypeError(`Unexpected ${nextType} at ${index}, expected ${type}`);\n  };\n\n  const consumeText = (): string => {\n    let result = \"\";\n    let value: string | undefined;\n    while ((value = tryConsume(\"CHAR\") || tryConsume(\"ESCAPED_CHAR\"))) {\n      result += value;\n    }\n    return result;\n  };\n\n  const isSafe = (value: string): boolean => {\n    for (const char of delimiter) if (value.indexOf(char) > -1) return true;\n    return false;\n  };\n\n  const safePattern = (prefix: string) => {\n    const prev = result[result.length - 1];\n    const prevText = prefix || (prev && typeof prev === \"string\" ? prev : \"\");\n\n    if (prev && !prevText) {\n      throw new TypeError(\n        `Must have text between two parameters, missing text after \"${(prev as Key).name}\"`,\n      );\n    }\n\n    if (!prevText || isSafe(prevText)) return `[^${escapeString(delimiter)}]+?`;\n    return `(?:(?!${escapeString(prevText)})[^${escapeString(delimiter)}])+?`;\n  };\n\n  while (i < tokens.length) {\n    const char = tryConsume(\"CHAR\");\n    const name = tryConsume(\"NAME\");\n    const pattern = tryConsume(\"PATTERN\");\n\n    if (name || pattern) {\n      let prefix = char || \"\";\n\n      if (prefixes.indexOf(prefix) === -1) {\n        path += prefix;\n        prefix = \"\";\n      }\n\n      if (path) {\n        result.push(path);\n        path = \"\";\n      }\n\n      result.push({\n        name: name || key++,\n        prefix,\n        suffix: \"\",\n        pattern: pattern || safePattern(prefix),\n        modifier: tryConsume(\"MODIFIER\") || \"\",\n      });\n      continue;\n    }\n\n    const value = char || tryConsume(\"ESCAPED_CHAR\");\n    if (value) {\n      path += value;\n      continue;\n    }\n\n    if (path) {\n      result.push(path);\n      path = \"\";\n    }\n\n    const open = tryConsume(\"OPEN\");\n    if (open) {\n      const prefix = consumeText();\n      const name = tryConsume(\"NAME\") || \"\";\n      const pattern = tryConsume(\"PATTERN\") || \"\";\n      const suffix = consumeText();\n\n      mustConsume(\"CLOSE\");\n\n      result.push({\n        name: name || (pattern ? key++ : \"\"),\n        pattern: name && !pattern ? safePattern(prefix) : pattern,\n        prefix,\n        suffix,\n        modifier: tryConsume(\"MODIFIER\") || \"\",\n      });\n      continue;\n    }\n\n    mustConsume(\"END\");\n  }\n\n  return result;\n}\n\nexport interface TokensToFunctionOptions {\n  /**\n   * When `true` the regexp will be case sensitive. (default: `false`)\n   */\n  sensitive?: boolean;\n  /**\n   * Function for encoding input strings for output.\n   */\n  encode?: (value: string, token: Key) => string;\n  /**\n   * When `false` the function can produce an invalid (unmatched) path. (default: `true`)\n   */\n  validate?: boolean;\n}\n\n/**\n * Compile a string to a template function for the path.\n */\nexport function compile<P extends object = object>(\n  str: string,\n  options?: ParseOptions & TokensToFunctionOptions,\n) {\n  return tokensToFunction<P>(parse(str, options), options);\n}\n\nexport type PathFunction<P extends object = object> = (data?: P) => string;\n\n/**\n * Expose a method for transforming tokens into the path function.\n */\nexport function tokensToFunction<P extends object = object>(\n  tokens: Token[],\n  options: TokensToFunctionOptions = {},\n): PathFunction<P> {\n  const reFlags = flags(options);\n  const { encode = (x: string) => x, validate = true } = options;\n\n  // Compile all the tokens into regexps.\n  const matches = tokens.map((token) => {\n    if (typeof token === \"object\") {\n      return new RegExp(`^(?:${token.pattern})$`, reFlags);\n    }\n  });\n\n  return (data: Record<string, any> | null | undefined) => {\n    let path = \"\";\n\n    for (let i = 0; i < tokens.length; i++) {\n      const token = tokens[i];\n\n      if (typeof token === \"string\") {\n        path += token;\n        continue;\n      }\n\n      const value = data ? data[token.name] : undefined;\n      const optional = token.modifier === \"?\" || token.modifier === \"*\";\n      const repeat = token.modifier === \"*\" || token.modifier === \"+\";\n\n      if (Array.isArray(value)) {\n        if (!repeat) {\n          throw new TypeError(\n            `Expected \"${token.name}\" to not repeat, but got an array`,\n          );\n        }\n\n        if (value.length === 0) {\n          if (optional) continue;\n\n          throw new TypeError(`Expected \"${token.name}\" to not be empty`);\n        }\n\n        for (let j = 0; j < value.length; j++) {\n          const segment = encode(value[j], token);\n\n          if (validate && !(matches[i] as RegExp).test(segment)) {\n            throw new TypeError(\n              `Expected all \"${token.name}\" to match \"${token.pattern}\", but got \"${segment}\"`,\n            );\n          }\n\n          path += token.prefix + segment + token.suffix;\n        }\n\n        continue;\n      }\n\n      if (typeof value === \"string\" || typeof value === \"number\") {\n        const segment = encode(String(value), token);\n\n        if (validate && !(matches[i] as RegExp).test(segment)) {\n          throw new TypeError(\n            `Expected \"${token.name}\" to match \"${token.pattern}\", but got \"${segment}\"`,\n          );\n        }\n\n        path += token.prefix + segment + token.suffix;\n        continue;\n      }\n\n      if (optional) continue;\n\n      const typeOfMessage = repeat ? \"an array\" : \"a string\";\n      throw new TypeError(`Expected \"${token.name}\" to be ${typeOfMessage}`);\n    }\n\n    return path;\n  };\n}\n\nexport interface RegexpToFunctionOptions {\n  /**\n   * Function for decoding strings for params.\n   */\n  decode?: (value: string, token: Key) => string;\n}\n\n/**\n * A match result contains data about the path match.\n */\nexport interface MatchResult<P extends object = object> {\n  path: string;\n  index: number;\n  params: P;\n}\n\n/**\n * A match is either `false` (no match) or a match result.\n */\nexport type Match<P extends object = object> = false | MatchResult<P>;\n\n/**\n * The match function takes a string and returns whether it matched the path.\n */\nexport type MatchFunction<P extends object = object> = (\n  path: string,\n) => Match<P>;\n\n/**\n * Create path match function from `path-to-regexp` spec.\n */\nexport function match<P extends object = object>(\n  str: Path,\n  options?: ParseOptions & TokensToRegexpOptions & RegexpToFunctionOptions,\n) {\n  const keys: Key[] = [];\n  const re = pathToRegexp(str, keys, options);\n  return regexpToFunction<P>(re, keys, options);\n}\n\n/**\n * Create a path match function from `path-to-regexp` output.\n */\nexport function regexpToFunction<P extends object = object>(\n  re: RegExp,\n  keys: Key[],\n  options: RegexpToFunctionOptions = {},\n): MatchFunction<P> {\n  const { decode = (x: string) => x } = options;\n\n  return function (pathname: string) {\n    const m = re.exec(pathname);\n    if (!m) return false;\n\n    const { 0: path, index } = m;\n    const params = Object.create(null);\n\n    for (let i = 1; i < m.length; i++) {\n      if (m[i] === undefined) continue;\n\n      const key = keys[i - 1];\n\n      if (key.modifier === \"*\" || key.modifier === \"+\") {\n        params[key.name] = m[i].split(key.prefix + key.suffix).map((value) => {\n          return decode(value, key);\n        });\n      } else {\n        params[key.name] = decode(m[i], key);\n      }\n    }\n\n    return { path, index, params };\n  };\n}\n\n/**\n * Escape a regular expression string.\n */\nfunction escapeString(str: string) {\n  return str.replace(/([.+*?=^!:${}()[\\]|/\\\\])/g, \"\\\\$1\");\n}\n\n/**\n * Get the flags for a regexp from the options.\n */\nfunction flags(options?: { sensitive?: boolean }) {\n  return options && options.sensitive ? \"\" : \"i\";\n}\n\n/**\n * Metadata about a key.\n */\nexport interface Key {\n  name: string | number;\n  prefix: string;\n  suffix: string;\n  pattern: string;\n  modifier: string;\n}\n\n/**\n * A token is a string (nothing special) or key metadata (capture group).\n */\nexport type Token = string | Key;\n\n/**\n * Pull out keys from a regexp.\n */\nfunction regexpToRegexp(path: RegExp, keys?: Key[]): RegExp {\n  if (!keys) return path;\n\n  const groupsRegex = /\\((?:\\?<(.*?)>)?(?!\\?)/g;\n\n  let index = 0;\n  let execResult = groupsRegex.exec(path.source);\n  while (execResult) {\n    keys.push({\n      // Use parenthesized substring match if available, index otherwise\n      name: execResult[1] || index++,\n      prefix: \"\",\n      suffix: \"\",\n      modifier: \"\",\n      pattern: \"\",\n    });\n    execResult = groupsRegex.exec(path.source);\n  }\n\n  return path;\n}\n\n/**\n * Transform an array into a regexp.\n */\nfunction arrayToRegexp(\n  paths: Array<string | RegExp>,\n  keys?: Key[],\n  options?: TokensToRegexpOptions & ParseOptions,\n): RegExp {\n  const parts = paths.map((path) => pathToRegexp(path, keys, options).source);\n  return new RegExp(`(?:${parts.join(\"|\")})`, flags(options));\n}\n\n/**\n * Create a path regexp from string input.\n */\nfunction stringToRegexp(\n  path: string,\n  keys?: Key[],\n  options?: TokensToRegexpOptions & ParseOptions,\n) {\n  return tokensToRegexp(parse(path, options), keys, options);\n}\n\nexport interface TokensToRegexpOptions {\n  /**\n   * When `true` the regexp will be case sensitive. (default: `false`)\n   */\n  sensitive?: boolean;\n  /**\n   * When `true` the regexp won't allow an optional trailing delimiter to match. (default: `false`)\n   */\n  strict?: boolean;\n  /**\n   * When `true` the regexp will match to the end of the string. (default: `true`)\n   */\n  end?: boolean;\n  /**\n   * When `true` the regexp will match from the beginning of the string. (default: `true`)\n   */\n  start?: boolean;\n  /**\n   * Sets the final character for non-ending optimistic matches. (default: `/`)\n   */\n  delimiter?: string;\n  /**\n   * List of characters that can also be \"end\" characters.\n   */\n  endsWith?: string;\n  /**\n   * Encode path tokens for use in the `RegExp`.\n   */\n  encode?: (value: string) => string;\n}\n\n/**\n * Expose a function for taking tokens and returning a RegExp.\n */\nexport function tokensToRegexp(\n  tokens: Token[],\n  keys?: Key[],\n  options: TokensToRegexpOptions = {},\n) {\n  const {\n    strict = false,\n    start = true,\n    end = true,\n    encode = (x: string) => x,\n    delimiter = \"/#?\",\n    endsWith = \"\",\n  } = options;\n  const endsWithRe = `[${escapeString(endsWith)}]|$`;\n  const delimiterRe = `[${escapeString(delimiter)}]`;\n  let route = start ? \"^\" : \"\";\n\n  // Iterate over the tokens and create our regexp string.\n  for (const token of tokens) {\n    if (typeof token === \"string\") {\n      route += escapeString(encode(token));\n    } else {\n      const prefix = escapeString(encode(token.prefix));\n      const suffix = escapeString(encode(token.suffix));\n\n      if (token.pattern) {\n        if (keys) keys.push(token);\n\n        if (prefix || suffix) {\n          if (token.modifier === \"+\" || token.modifier === \"*\") {\n            const mod = token.modifier === \"*\" ? \"?\" : \"\";\n            route += `(?:${prefix}((?:${token.pattern})(?:${suffix}${prefix}(?:${token.pattern}))*)${suffix})${mod}`;\n          } else {\n            route += `(?:${prefix}(${token.pattern})${suffix})${token.modifier}`;\n          }\n        } else {\n          if (token.modifier === \"+\" || token.modifier === \"*\") {\n            throw new TypeError(\n              `Can not repeat \"${token.name}\" without a prefix and suffix`,\n            );\n          }\n\n          route += `(${token.pattern})${token.modifier}`;\n        }\n      } else {\n        route += `(?:${prefix}${suffix})${token.modifier}`;\n      }\n    }\n  }\n\n  if (end) {\n    if (!strict) route += `${delimiterRe}?`;\n\n    route += !options.endsWith ? \"$\" : `(?=${endsWithRe})`;\n  } else {\n    const endToken = tokens[tokens.length - 1];\n    const isEndDelimited =\n      typeof endToken === \"string\"\n        ? delimiterRe.indexOf(endToken[endToken.length - 1]) > -1\n        : endToken === undefined;\n\n    if (!strict) {\n      route += `(?:${delimiterRe}(?=${endsWithRe}))?`;\n    }\n\n    if (!isEndDelimited) {\n      route += `(?=${delimiterRe}|${endsWithRe})`;\n    }\n  }\n\n  return new RegExp(route, flags(options));\n}\n\n/**\n * Supported `path-to-regexp` input types.\n */\nexport type Path = string | RegExp | Array<string | RegExp>;\n\n/**\n * Normalize the given path string, returning a regular expression.\n *\n * An empty array can be passed in for the keys, which will hold the\n * placeholder key descriptions. For example, using `/user/:id`, `keys` will\n * contain `[{ name: 'id', delimiter: '/', optional: false, repeat: false }]`.\n */\nexport function pathToRegexp(\n  path: Path,\n  keys?: Key[],\n  options?: TokensToRegexpOptions & ParseOptions,\n) {\n  if (path instanceof RegExp) return regexpToRegexp(path, keys);\n  if (Array.isArray(path)) return arrayToRegexp(path, keys, options);\n  return stringToRegexp(path, keys, options);\n}\n", "import type {SanityClient} from '@sanity/client'\n\nimport {uuid} from '@sanity/uuid'\n\nimport type {SanityClientLike} from './types'\n\nimport {apiVersion, deleteExpiredSecretsQuery, schemaType, SECRET_TTL, tag} from './constants'\nimport {generateUrlSecret} from './generateSecret'\n\n/** @internal */\nexport async function createPreviewSecret(\n  _client: SanityClient,\n  source: string,\n  studioUrl: string,\n  userId?: string,\n  id = uuid(),\n): Promise<{secret: string; expiresAt: Date}> {\n  const client = _client.withConfig({apiVersion})\n\n  try {\n    const expiresAt = new Date(Date.now() + 1000 * SECRET_TTL)\n    const _id = `drafts.${id}`\n    const newSecret = generateUrlSecret()\n    const patch = client.patch(_id).set({secret: newSecret, source, studioUrl, userId})\n    await client.transaction().createOrReplace({_id, _type: schemaType}).patch(patch).commit({tag})\n\n    return {secret: newSecret, expiresAt}\n  } finally {\n    try {\n      // Garbage collect expired secrets\n      await client.delete({query: deleteExpiredSecretsQuery})\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error('Failed to delete expired secrets', err)\n    }\n  }\n}\n\nexport type {SanityClientLike}\n", "import type {SanityClient, SyncTag} from '@sanity/client'\n\nimport type {SanityClientLike} from './types'\n\nimport {fetchVercelProtectionBypassSecret} from './constants'\n\n/** @internal */\nexport function subscribeToVercelProtectionBypass(\n  client: SanityClient,\n  onChange: (secret: string | null) => void,\n): () => void {\n  let controller = new AbortController()\n  let usedTags: SyncTag[] = []\n  async function fetchSecret(lastLiveEventId: string | null, signal: AbortSignal) {\n    const {result, syncTags} = await client.fetch<string | null>(\n      fetchVercelProtectionBypassSecret,\n      {},\n      {\n        filterResponse: false,\n        lastLiveEventId,\n        tag: 'preview-url-secret.fetch-vercel-bypass-protection-secret',\n      },\n    )\n    if (Array.isArray(syncTags)) {\n      usedTags = syncTags\n    }\n    if (!signal.aborted) {\n      onChange(result)\n    }\n  }\n  const subscription = client.live.events().subscribe({\n    next: (event) => {\n      if (event.type === 'message') {\n        controller.abort()\n        controller = new AbortController()\n        if (event.tags.some((tag) => usedTags.includes(tag))) {\n          fetchSecret(event.id, controller.signal)\n        }\n      }\n    },\n    // eslint-disable-next-line no-console\n    error: (reason) => console.error(reason),\n  })\n\n  fetchSecret(null, controller.signal)\n\n  return () => {\n    subscription.unsubscribe()\n    controller.abort()\n  }\n}\n\nexport type {SanityClientLike}\n", "import {type FC, memo, useEffect} from 'react'\n\nimport {type VisualEditingConnection} from '../types'\n\nexport interface PostMessagePreviewsProps {\n  comlink: VisualEditingConnection\n}\n\nconst PostMessageFeatures: FC<PostMessagePreviewsProps> = (props) => {\n  const {comlink} = props\n\n  useEffect(() => {\n    return comlink.on('visual-editing/features', () => ({\n      features: {\n        optimistic: true,\n      },\n    }))\n  }, [comlink])\n\n  return null\n}\n\nexport default memo(PostMessageFeatures)\n", "import {type ActorRefFrom, assign, setup} from 'xstate'\n\ninterface Context {\n  url: URL | null\n  error: Error | null\n  visualEditingOverlaysEnabled: boolean\n}\n\ntype Event =\n  | {type: 'toggle visual editing overlays'; enabled: boolean}\n  | {type: 'iframe loaded'}\n  | {type: 'iframe refresh'}\n  | {type: 'iframe reload'}\n\nexport const presentationMachine = setup({\n  types: {} as {\n    context: Context\n    events: Event\n    tags: 'busy' | 'error'\n  },\n  actions: {\n    //\n  },\n  actors: {\n    //\n  },\n  guards: {\n    //\n  },\n}).createMachine({\n  // eslint-disable-next-line tsdoc/syntax\n  /** @xstate-layout N4IgpgJg5mDOIC5QAUBOcwDsAuBDbAlgPaYAEAKkUQDYDEBAZqrgLZinrVG4QDaADAF1EoAA5FYBQiREgAHogAsAJgA0IAJ6IAHAEYAdIoCcJowFY9R-vzPLlAX3vq0GHPmJlKNfVx4FMUPRMrOy+EJACwkgg4pLSmLIKCLoAbIr6Zoop2tqKAMxpJnnF6loIZkbK+uZ5umapKXmK-Cm6js7osFh48RRU1D7c4RC02ERQUNTsAG4EsACuuNSkkFL+UKRE02Co1LgasJGysWsy0UnaZinVyrpGAOx1Rim2efeliPe3hma1Zvy6XT8W4OJwgFxdNy9LwDMKQILMNgcMBMOAACyO0RO8USiAK930LWU-3uiiB9yaKXemkQjW01V+txS-GKqUe7XBnW67hIfW8cJGjER7E4Q0xYgkpwS5zxVMJKWJ-FJ5Mp1LKFn4Pz+DSaLTaYIh3Oh-UGPEg+nQqNgaPWCJCpAF4pikpxMoQKWZ+gp+TSZLy1hSH3deXpNSZLNqVP1HVcPQ8fNhQ3Nor8ATtSMdQmOLo8uPdnu9BUUfoDQY1WrqOuarUcYMwRHC8Gihqh8Zh2biubdAFpAzSEL2OS247yYfodqgiKgO1K8yog7ptATFL9dFljMDrHkh1zW6OTWF1jPXaAkmY1YgKnktfxtC9dPd+Io9DvYzzPAekxBj13T3i7vKirKkqqpBsYVQ1HUFjFs0t6KK+kIjh+-JfvoBAQFMP5nH+CDaMo16KjYyjMvUNh5GWOT6MoLL8A8ygrk0dQIUabafmaEAWiinQ2gEWHSjhjJUYuj73Pcd63noQaNEYFb-Dk2S0cxe7IYm7GcYevFYjm2HyJeeQQb8tFkikVjGNoFGajUt73o+z61vYQA */\n  id: 'Presentation Tool',\n  context: {\n    url: null,\n    error: null,\n    visualEditingOverlaysEnabled: false,\n  },\n\n  on: {\n    'iframe reload': {\n      actions: assign({url: null}),\n      target: '.loading',\n    },\n  },\n\n  states: {\n    error: {\n      description:\n        'Failed to load, either because of a misconfiguration, a network error, or an unexpected error',\n      tags: ['error'],\n    },\n    loading: {\n      on: {\n        'iframe loaded': {\n          target: 'loaded',\n        },\n      },\n      tags: ['busy'],\n    },\n    loaded: {\n      on: {\n        'toggle visual editing overlays': {\n          actions: assign({\n            visualEditingOverlaysEnabled: ({event}) => event.enabled,\n          }),\n        },\n        'iframe refresh': {\n          target: '.refreshing',\n        },\n        'iframe reload': {\n          target: '.reloading',\n        },\n      },\n\n      states: {\n        idle: {},\n        refreshing: {\n          on: {\n            'iframe loaded': {\n              target: 'idle',\n            },\n          },\n          tags: ['busy'],\n        },\n        reloading: {\n          on: {\n            'iframe loaded': {\n              target: 'idle',\n            },\n          },\n          tags: ['busy'],\n        },\n      },\n      initial: 'idle',\n    },\n  },\n  initial: 'loading',\n})\n\nexport type PresentationMachineRef = ActorRefFrom<typeof presentationMachine>\n", "import {type Serializable, type SerializableObject} from '@sanity/presentation-comlink'\nimport {\n  type FunctionComponent,\n  type PropsWithChildren,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n} from 'react'\nimport {PresentationSharedStateContext} from 'sanity/_singletons'\n\nimport {type VisualEditingConnection} from '../types'\nimport {type PresentationSharedStateContextValue} from './types'\n\nexport const SharedStateProvider: FunctionComponent<\n  PropsWithChildren<{\n    comlink: VisualEditingConnection | null\n  }>\n> = function (props) {\n  const {comlink, children} = props\n\n  const sharedState = useRef<SerializableObject>({})\n\n  useEffect(() => {\n    return comlink?.on('visual-editing/shared-state', () => {\n      return {state: sharedState.current}\n    })\n  }, [comlink])\n\n  const setValue = useCallback(\n    (key: string, value: Serializable) => {\n      sharedState.current[key] = value\n      comlink?.post('presentation/shared-state', {key, value})\n    },\n    [comlink],\n  )\n\n  const removeValue = useCallback(\n    (key: string) => {\n      comlink?.post('presentation/shared-state', {key})\n      delete sharedState.current[key]\n    },\n    [comlink],\n  )\n\n  const context = useMemo<PresentationSharedStateContextValue>(\n    () => ({removeValue, setValue}),\n    [removeValue, setValue],\n  )\n\n  return (\n    <PresentationSharedStateContext.Provider value={context}>\n      {children}\n    </PresentationSharedStateContext.Provider>\n  )\n}\n", "import {type FunctionComponent, type PropsWithChildren, useContext, useLayoutEffect} from 'react'\nimport {PresentationPanelsContext} from 'sanity/_singletons'\nimport {styled} from 'styled-components'\n\ninterface PanelProps extends PropsWithChildren {\n  defaultSize?: number | null\n  id: string\n  minWidth?: number\n  maxWidth?: number\n  order?: number\n}\n\nconst Root = styled.div`\n  overflow: hidden;\n  flex-basis: 0;\n  flex-shrink: 1;\n`\n\nexport const Panel: FunctionComponent<PanelProps> = function ({\n  children,\n  defaultSize = null,\n  id,\n  minWidth,\n  maxWidth,\n  order = 0,\n}) {\n  const context = useContext(PresentationPanelsContext)\n\n  if (context === null) {\n    throw Error(`Panel components must be rendered within a PanelGroup container`)\n  }\n\n  const {getPanelStyle, registerElement, unregisterElement} = context\n\n  const style = getPanelStyle(id)\n\n  useLayoutEffect(() => {\n    registerElement(id, {\n      id,\n      type: 'panel',\n      defaultSize,\n      maxWidth: maxWidth ?? null,\n      minWidth: minWidth ?? 0,\n      order,\n    })\n\n    return () => {\n      unregisterElement(id)\n    }\n  }, [id, defaultSize, order, maxWidth, minWidth, registerElement, unregisterElement])\n\n  return <Root style={style}>{children}</Root>\n}\n", "export function debounce<F extends (...args: Parameters<F>) => ReturnType<F>>(\n  fn: F,\n  timeout: number,\n): F {\n  let timer: ReturnType<typeof setTimeout>\n  return ((...args: Parameters<F>) => {\n    clearTimeout(timer)\n    timer = setTimeout(() => {\n      fn.apply(fn, args)\n    }, timeout)\n  }) as F\n}\n", "import {useMemo} from 'react'\n\nimport {debounce} from '../util/debounce'\nimport {type PanelElement} from './types'\n\nconst itemKey = 'presentation/panels'\n\ntype StoredPanelsState = Record<string, number[]>\n\nconst getStoredItem = () => {\n  // @todo Validate\n  return JSON.parse(localStorage.getItem(itemKey) || '{}') as StoredPanelsState\n}\nconst setStoredItem = (data: StoredPanelsState) => {\n  localStorage.setItem(itemKey, JSON.stringify(data))\n}\n\nconst getKeyForPanels = (panels: PanelElement[]) => {\n  return panels.map((panel) => [panel.id, panel.order].join(':')).join(',')\n}\n\nexport function usePanelsStorage(): {\n  get: (panels: PanelElement[]) => number[] | undefined\n  set: (panels: PanelElement[], widths: number[]) => void\n  setDebounced: (panels: PanelElement[], widths: number[]) => void\n} {\n  return useMemo(() => {\n    const get = (panels: PanelElement[]) => {\n      const stored = getStoredItem()\n      const key = getKeyForPanels(panels)\n      return Array.isArray(stored[key]) && stored[key].some((val) => val === null)\n        ? undefined\n        : stored[key]\n    }\n\n    const set = (panels: PanelElement[], widths: number[]) => {\n      const stored = getStoredItem()\n      const key = getKeyForPanels(panels)\n      const data = {\n        ...stored,\n        [key]: widths,\n      }\n      setStoredItem(data)\n    }\n\n    const setDebounced = debounce(set, 100)\n    return {\n      get,\n      set,\n      setDebounced,\n    }\n  }, [])\n}\n", "/* eslint-disable @typescript-eslint/no-shadow,no-eq-null */\nimport {\n  type ElementMap,\n  type InitialDragState,\n  type PanelElement,\n  type PanelsState,\n  type ResizerElement,\n} from './types'\n\nfunction getNextWidth(panel: PanelElement, nextWidth: number, containerWidth: number) {\n  const {maxWidth: maxWidthPx, minWidth: minWidthPx} = panel\n  const maxWidth = maxWidthPx == null ? 100 : (maxWidthPx / containerWidth) * 100\n  const minWidth = (minWidthPx / containerWidth) * 100\n  return Math.min(maxWidth, Math.max(minWidth, nextWidth))\n}\n\n// eslint-disable-next-line max-params\nexport function getNextWidths(\n  delta: number,\n  containerWidth: number,\n  panelBefore: PanelElement,\n  panelAfter: PanelElement,\n  panelsState: PanelsState,\n  initialDragState: InitialDragState,\n): number[] {\n  const {panels, widths: prevWidths} = panelsState\n  const {widths: initialWidths} = initialDragState\n\n  const widths = initialWidths || prevWidths\n  const nextWidths = [...widths]\n\n  {\n    const pivotPanel = delta < 0 ? panelAfter : panelBefore\n    const index = panels.findIndex((panel) => panel.id === pivotPanel.id)\n    const width = widths[index]\n    const nextWidth = getNextWidth(pivotPanel, width + Math.abs(delta), containerWidth)\n    if (width === nextWidth) {\n      return widths\n    }\n    delta = delta < 0 ? width - nextWidth : nextWidth - width\n  }\n\n  let deltaApplied = 0\n  let pivotPanel = delta < 0 ? panelBefore : panelAfter\n  let index = panels.findIndex((panel) => panel.id === pivotPanel.id)\n\n  while (true) {\n    const panel = panels[index]\n    const width = widths[index]\n\n    const deltaRemaining = Math.abs(delta) - Math.abs(deltaApplied)\n\n    const nextWidth = getNextWidth(panel, width - deltaRemaining, containerWidth)\n\n    if (width !== nextWidth) {\n      deltaApplied += width - nextWidth\n      nextWidths[index] = nextWidth\n\n      if (\n        deltaApplied.toPrecision(10).localeCompare(Math.abs(delta).toPrecision(10), undefined, {\n          numeric: true,\n        }) >= 0\n      ) {\n        break\n      }\n    }\n\n    if (delta < 0) {\n      if (--index < 0) {\n        break\n      }\n    } else if (++index >= panels.length) {\n      break\n    }\n  }\n\n  if (deltaApplied === 0) {\n    return widths\n  }\n\n  pivotPanel = delta < 0 ? panelAfter : panelBefore\n  index = panels.findIndex((panel) => panel.id === pivotPanel.id)\n  nextWidths[index] = widths[index] + deltaApplied\n\n  return nextWidths\n}\n\nexport function getPanelWidth(panels: PanelElement[], id: string, widths: number[]): string {\n  if (panels.length === 1) return '100'\n\n  const index = panels.findIndex((panel) => panel.id === id)\n  const width = widths[index]\n\n  if (width == null) return '0'\n\n  return width.toPrecision(10)\n}\n\nexport function getOffset(\n  event: MouseEvent,\n  handleElement: HTMLDivElement,\n  initialOffset: number = 0,\n  initialHandleElementRect: DOMRect | null = null,\n): number {\n  const pointerOffset = event.clientX\n\n  const rect = initialHandleElementRect || handleElement.getBoundingClientRect()\n  const elementOffset = rect.left\n\n  return pointerOffset - elementOffset - initialOffset\n}\n\nexport function isPanel(element: PanelElement | ResizerElement): element is PanelElement {\n  return element.type === 'panel'\n}\n\nexport function isResizer(element: PanelElement | ResizerElement): element is ResizerElement {\n  return element.type === 'resizer'\n}\n\nexport function getSortedElements(elements: ElementMap): Array<PanelElement | ResizerElement> {\n  return Array.from(elements.values()).sort(({order: a}, {order: b}) => {\n    if (a == null && b == null) return 0\n    if (a == null) return -1\n    if (b == null) return 1\n    return a - b\n  })\n}\n\nexport function validateWidths(\n  panels: PanelElement[],\n  widthsToValidate: number[],\n  containerWidth: number,\n): number[] {\n  // Clamp widths proportionally to total 100\n  const total = widthsToValidate.reduce((total, width) => total + width, 0)\n  const widths = [...widthsToValidate].map((width) => (width / total) * 100)\n\n  let remainingWidth = 0\n\n  for (let index = 0; index < panels.length; index++) {\n    const panel = panels[index]\n    const width = widths[index]\n    const nextWidth = getNextWidth(panel, width, containerWidth)\n    if (width != nextWidth) {\n      remainingWidth += width - nextWidth\n      widths[index] = nextWidth\n    }\n  }\n\n  if (remainingWidth.toFixed(3) !== '0.000') {\n    for (let index = 0; index < panels.length; index++) {\n      const panel = panels[index]\n\n      let {maxWidth, minWidth} = panel\n\n      minWidth = (minWidth / containerWidth) * 100\n      if (maxWidth != null) {\n        maxWidth = (maxWidth / containerWidth) * 100\n      }\n\n      const width = Math.min(\n        maxWidth != null ? maxWidth : 100,\n        Math.max(minWidth, widths[index] + remainingWidth),\n      )\n\n      if (width !== widths[index]) {\n        remainingWidth -= width - widths[index]\n        widths[index] = width\n\n        if (Math.abs(remainingWidth).toFixed(3) === '0.000') {\n          break\n        }\n      }\n    }\n  }\n\n  return widths\n}\n\nexport function getDefaultWidths(panels: PanelElement[]): number[] {\n  let panelsWithoutWidth = panels.length\n  let remainingWidthTotal = 100\n\n  const widthsWithNulls = panels.map((panel) => {\n    if (panel.defaultSize) {\n      remainingWidthTotal -= panel.defaultSize\n      panelsWithoutWidth -= 1\n      return panel.defaultSize\n    }\n    return null\n  })\n\n  const defaultWidth = remainingWidthTotal / panelsWithoutWidth\n  const widths = widthsWithNulls.map((width) => {\n    if (width === null) return defaultWidth\n    return width\n  })\n\n  return widths\n}\n", "// Slightly modified version of react-resizable-panels\n// https://github.com/bvaughn/react-resizable-panels/tree/main/packages/react-resizable-panels\n\nimport {\n  type CSSProperties,\n  type FunctionComponent,\n  type PropsWithChildren,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport {PresentationPanelsContext} from 'sanity/_singletons'\nimport {styled} from 'styled-components'\n\nimport {\n  type ElementMap,\n  type InitialDragState,\n  type PanelElement,\n  type PanelsState,\n  type ResizerElement,\n} from './types'\nimport {usePanelsStorage} from './usePanelsStorage'\nimport {\n  getDefaultWidths,\n  getNextWidths,\n  getOffset,\n  getPanelWidth,\n  getSortedElements,\n  isPanel,\n  isResizer,\n  validateWidths,\n} from './util'\n\nconst PanelsWrapper = styled.div`\n  display: flex;\n  flex-direction: row;\n  height: 100%;\n  overflow: hidden;\n  width: 100%;\n`\n\nexport const Panels: FunctionComponent<PropsWithChildren> = function ({children}) {\n  const panelsEl = useRef<HTMLDivElement | null>(null)\n\n  const [elements, setElements] = useState<ElementMap>(new Map())\n\n  const panels = useMemo(() => getSortedElements(elements).filter(isPanel), [elements])\n\n  const [widths, setWidths] = useState<number[]>([])\n  const [activeResizer, setActiveResizer] = useState<string | null>(null)\n\n  const panelsRef = useRef<PanelsState>({\n    elements,\n    panels,\n    widths,\n  })\n\n  const getPanelStyle = useCallback(\n    (id: string): CSSProperties => {\n      return {\n        flexGrow: getPanelWidth(panels, id, widths),\n        pointerEvents: activeResizer === null ? undefined : 'none',\n      }\n    },\n    [activeResizer, panels, widths],\n  )\n\n  const registerElement = useCallback((id: string, data: PanelElement | ResizerElement) => {\n    setElements((prev) => {\n      if (prev.has(id)) return prev\n      const next = new Map(prev)\n      next.set(id, data)\n      return next\n    })\n  }, [])\n  const unregisterElement = useCallback((id: string) => {\n    setElements((prev) => {\n      if (!prev.has(id)) return prev\n      const next = new Map(prev)\n      next.delete(id)\n      return next\n    })\n  }, [])\n\n  const dragRef = useRef<InitialDragState>({\n    containerWidth: window.innerWidth,\n    dragOffset: 0,\n    panelAfter: null,\n    panelBefore: null,\n    resizerIndex: -1,\n    resizerRect: null,\n    startX: 0,\n    widths: [],\n  })\n\n  const startDragging = useCallback(\n    (id: string, event: MouseEvent) => {\n      const elementsArr = getSortedElements(elements)\n      const index = elementsArr.findIndex((el) => el.id === id)\n\n      const resizer = elements.get(id)\n      if (!resizer || !isResizer(resizer)) return\n      const resizeElement = resizer.el.current\n      if (!resizeElement) return\n\n      dragRef.current = {\n        resizerIndex: index,\n        panelBefore: elementsArr.reduce(\n          (acc, el, i) => (isPanel(el) && i < index ? el : acc),\n          null as PanelElement | null,\n        ),\n        panelAfter: elementsArr.reduce(\n          (acc, el, i) => (acc === null && isPanel(el) && i > index ? el : acc),\n          null as PanelElement | null,\n        ),\n        containerWidth: window.innerWidth,\n        startX: event.pageX,\n        dragOffset: getOffset(event, resizeElement),\n        resizerRect: resizeElement.getBoundingClientRect(),\n        widths: panelsRef.current.widths,\n      }\n\n      setActiveResizer(id)\n    },\n    [elements],\n  )\n\n  const stopDragging = useCallback(() => {\n    setActiveResizer(null)\n  }, [])\n\n  const drag = useCallback(\n    (id: string, event: MouseEvent) => {\n      event.preventDefault()\n      event.stopPropagation()\n\n      const {containerWidth, dragOffset, panelBefore, panelAfter, resizerRect} = dragRef.current\n\n      // eslint-disable-next-line no-eq-null\n      if (panelBefore == null || panelAfter == null) {\n        return\n      }\n\n      const resizer = elements.get(id)\n      if (!resizer || !isResizer(resizer)) return\n      const resizeElement = resizer.el.current\n      if (!resizeElement) return\n\n      const offset = getOffset(event, resizeElement, dragOffset, resizerRect)\n\n      if (offset === 0) {\n        return\n      }\n\n      const {widths: prevWidths} = panelsRef.current\n      const rect = panelsEl.current!.getBoundingClientRect()\n      const delta = (offset / rect.width) * 100\n\n      const nextWidths = getNextWidths(\n        delta,\n        containerWidth,\n        panelBefore,\n        panelAfter,\n        panelsRef.current,\n        dragRef.current,\n      )\n\n      const widthsChanged = prevWidths.some((prevWidth, i) => prevWidth !== nextWidths[i])\n\n      if (widthsChanged) {\n        setWidths(nextWidths)\n      }\n    },\n    [elements],\n  )\n\n  // For setting the panels state\n  useLayoutEffect(() => {\n    panelsRef.current.elements = elements\n    panelsRef.current.panels = panels\n    panelsRef.current.widths = widths\n  }, [elements, panels, widths])\n\n  const storage = usePanelsStorage()\n\n  // For setting default sizing when panels are updated\n  useLayoutEffect(() => {\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    const {widths} = panelsRef.current\n\n    if (widths.length === panels.length) {\n      return\n    }\n\n    const storedWidths = storage.get(panels)\n\n    if (storedWidths) {\n      const validatedStoredWidths = validateWidths(panels, storedWidths, window.innerWidth)\n      setWidths(validatedStoredWidths)\n      return\n    }\n\n    const defaultWidths = getDefaultWidths(panels)\n    setWidths(defaultWidths)\n  }, [storage, panels])\n\n  // For storing current widths in localStorage\n  useEffect(() => {\n    if (!widths.length) return\n    storage.setDebounced(panels, widths)\n  }, [storage, panels, widths])\n\n  useLayoutEffect(() => {\n    const resizeObserver = new ResizeObserver(() => {\n      // eslint-disable-next-line @typescript-eslint/no-shadow\n      const {panels, widths: prevWidths} = panelsRef.current\n\n      const nextWidths = validateWidths(panels, prevWidths, window.innerWidth)\n\n      const widthsChanged = prevWidths.some((prevWidth, i) => prevWidth !== nextWidths[i])\n      if (widthsChanged) {\n        setWidths(nextWidths)\n      }\n    })\n\n    resizeObserver.observe(panelsEl.current!)\n\n    return () => {\n      resizeObserver.disconnect()\n    }\n  }, [])\n\n  const context = useMemo(\n    () => ({\n      activeResizer,\n      drag,\n      getPanelStyle,\n      registerElement,\n      startDragging,\n      stopDragging,\n      unregisterElement,\n    }),\n    [\n      activeResizer,\n      drag,\n      getPanelStyle,\n      registerElement,\n      startDragging,\n      stopDragging,\n      unregisterElement,\n    ],\n  )\n\n  return (\n    <PresentationPanelsContext.Provider value={context}>\n      <PanelsWrapper ref={panelsEl}>{children}</PanelsWrapper>\n    </PresentationPanelsContext.Provider>\n  )\n}\n", "import {Box, Card, type CardProps, Container, Flex, Inline, Stack, Text} from '@sanity/ui'\nimport {type ReactNode} from 'react'\nimport {useTranslation} from 'sanity'\n\nimport {Button} from '../../ui-components'\nimport {presentationLocaleNamespace} from '../i18n'\n\nexport function ErrorCard(\n  props: {\n    children?: ReactNode\n    message: string\n    onRetry?: () => void\n    onContinueAnyway?: () => void\n  } & CardProps,\n): React.JSX.Element {\n  const {children, message, onRetry, onContinueAnyway, ...restProps} = props\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n\n  const retryButton = (\n    <Button mode=\"ghost\" onClick={onRetry} text={t('error-card.retry-button.text')} />\n  )\n  const continueAnywayButton = (\n    <Button\n      mode=\"ghost\"\n      tone=\"critical\"\n      onClick={onContinueAnyway}\n      text={t('error-card.continue-button.text')}\n    />\n  )\n\n  return (\n    <Card height=\"fill\" {...restProps}>\n      <Flex align=\"center\" height=\"fill\" justify=\"center\">\n        <Container padding={4} sizing=\"border\" width={0}>\n          <Stack space={4}>\n            <Stack space={3}>\n              <Text size={1} weight=\"semibold\">\n                {t('error-card.title')}\n              </Text>\n              <Text muted size={1}>\n                {message}\n              </Text>\n            </Stack>\n\n            {children}\n\n            {onRetry && onContinueAnyway ? (\n              <Inline space={2}>\n                {retryButton}\n                {continueAnywayButton}\n              </Inline>\n            ) : onRetry ? (\n              <Box>{retryButton}</Box>\n            ) : onContinueAnyway ? (\n              <Box>{continueAnywayButton}</Box>\n            ) : null}\n          </Stack>\n        </Container>\n      </Flex>\n    </Card>\n  )\n}\n", "import {forwardRef} from 'react'\nimport {StateLink} from 'sanity/router'\nimport {type ChildLinkProps} from 'sanity/structure'\n\nimport {type PresentationSearchParams} from '../types'\n\nexport const ChildLink = forwardRef(function ChildLink(\n  props: ChildLinkProps & {\n    childType: string\n    searchParams: PresentationSearchParams\n  },\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {childId, childType, childPayload, childParameters, searchParams, ...rest} = props\n\n  return (\n    <StateLink\n      {...rest}\n      ref={ref}\n      state={{\n        id: childId,\n        type: childType,\n        _searchParams: Object.entries({...searchParams, ...childParameters}),\n      }}\n    />\n  )\n})\n", "import {forwardRef} from 'react'\nimport {getPublishedId, pathToString} from 'sanity'\nimport {type ReferenceChildLinkProps} from 'sanity/structure'\n\nimport {type PresentationSearchParams} from '../types'\nimport {ChildLink} from './ChildLink'\n\nexport const ReferenceChildLink = forwardRef(function ReferenceChildLink(\n  props: ReferenceChildLinkProps & {searchParams: PresentationSearchParams},\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {documentId, documentType, parentRefPath, template, searchParams, ...rest} = props\n\n  return (\n    <ChildLink\n      {...rest}\n      ref={ref}\n      childId={getPublishedId(documentId)}\n      childType={documentType}\n      childPayload={template?.params}\n      childParameters={{\n        parentRefPath: pathToString(parentRefPath),\n        ...(template && {template: template?.id}),\n      }}\n      searchParams={searchParams}\n    />\n  )\n})\n", "import {toString as pathToString} from '@sanity/util/paths'\nimport {forwardRef, type PropsWithChildren, useCallback, useMemo} from 'react'\nimport {getPublishedId, useUnique} from 'sanity'\nimport {StateLink, useRouter} from 'sanity/router'\nimport {\n  type BackLinkProps,\n  type ChildLinkProps,\n  PaneRouterContext,\n  type PaneRouterContextValue,\n  type ReferenceChildLinkProps,\n} from 'sanity/structure'\n\nimport {\n  type PresentationNavigate,\n  type PresentationParamsContextValue,\n  type PresentationSearchParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {ChildLink} from './ChildLink'\nimport {ReferenceChildLink} from './ReferenceChildLink'\n\nfunction encodeQueryString(params: Record<string, unknown> = {}): string {\n  const parts = Object.entries(params)\n    .map(([key, value]) => `${key}=${value}`)\n    .join('&')\n\n  return parts.length ? `?${parts}` : ''\n}\n\nfunction resolveQueryStringFromParams(nextParams: Record<string, string | undefined>) {\n  const allowed = [\n    'comment',\n    'inspect',\n    'instruction',\n    'pathKey',\n    'rev',\n    'since',\n    'template',\n    'view',\n  ] satisfies Array<keyof PresentationParamsContextValue> as string[]\n\n  const safeNextParams = Object.entries(nextParams)\n    .filter(([key]) => allowed.includes(key))\n    .reduce((obj, [key, value]) => {\n      if (value == undefined) return obj\n      return {...obj, [key]: value}\n    }, {})\n\n  return encodeQueryString(safeNextParams)\n}\n\nconst BackLink = forwardRef(function BackLink(\n  props: BackLinkProps & {searchParams: PresentationSearchParams},\n  ref: React.ForwardedRef<HTMLAnchorElement>,\n) {\n  const {searchParams, ...restProps} = props\n  return (\n    <StateLink\n      {...restProps}\n      ref={ref}\n      state={{\n        type: undefined,\n        _searchParams: Object.entries(searchParams),\n      }}\n      title={undefined}\n    />\n  )\n})\n\nexport type PresentationPaneRouterProviderProps = PropsWithChildren<{\n  onEditReference: PresentationNavigate\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  refs?: {_id: string; _type: string}[]\n  searchParams: PresentationSearchParams\n  structureParams: StructureDocumentPaneParams\n}>\n\nexport function PresentationPaneRouterProvider(\n  props: PresentationPaneRouterProviderProps,\n): React.JSX.Element {\n  const {children, onEditReference, onStructureParams, structureParams, searchParams, refs} = props\n\n  const {state: routerState, resolvePathFromState} = useRouter()\n\n  const routerSearchParams = useUnique(Object.fromEntries(routerState._searchParams || []))\n\n  const createPathWithParams: PaneRouterContextValue['createPathWithParams'] = useCallback(\n    (nextParams) => {\n      const path = resolvePathFromState(routerState)\n      const qs = resolveQueryStringFromParams({\n        ...routerSearchParams,\n        ...nextParams,\n      })\n      return `${path}${qs}`\n    },\n    [resolvePathFromState, routerSearchParams, routerState],\n  )\n\n  const context: PaneRouterContextValue = useMemo(() => {\n    return {\n      index: 0,\n      groupIndex: 0,\n      siblingIndex: 0,\n      payload: {},\n      // oxlint-disable-next-line no-explicit-any\n      params: structureParams as any,\n      hasGroupSiblings: false,\n      groupLength: 1,\n      routerPanesState: [],\n      ChildLink: forwardRef<HTMLAnchorElement, ChildLinkProps>(\n        function ContextChildLink(childLinkProps, ref) {\n          const {childId, ...rest} = childLinkProps\n          const doc = refs?.find((r) => r._id === childId || getPublishedId(r._id) === childId)\n\n          if (!doc) {\n            console.warn(`ChildLink: No document found for childId \"${childId}\"`)\n            return null\n          }\n\n          return (\n            <ChildLink\n              {...rest}\n              ref={ref}\n              childId={childId}\n              childType={doc._type}\n              searchParams={searchParams}\n            />\n          )\n        },\n      ),\n      BackLink: forwardRef<HTMLAnchorElement, BackLinkProps>(\n        function ContextBackLink(backLinkProps, ref) {\n          return <BackLink {...backLinkProps} ref={ref} searchParams={searchParams} />\n        },\n      ),\n      ReferenceChildLink: forwardRef<HTMLAnchorElement, ReferenceChildLinkProps>(\n        function ContextReferenceChildLink(childLinkProps, ref) {\n          return <ReferenceChildLink {...childLinkProps} ref={ref} searchParams={searchParams} />\n        },\n      ),\n      ParameterizedLink: () => {\n        throw new Error('ParameterizedLink not implemented')\n      },\n      closeCurrentAndAfter: () => {\n        console.warn('closeCurrentAndAfter')\n      },\n      handleEditReference: (options) => {\n        const {id, template, type, parentRefPath, version} = options\n        onEditReference({\n          state: {id, type},\n          params: {\n            template: template.id,\n            parentRefPath: pathToString(parentRefPath),\n            version,\n          },\n        })\n      },\n      replaceCurrent: (pane) => {\n        console.warn('replaceCurrent', pane)\n      },\n      closeCurrent: () => {\n        console.warn('closeCurrent')\n      },\n      duplicateCurrent: (pane) => {\n        console.warn('duplicateCurrent', pane)\n      },\n      setView: (viewId) => {\n        console.warn('setView', viewId)\n      },\n      setParams: onStructureParams,\n      setPayload: (payload) => {\n        console.warn('setPayload', payload)\n      },\n      navigateIntent: (intentName, intentParams, options) => {\n        console.warn('navigateIntent', intentName, intentParams, options)\n      },\n      createPathWithParams,\n    }\n  }, [\n    createPathWithParams,\n    onEditReference,\n    onStructureParams,\n    refs,\n    searchParams,\n    structureParams,\n  ])\n\n  return <PaneRouterContext.Provider value={context}>{children}</PaneRouterContext.Provider>\n}\n", "import {Card, Code, Flex, Label, Stack} from '@sanity/ui'\nimport {type ErrorInfo, useCallback, useEffect, useMemo, useState} from 'react'\nimport {getPublishedId, useTranslation} from 'sanity'\nimport {\n  DocumentListPane as StructureDocumentListPane,\n  PaneLayout,\n  type PaneNode,\n  StructureToolProvider,\n} from 'sanity/structure'\nimport {styled} from 'styled-components'\n\nimport {ErrorBoundary} from '../../ui-components'\nimport {ErrorCard} from '../components/ErrorCard'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {PresentationPaneRouterProvider} from '../paneRouter/PresentationPaneRouterProvider'\nimport {\n  type MainDocumentState,\n  type PresentationNavigate,\n  type PresentationSearchParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {usePresentationTool} from '../usePresentationTool'\n\nconst RootLayout = styled(PaneLayout)`\n  height: 100%;\n`\n\nconst Root = styled(Flex)`\n  & > div {\n    min-width: none !important;\n    max-width: none !important;\n  }\n`\n\nconst WrappedCode = styled(Code)`\n  white-space: pre-wrap;\n`\n\nexport function DocumentListPane(props: {\n  mainDocumentState?: MainDocumentState\n  onEditReference: PresentationNavigate\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  searchParams: PresentationSearchParams\n  refs: {_id: string; _type: string}[]\n}): React.JSX.Element {\n  const {mainDocumentState, onEditReference, onStructureParams, searchParams, refs} = props\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {devMode} = usePresentationTool()\n\n  const ids = useMemo(\n    () =>\n      refs\n        .filter((r) => getPublishedId(r._id) !== mainDocumentState?.document?._id)\n        .map((r) => getPublishedId(r._id)),\n    [mainDocumentState, refs],\n  )\n\n  const pane: Extract<PaneNode, {type: 'documentList'}> = useMemo(\n    () => ({\n      id: '$root',\n      options: {\n        filter: '_id in $ids',\n        params: {ids},\n        // defaultOrdering: [{field: '_updatedAt', direction: 'desc'}],\n      },\n      schemaTypeName: '',\n      title: t('document-list-pane.document-list.title'),\n      type: 'documentList',\n    }),\n    [ids, t],\n  )\n\n  const [errorParams, setErrorParams] = useState<{\n    info: ErrorInfo\n    error: Error\n  } | null>(null)\n\n  const handleRetry = useCallback(() => setErrorParams(null), [])\n\n  const [structureParams] = useState(() => ({}))\n\n  // Reset error state when `refs` value schanges\n  useEffect(() => setErrorParams(null), [refs])\n\n  if (errorParams) {\n    return (\n      <ErrorCard flex={1} message={t('document-list-pane.error.text')} onRetry={handleRetry}>\n        {devMode && (\n          // show runtime error message in dev mode\n          <Card overflow=\"auto\" padding={3} radius={2} tone=\"critical\">\n            <Stack space={3}>\n              <Label muted size={0}>\n                {t('presentation-error.label')}\n              </Label>\n              <WrappedCode size={1}>{errorParams.error.message}</WrappedCode>\n            </Stack>\n          </Card>\n        )}\n      </ErrorCard>\n    )\n  }\n\n  return (\n    <ErrorBoundary onCatch={setErrorParams}>\n      <RootLayout>\n        <StructureToolProvider>\n          <PresentationPaneRouterProvider\n            onEditReference={onEditReference}\n            onStructureParams={onStructureParams}\n            structureParams={structureParams}\n            searchParams={searchParams}\n            refs={refs}\n          >\n            <Root direction=\"column\" flex={1}>\n              <StructureDocumentListPane\n                index={0}\n                itemId=\"$root\"\n                pane={pane}\n                // eslint-disable-next-line @sanity/i18n/no-attribute-string-literals\n                paneKey=\"$root\"\n              />\n            </Root>\n          </PresentationPaneRouterProvider>\n        </StructureToolProvider>\n      </RootLayout>\n    </ErrorBoundary>\n  )\n}\n", "import {studioPath} from '@sanity/client/csm'\nimport {Card, Code, Label, Stack} from '@sanity/ui'\nimport {type ErrorInfo, Suspense, useCallback, useEffect, useMemo, useState} from 'react'\nimport {type Path, useTranslation} from 'sanity'\nimport {decodeJsonParams} from 'sanity/router'\nimport {\n  DocumentPane as StructureDocumentPane,\n  type DocumentPaneNode,\n  PaneLayout,\n} from 'sanity/structure'\nimport {styled} from 'styled-components'\n\nimport {ErrorBoundary} from '../../ui-components'\nimport {ErrorCard} from '../components/ErrorCard'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {PresentationPaneRouterProvider} from '../paneRouter/PresentationPaneRouterProvider'\nimport {PresentationSpinner} from '../PresentationSpinner'\nimport {\n  type PresentationNavigate,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {usePresentationTool} from '../usePresentationTool'\n\nconst WrappedCode = styled(Code)`\n  white-space: pre-wrap;\n`\n\nexport function DocumentPane(props: {\n  documentId: string\n  documentType: string\n  onFocusPath: (state: Required<PresentationStateParams>) => void\n  onEditReference: PresentationNavigate\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  structureParams: StructureDocumentPaneParams\n  searchParams: PresentationSearchParams\n}): React.JSX.Element {\n  const {\n    documentId,\n    documentType,\n    onFocusPath,\n    onEditReference,\n    onStructureParams,\n    searchParams,\n    structureParams,\n  } = props\n  const {template, templateParams} = structureParams\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {devMode} = usePresentationTool()\n\n  const paneDocumentNode: DocumentPaneNode = useMemo(\n    () => ({\n      id: documentId,\n      options: {\n        id: documentId,\n        type: documentType,\n        template,\n        templateParameters: decodeJsonParams(templateParams),\n      },\n      title: '',\n      type: 'document',\n    }),\n    [documentId, documentType, template, templateParams],\n  )\n\n  const handleFocusPath = useCallback(\n    (path: Path) => {\n      return onFocusPath({\n        id: documentId,\n        type: documentType,\n        path: studioPath.toString(path),\n      })\n    },\n    [documentId, documentType, onFocusPath],\n  )\n\n  const [errorParams, setErrorParams] = useState<{\n    info: ErrorInfo\n    error: Error\n  } | null>(null)\n\n  const handleRetry = useCallback(() => setErrorParams(null), [])\n\n  // Reset error state when parameters change\n  useEffect(() => {\n    setErrorParams(null)\n  }, [documentId, documentType, structureParams])\n\n  if (errorParams) {\n    return (\n      <ErrorCard flex={1} message={t('document-pane.error.text')} onRetry={handleRetry}>\n        {devMode && (\n          // show runtime error message in dev mode\n          <Card overflow=\"auto\" padding={3} radius={2} tone=\"critical\">\n            <Stack space={3}>\n              <Label muted size={0}>\n                {t('presentation-error.label')}\n              </Label>\n              <WrappedCode size={1}>{errorParams.error.message}</WrappedCode>\n            </Stack>\n          </Card>\n        )}\n      </ErrorCard>\n    )\n  }\n\n  return (\n    <ErrorBoundary onCatch={setErrorParams}>\n      <PaneLayout style={{height: '100%'}}>\n        <PresentationPaneRouterProvider\n          searchParams={searchParams}\n          onEditReference={onEditReference}\n          onStructureParams={onStructureParams}\n          structureParams={structureParams}\n        >\n          <Suspense fallback={<PresentationSpinner />}>\n            <StructureDocumentPane\n              // eslint-disable-next-line @sanity/i18n/no-attribute-string-literals\n              paneKey=\"document\"\n              index={1}\n              itemId=\"document\"\n              pane={paneDocumentNode}\n              onFocusPath={handleFocusPath}\n            />\n          </Suspense>\n        </PresentationPaneRouterProvider>\n      </PaneLayout>\n    </ErrorBoundary>\n  )\n}\n", "import {StructureToolProvider} from '../../structure/StructureToolProvider'\nimport {\n  type PresentationNavigate,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {DocumentPane} from './DocumentPane'\n\nexport function DocumentPanel(props: {\n  documentId: string\n  documentType: string\n  onEditReference: PresentationNavigate\n  onFocusPath: (state: Required<PresentationStateParams>) => void\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  searchParams: PresentationSearchParams\n  structureParams: StructureDocumentPaneParams\n}): React.JSX.Element {\n  const {\n    documentId,\n    documentType,\n    onFocusPath,\n    onEditReference,\n    onStructureParams,\n    searchParams,\n    structureParams,\n  } = props\n  return (\n    <StructureToolProvider>\n      <DocumentPane\n        documentId={documentId}\n        documentType={documentType}\n        onEditReference={onEditReference}\n        onFocusPath={onFocusPath}\n        onStructureParams={onStructureParams}\n        searchParams={searchParams}\n        structureParams={structureParams}\n      />\n    </StructureToolProvider>\n  )\n}\n", "import {type SchemaType} from '@sanity/types'\nimport {useEffect, useState} from 'react'\nimport {\n  getPreviewStateObservable,\n  type PreviewValue,\n  type SanityDocument,\n  useDocumentPreviewStore,\n  usePerspective,\n} from 'sanity'\n\ninterface PreviewState {\n  isLoading?: boolean\n  snapshot?: PreviewValue | Partial<SanityDocument> | null\n}\n\nexport default function usePreviewState(documentId: string, schemaType?: SchemaType): PreviewState {\n  const documentPreviewStore = useDocumentPreviewStore()\n  const [preview, setPreview] = useState<PreviewState>({})\n  const {perspectiveStack} = usePerspective()\n  useEffect(() => {\n    if (!schemaType) {\n      return undefined\n    }\n    const subscription = getPreviewStateObservable(\n      documentPreviewStore,\n      schemaType,\n      documentId,\n      perspectiveStack,\n    ).subscribe((state) => {\n      setPreview(state)\n    })\n\n    return () => {\n      subscription?.unsubscribe()\n    }\n  }, [documentPreviewStore, schemaType, documentId, perspectiveStack])\n\n  return preview\n}\n", "import {WarningOutlineIcon} from '@sanity/icons'\nimport {Box, Card, Flex, Text} from '@sanity/ui'\nimport {type HTMLProps, useCallback, useMemo} from 'react'\nimport {\n  getPreviewValueWithFallback,\n  PreviewCard,\n  SanityDefaultPreview,\n  Translate,\n  useSchema,\n  useTranslation,\n} from 'sanity'\nimport {StateLink} from 'sanity/router'\n\nimport {presentationLocaleNamespace} from '../i18n'\nimport {\n  type MainDocumentState,\n  type PresentationNavigate,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from '../types'\nimport {DocumentListPane} from './DocumentListPane'\nimport {DocumentPanel} from './DocumentPanel'\nimport usePreviewState from './usePreviewState'\n\nexport function ContentEditor(props: {\n  documentId?: string\n  documentType?: string\n  mainDocumentState?: MainDocumentState\n  onEditReference: PresentationNavigate\n  onFocusPath: (state: Required<PresentationStateParams>) => void\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  refs: {_id: string; _type: string}[]\n  structureParams: StructureDocumentPaneParams\n  searchParams: PresentationSearchParams\n}): React.JSX.Element {\n  const {\n    documentId,\n    documentType,\n    mainDocumentState,\n    onEditReference,\n    onFocusPath,\n    onStructureParams,\n    refs,\n    searchParams,\n    structureParams,\n  } = props\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const schema = useSchema()\n\n  const MainDocumentLink = useCallback(\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    (props: HTMLProps<HTMLAnchorElement>) => {\n      return (\n        <StateLink\n          {...props}\n          state={{\n            id: mainDocumentState?.document?._id,\n            type: mainDocumentState?.document?._type,\n            _searchParams: Object.entries(searchParams),\n          }}\n        />\n      )\n    },\n    [mainDocumentState, searchParams],\n  )\n\n  const schemaType = useMemo(\n    () => schema.get(mainDocumentState?.document?._type || 'shoe')!,\n    [mainDocumentState, schema],\n  )\n\n  const previewState = usePreviewState(mainDocumentState?.document?._id || '', schemaType)\n\n  const preview = useMemo(() => {\n    if (!mainDocumentState?.document) return null\n\n    return (\n      <SanityDefaultPreview\n        {...getPreviewValueWithFallback({\n          snapshot: previewState.snapshot,\n          fallback: mainDocumentState.document,\n        })}\n        schemaType={schemaType}\n        status={\n          <Card padding={1} radius={2} shadow={1}>\n            <Text muted size={0} weight=\"medium\">\n              {t('main-document.label')}\n            </Text>\n          </Card>\n        }\n      />\n    )\n  }, [mainDocumentState, schemaType, t, previewState])\n\n  if (documentId && documentType) {\n    return (\n      <DocumentPanel\n        documentId={documentId}\n        documentType={documentType}\n        onEditReference={onEditReference}\n        onFocusPath={onFocusPath}\n        onStructureParams={onStructureParams}\n        searchParams={searchParams}\n        structureParams={structureParams}\n      />\n    )\n  }\n\n  return (\n    <Flex direction=\"column\" flex={1} height=\"fill\">\n      {mainDocumentState && (\n        <Card padding={3} tone={mainDocumentState.document ? 'inherit' : 'caution'}>\n          {mainDocumentState.document ? (\n            <PreviewCard\n              __unstable_focusRing\n              // oxlint-disable-next-line no-explicit-any\n              as={MainDocumentLink as any}\n              data-as=\"a\"\n              radius={2}\n              sizing=\"border\"\n              tone=\"inherit\"\n            >\n              {preview}\n            </PreviewCard>\n          ) : (\n            <Card padding={2} radius={2} tone=\"inherit\">\n              <Flex gap={3}>\n                <Box flex=\"none\">\n                  <Text size={1}>\n                    <WarningOutlineIcon />\n                  </Text>\n                </Box>\n                <Box flex={1}>\n                  <Text size={1}>\n                    <Translate\n                      t={t}\n                      i18nKey=\"main-document.missing.text\"\n                      components={{Code: 'code'}}\n                      values={{path: mainDocumentState.path}}\n                    />\n                  </Text>\n                </Box>\n              </Flex>\n            </Card>\n          )}\n        </Card>\n      )}\n\n      <DocumentListPane\n        mainDocumentState={mainDocumentState}\n        onEditReference={onEditReference}\n        onStructureParams={onStructureParams}\n        searchParams={searchParams}\n        refs={refs}\n      />\n    </Flex>\n  )\n}\n", "import {useState} from 'react'\nimport {v4 as uuid} from 'uuid'\n\nexport function usePanelId(id?: string): string {\n  const [panelId] = useState(() => id || uuid())\n  return panelId\n}\n", "import {\n  type FunctionComponent,\n  type MouseEvent as ReactMouseEvent,\n  useCallback,\n  useContext,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n} from 'react'\nimport {PresentationPanelsContext} from 'sanity/_singletons'\nimport {styled} from 'styled-components'\n\nimport {usePanelId} from './usePanelId'\n\nconst Resizer = styled.div`\n  position: relative;\n`\nconst ResizerInner = styled.div<{\n  $disabled: boolean\n}>`\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: -5px;\n  width: 9px;\n  z-index: 10;\n  cursor: ${({$disabled}) => ($disabled ? 'auto' : 'ew-resize')};\n\n  /* Border */\n  & > span:nth-child(1) {\n    display: block;\n    border-left: 1px solid var(--card-border-color);\n    position: absolute;\n    top: 0;\n    left: 4px;\n    bottom: 0;\n    transition: opacity 200ms;\n  }\n\n  ${({$disabled}) =>\n    !$disabled &&\n    `\n    /* Hover effect */\n    & > span:nth-child(2) {\n      display: block;\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 9px;\n      bottom: 0;\n      background-color: var(--card-border-color);\n      opacity: 0;\n      transition: opacity 150ms;\n    }\n\n    @media (hover: hover) {\n      &:hover > span:nth-child(2) {\n        opacity: 0.2;\n      }\n    }\n  `}\n`\n\nexport const PanelResizer: FunctionComponent<{\n  id?: string\n  order: number\n  disabled?: boolean\n}> = function ({id: propId, order, disabled = false}) {\n  const el = useRef<HTMLDivElement>(null)\n\n  const context = useContext(PresentationPanelsContext)\n\n  if (context === null) {\n    throw Error(`Panel components must be rendered within a PanelGroup container`)\n  }\n\n  const id = usePanelId(propId)\n\n  const {activeResizer, drag, startDragging, stopDragging, registerElement, unregisterElement} =\n    context\n\n  const isDragging = activeResizer === id\n\n  if (context === null) {\n    throw Error(`Panel components must be rendered within a PanelGroup container`)\n  }\n\n  const onMouseDown = useCallback(\n    (event: ReactMouseEvent) => {\n      startDragging(id, event.nativeEvent)\n    },\n    [id, startDragging],\n  )\n\n  const onDrag = useCallback(\n    (e: MouseEvent) => {\n      drag(id, e)\n    },\n    [id, drag],\n  )\n\n  const onDragStop = useCallback(() => {\n    el.current!.blur()\n    stopDragging()\n  }, [stopDragging])\n\n  useEffect(() => {\n    if (!isDragging || disabled) return\n\n    // Set styles to prevent text selection and force an ew-resize cursor whilst\n    // dragging. Return a reset callback so we can revert to any values that\n    // might have been present before dragging started.\n    function setDocumentStyles() {\n      const bodyStyle = document.body.style\n      const documentStyle = document.documentElement.style\n\n      const {cursor} = documentStyle\n      const {userSelect} = bodyStyle\n\n      documentStyle.cursor = 'ew-resize'\n      bodyStyle.userSelect = 'none'\n\n      return () => {\n        if (cursor) documentStyle.cursor = cursor\n        else documentStyle.removeProperty('cursor')\n\n        if (userSelect) bodyStyle.userSelect = userSelect\n        else bodyStyle.removeProperty('user-select')\n      }\n    }\n\n    const resetDocumentStyles = setDocumentStyles()\n    window.addEventListener('mousemove', onDrag)\n    window.addEventListener('mouseup', onDragStop)\n    window.addEventListener('contextmenu', onDragStop)\n\n    // eslint-disable-next-line consistent-return\n    return () => {\n      resetDocumentStyles()\n      window.removeEventListener('mousemove', onDrag)\n      window.removeEventListener('mouseup', onDragStop)\n      window.removeEventListener('contextmenu', onDragStop)\n    }\n  }, [disabled, isDragging, onDrag, onDragStop])\n\n  useLayoutEffect(() => {\n    registerElement(id, {id, order, type: 'resizer', el})\n\n    return () => {\n      unregisterElement(id)\n    }\n  }, [id, order, registerElement, unregisterElement])\n\n  return (\n    <Resizer onMouseDown={onMouseDown} ref={el}>\n      <ResizerInner $disabled={disabled}>\n        <span />\n        <span />\n      </ResizerInner>\n    </Resizer>\n  )\n}\n", "import {\n  type Dispatch,\n  type FunctionComponent,\n  type PropsWithChildren,\n  type SetStateAction,\n} from 'react'\nimport {type CommentIntentGetter, CommentsIntentProvider, type SanityDocument} from 'sanity'\n\nimport {ContentEditor} from './editor/ContentEditor'\nimport {DisplayedDocumentBroadcasterProvider} from './loader/DisplayedDocumentBroadcaster'\nimport {Panel} from './panels/Panel'\nimport {PanelResizer} from './panels/PanelResizer'\nimport {\n  type MainDocumentState,\n  type PresentationNavigate,\n  type PresentationParamsContextValue,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from './types'\n\nexport interface PresentationContentProps {\n  documentId: PresentationParamsContextValue['id']\n  documentsOnPage: {_id: string; _type: string}[]\n  documentType: PresentationParamsContextValue['type']\n  getCommentIntent: CommentIntentGetter\n  mainDocumentState: MainDocumentState | undefined\n  onEditReference: PresentationNavigate\n  onFocusPath: (state: Required<PresentationStateParams>) => void\n  onStructureParams: (params: StructureDocumentPaneParams) => void\n  searchParams: PresentationSearchParams\n  setDisplayedDocument: Dispatch<SetStateAction<Partial<SanityDocument> | null | undefined>>\n  structureParams: StructureDocumentPaneParams\n}\n\nconst PresentationContentWrapper: FunctionComponent<\n  PropsWithChildren<{\n    documentId?: string\n    getCommentIntent: CommentIntentGetter\n    setDisplayedDocument: Dispatch<SetStateAction<Partial<SanityDocument> | null | undefined>>\n  }>\n> = (props) => {\n  const {documentId, setDisplayedDocument, getCommentIntent} = props\n  return (\n    <>\n      <PanelResizer order={4} />\n      <Panel id=\"content\" minWidth={325} order={5}>\n        <DisplayedDocumentBroadcasterProvider\n          documentId={documentId}\n          setDisplayedDocument={setDisplayedDocument}\n        >\n          <CommentsIntentProvider getIntent={getCommentIntent}>\n            {props.children}\n          </CommentsIntentProvider>\n        </DisplayedDocumentBroadcasterProvider>\n      </Panel>\n    </>\n  )\n}\n\nexport const PresentationContent: FunctionComponent<PresentationContentProps> = (props) => {\n  const {\n    documentId,\n    documentsOnPage,\n    documentType,\n    getCommentIntent,\n    mainDocumentState,\n    onEditReference,\n    onFocusPath,\n    onStructureParams,\n    searchParams,\n    setDisplayedDocument,\n    structureParams,\n  } = props\n\n  return (\n    <PresentationContentWrapper\n      documentId={documentId}\n      getCommentIntent={getCommentIntent}\n      setDisplayedDocument={setDisplayedDocument}\n    >\n      <ContentEditor\n        documentId={documentId}\n        documentType={documentType}\n        mainDocumentState={mainDocumentState}\n        onEditReference={onEditReference}\n        onFocusPath={onFocusPath}\n        onStructureParams={onStructureParams}\n        refs={documentsOnPage}\n        searchParams={searchParams}\n        structureParams={structureParams}\n      />\n    </PresentationContentWrapper>\n  )\n}\n", "import {type FunctionComponent, type PropsWithChildren, useCallback} from 'react'\nimport {PresentationNavigateContext} from 'sanity/_singletons'\n\nimport {\n  type CombinedSearchParams,\n  type PresentationNavigate,\n  type PresentationNavigateContextValue,\n  type PresentationNavigateOptions,\n  type PresentationStateParams,\n} from './types'\n\nexport const PresentationNavigateProvider: FunctionComponent<\n  PropsWithChildren<{\n    navigate: PresentationNavigate\n  }>\n> = function (props) {\n  const {children, navigate: _navigate} = props\n\n  const navigate = useCallback<PresentationNavigateContextValue>(\n    (preview, document) => {\n      if (preview || document) {\n        const obj: {\n          state?: PresentationStateParams\n          params?: CombinedSearchParams\n        } = {}\n        if (preview) obj.params = {preview}\n        if (document) obj.state = document\n        // Cast because navigate expects either params or state to be defined, which we guarantee above\n        _navigate(obj as PresentationNavigateOptions)\n      }\n    },\n    [_navigate],\n  )\n\n  return (\n    <PresentationNavigateContext.Provider value={navigate}>\n      {children}\n    </PresentationNavigateContext.Provider>\n  )\n}\n", "import {type Dispatch, type SetStateAction, useEffect, useState} from 'react'\n\nexport function useLocalState<T>(key: string, defaultValue: T): [T, Dispatch<SetStateAction<T>>] {\n  const [value, setValue] = useState<T>(() =>\n    JSON.parse(localStorage.getItem(key) ?? JSON.stringify(defaultValue)),\n  )\n\n  useEffect(() => {\n    localStorage.setItem(key, JSON.stringify(value))\n  }, [key, value])\n\n  return [value, setValue]\n}\n", "import {memo, useCallback, useMemo} from 'react'\n\nimport {Panel} from './panels/Panel'\nimport {PanelResizer} from './panels/PanelResizer'\nimport {type NavigatorOptions} from './types'\nimport {useLocalState} from './useLocalState'\n\n/** @internal */\nexport interface UsePresentationNavigatorProps {\n  unstable_navigator?: NavigatorOptions\n}\n\n/** @internal */\nexport interface UsePresentationNavigatorState {\n  navigatorEnabled: boolean\n  toggleNavigator: (() => void) | undefined\n}\n\n/** @internal */\nexport function usePresentationNavigator(\n  props: UsePresentationNavigatorProps,\n): [UsePresentationNavigatorState, () => React.JSX.Element] {\n  const {unstable_navigator} = props\n\n  const navigatorProvided = !!unstable_navigator?.component\n  const [_navigatorEnabled, setNavigatorEnabled] = useLocalState<boolean>(\n    'presentation/navigator',\n    navigatorProvided,\n  )\n  const navigatorEnabled = navigatorProvided ? _navigatorEnabled : false\n  const toggleNavigator = useMemo(() => {\n    if (!navigatorProvided) return undefined\n\n    return () => setNavigatorEnabled((enabled) => !enabled)\n  }, [navigatorProvided, setNavigatorEnabled])\n\n  const Component = useCallback(\n    function PresentationNavigator() {\n      return <>{navigatorEnabled && <Navigator {...unstable_navigator!} />}</>\n    },\n    [navigatorEnabled, unstable_navigator],\n  )\n\n  return [{navigatorEnabled, toggleNavigator}, Component]\n}\n\nfunction NavigatorComponent(props: NavigatorOptions) {\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  const {minWidth, maxWidth, component: NavigatorComponent} = props\n  // eslint-disable-next-line no-eq-null\n  const navigatorDisabled = minWidth != null && maxWidth != null && minWidth === maxWidth\n  return (\n    <>\n      <Panel id=\"navigator\" minWidth={minWidth} maxWidth={maxWidth} order={1}>\n        <NavigatorComponent />\n      </Panel>\n      <PanelResizer order={2} disabled={navigatorDisabled} />\n    </>\n  )\n}\nconst Navigator = memo(NavigatorComponent)\n", "import {type FunctionComponent, type PropsWithChildren, useMemo} from 'react'\nimport {PresentationParamsContext} from 'sanity/_singletons'\n\nimport {type PresentationParamsContextValue} from './types'\n\nexport const PresentationParamsProvider: FunctionComponent<\n  PropsWithChildren<{\n    params: PresentationParamsContextValue\n  }>\n> = function (props) {\n  const {children, params} = props\n\n  const context = useMemo<PresentationParamsContextValue>(() => params, [params])\n\n  return (\n    <PresentationParamsContext.Provider value={context}>\n      {children}\n    </PresentationParamsContext.Provider>\n  )\n}\n", "import {type FunctionComponent, type PropsWithChildren, useMemo} from 'react'\nimport {PresentationContext} from 'sanity/_singletons'\n\nimport {\n  type PresentationContextValue,\n  type PresentationNavigate,\n  type PresentationParamsContextValue,\n  type PresentationSearchParams,\n  type StructureDocumentPaneParams,\n} from './types'\n\nexport const PresentationProvider: FunctionComponent<\n  PropsWithChildren<{\n    devMode: boolean\n    name: string\n    navigate: PresentationNavigate\n    params: PresentationParamsContextValue\n    searchParams: PresentationSearchParams\n    structureParams: StructureDocumentPaneParams\n  }>\n> = function (props) {\n  const {children, devMode, name, navigate, params, searchParams, structureParams} = props\n\n  const context = useMemo<PresentationContextValue>(\n    () => ({\n      devMode,\n      name,\n      navigate,\n      params,\n      searchParams,\n      structureParams,\n    }),\n    [devMode, name, navigate, params, searchParams, structureParams],\n  )\n\n  return <PresentationContext.Provider value={context}>{children}</PresentationContext.Provider>\n}\n", "import {useSelector} from '@xstate/react'\n\nimport {type PreviewUrlRef} from './machines/preview-url'\n\nexport function useAllowPatterns(previewUrlRef: PreviewUrlRef) {\n  const allowPatterns = useSelector(previewUrlRef, (state) => state.context.allowOrigins)\n  if (!Array.isArray(allowPatterns)) {\n    throw new TypeError('allowPatterns must be an array')\n  }\n  return allowPatterns\n}\n", "/**\n * When encoding the current studio perspective it's necessary to deal with it sometimes being an array, in a consistent way.\n */\nexport function encodeStudioPerspective(studioPerspective: string[] | string): string {\n  return Array.isArray(studioPerspective) ? studioPerspective.join(',') : studioPerspective\n}\n", "import {useId as useReactId} from 'react'\n\nexport function useId(): string {\n  const id = useReactId()\n  // Uses the new format introduced in: https://github.com/facebook/react/pull/32001\n  return id.startsWith(':') ? id.replace(/^:(.+):$/, '\\u00AB$1\\u00BB') : id\n}\n", "import {Box} from '@sanity/ui'\nimport {motion, type VariantLabels, type Variants} from 'motion/react'\nimport {forwardRef, type ReactEventHandler, useEffect, useImperativeHandle, useRef} from 'react'\nimport {createGlobalStyle, styled} from 'styled-components'\n\nimport {useId} from '../useId'\n\ninterface IFrameProps {\n  animate: VariantLabels\n  initial: VariantLabels\n  onLoad: ReactEventHandler<HTMLIFrameElement>\n  preventClick: boolean\n  src: string\n  variants: Variants\n  style: React.CSSProperties\n}\n\nexport const IFrame = forwardRef<HTMLIFrameElement, IFrameProps>(\n  function IFrame(props, forwardedRef) {\n    const {animate, initial, onLoad, preventClick, src, variants, style} = props\n\n    const ref = useRef<HTMLIFrameElement | null>(null)\n    // Forward the iframe ref to the parent component\n    useImperativeHandle<HTMLIFrameElement | null, HTMLIFrameElement | null>(\n      forwardedRef,\n      () => ref.current,\n    )\n\n    /**\n     * Ensure that clicking outside of menus and dialogs will close as focus shifts to the iframe\n     */\n\n    useEffect(() => {\n      if (!ref.current) {\n        return undefined\n      }\n      const instance = ref.current\n      function handleBlur() {\n        if (instance !== document.activeElement) {\n          return\n        }\n\n        instance.dispatchEvent(new MouseEvent('mousedown', {bubbles: true, cancelable: true}))\n      }\n      window.addEventListener('blur', handleBlur)\n      return () => {\n        window.removeEventListener('blur', handleBlur)\n      }\n    }, [])\n\n    const viewTransitionName = useId()\n\n    return (\n      <>\n        <IFrameElement\n          style={{\n            ...style,\n            viewTransitionName,\n          }}\n          animate={animate}\n          initial={initial}\n          onLoad={onLoad}\n          ref={ref}\n          src={src}\n          variants={variants}\n        />\n        {preventClick && <IFrameOverlay />}\n        <GlobalViewTransition />\n      </>\n    )\n  },\n)\n\nconst IFrameElement = motion.create(styled.iframe`\n  box-shadow: 0 0 0 1px var(--card-border-color);\n  border: 0;\n  max-height: 100%;\n  width: 100%;\n  view-transition-class: presentation-tool-iframe;\n`)\n\nconst IFrameOverlay = styled(Box)`\n  position: absolute;\n  inset: 0;\n  background: transparent;\n`\n\nconst GlobalViewTransition = createGlobalStyle`\nhtml:active-view-transition-type(sanity-iframe-viewport) {\n  view-transition-name: none;\n  &::view-transition {\n    pointer-events: none;\n  }\n  /* &::view-transition-old(root) {\n    display: none;\n  }\n  &::view-transition-new(root) {\n    animation: none;\n  } */\n}\n`\n", "import {LaunchIcon} from '@sanity/icons'\nimport {urlSearchParamPreviewPerspective} from '@sanity/preview-url-secret/constants'\nimport {Text} from '@sanity/ui'\nimport {useCallback, useMemo} from 'react'\nimport {useTranslation} from 'sanity'\n\nimport {Button, Tooltip} from '../../ui-components'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {type PresentationPerspective} from '../types'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\nimport {type PreviewProps} from './Preview'\n\n/** @internal */\nexport function OpenPreviewButton(\n  props: Pick<PreviewProps, 'openPopup'> & {\n    previewLocationOrigin?: string\n    previewLocationRoute: string\n    perspective: PresentationPerspective\n    targetOrigin: string\n  },\n): React.ReactNode {\n  const {openPopup, previewLocationOrigin, previewLocationRoute, perspective, targetOrigin} = props\n\n  const openPreviewLink = useMemo(() => {\n    const url = new URL(previewLocationRoute, previewLocationOrigin || targetOrigin)\n    url.searchParams.set(urlSearchParamPreviewPerspective, encodeStudioPerspective(perspective))\n    const {pathname, search} = url\n\n    return `${previewLocationOrigin}${pathname}${search}`\n  }, [perspective, previewLocationOrigin, previewLocationRoute, targetOrigin])\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n\n  const handleOpenPopup = useCallback(\n    (event: React.MouseEvent<HTMLAnchorElement>) => {\n      event.preventDefault()\n      openPopup(event.currentTarget.href)\n    },\n    [openPopup],\n  )\n\n  return (\n    <Tooltip\n      animate\n      content={<Text size={1}>{t('share-url.menu-item.open.text')}</Text>}\n      fallbackPlacements={['bottom-start']}\n      placement=\"bottom\"\n      portal\n    >\n      <Button\n        as=\"a\"\n        aria-label={t('share-url.menu-item.open.text')}\n        icon={LaunchIcon}\n        mode=\"bleed\"\n        href={openPreviewLink}\n        rel=\"opener\"\n        target=\"_blank\"\n        tooltipProps={null}\n        // @ts-expect-error the `as=\"a\"` prop isn't enough to change the type of event.target from <div> to <a>\n        onClick={handleOpenPopup}\n      />\n    </Tooltip>\n  )\n}\n", "import {useSelector} from '@xstate/react'\n\nimport {type PreviewUrlRef} from './machines/preview-url'\n\nexport function useTargetOrigin(previewUrlRef: PreviewUrlRef): string {\n  const targetOrigin = useSelector(previewUrlRef, (state) => state.context.previewUrl?.origin)\n  if (!targetOrigin) {\n    throw new TypeError('targetOrigin is required')\n  }\n  return targetOrigin\n}\n", "import {ResetIcon} from '@sanity/icons'\nimport {TextInput, type TextInputClearButtonProps} from '@sanity/ui'\nimport {\n  type ChangeEvent,\n  type KeyboardEvent,\n  type ReactNode,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport {useActiveWorkspace, useTranslation} from 'sanity'\n\nimport {presentationLocaleNamespace} from '../i18n'\nimport {type PreviewUrlRef} from '../machines/preview-url'\nimport {useAllowPatterns} from '../useAllowPatterns'\nimport {useTargetOrigin} from '../useTargetOrigin'\n\nexport function PreviewLocationInput(props: {\n  fontSize?: number\n  onChange: (value: string) => void\n  previewUrlRef: PreviewUrlRef\n  padding?: number\n  prefix?: ReactNode\n  suffix?: ReactNode\n  value: string\n}): React.JSX.Element {\n  const {fontSize = 1, onChange, padding = 3, prefix, suffix, value, previewUrlRef} = props\n  const allowOrigins = useAllowPatterns(previewUrlRef)\n  const targetOrigin = useTargetOrigin(previewUrlRef)\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {basePath = '/'} = useActiveWorkspace()?.activeWorkspace || {}\n\n  const inputRef = useRef<HTMLInputElement | null>(null)\n  const [sessionValue, setSessionValue] = useState<string | undefined>(undefined)\n  const [customValidity, setCustomValidity] = useState<string | undefined>(undefined)\n\n  const handleChange = useCallback((event: ChangeEvent<HTMLInputElement>) => {\n    setSessionValue(event.currentTarget.value)\n  }, [])\n\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent<HTMLInputElement>) => {\n      if (event.key === 'Enter') {\n        if (sessionValue === undefined) {\n          return\n        }\n\n        let absoluteValue = sessionValue\n        try {\n          absoluteValue = new URL(sessionValue, targetOrigin).toString()\n        } catch {\n          // ignore\n        }\n\n        if (Array.isArray(allowOrigins)) {\n          if (!allowOrigins.some((pattern) => pattern.test(absoluteValue))) {\n            setCustomValidity(\n              t('preview-location-input.error', {\n                origin: targetOrigin,\n                context: 'origin-not-allowed',\n              }),\n            )\n            event.currentTarget.reportValidity()\n            return\n          }\n          // `origin` is an empty string '' if the Studio is embedded, and that's when we need to protect against recursion\n        } else if (\n          !targetOrigin &&\n          (absoluteValue.startsWith(`${basePath}/`) || absoluteValue === basePath)\n        ) {\n          setCustomValidity(\n            t('preview-location-input.error', {basePath, context: 'same-base-path'}),\n          )\n          return\n        }\n\n        const nextValue = absoluteValue === targetOrigin ? `${targetOrigin}/` : absoluteValue\n\n        setCustomValidity(undefined)\n        setSessionValue(undefined)\n\n        onChange(nextValue)\n\n        inputRef.current?.blur()\n      }\n\n      if (event.key === 'Escape') {\n        setCustomValidity(undefined)\n        setSessionValue(undefined)\n      }\n    },\n    [allowOrigins, basePath, onChange, sessionValue, t, targetOrigin],\n  )\n\n  const handleBlur = useCallback(() => {\n    setCustomValidity(undefined)\n    setSessionValue(undefined)\n  }, [])\n\n  const handleClear = useCallback(() => {\n    setCustomValidity(undefined)\n    let nextValue = value\n    try {\n      nextValue = new URL(value, targetOrigin).toString()\n    } catch {\n      // ignore\n    }\n    setSessionValue(nextValue)\n  }, [targetOrigin, value])\n\n  useEffect(() => {\n    setCustomValidity(undefined)\n    setSessionValue(undefined)\n  }, [targetOrigin, value])\n\n  const resetButton: TextInputClearButtonProps = useMemo(() => ({icon: ResetIcon}), [])\n\n  return (\n    <>\n      <TextInput\n        clearButton={customValidity ? resetButton : undefined}\n        customValidity={customValidity}\n        fontSize={fontSize}\n        onBlur={handleBlur}\n        onClear={handleClear}\n        onChange={handleChange}\n        onKeyDownCapture={handleKeyDown}\n        padding={padding}\n        prefix={prefix}\n        style={{zIndex: 1}}\n        radius={2}\n        ref={inputRef}\n        space={padding}\n        suffix={suffix}\n        value={sessionValue === undefined ? new URL(value, targetOrigin).toString() : sessionValue}\n      />\n    </>\n  )\n}\n", "/* eslint-disable @typescript-eslint/no-shadow */\nimport {type ClientPerspective, type SyncTag} from '@sanity/client'\nimport {CopyIcon, ShareIcon} from '@sanity/icons'\nimport {SanityMonogram} from '@sanity/logos'\nimport {fetchSharedAccessQuery} from '@sanity/preview-url-secret/constants'\nimport {\n  disablePreviewAccessSharing,\n  enablePreviewAccessSharing,\n} from '@sanity/preview-url-secret/toggle-preview-access-sharing'\nimport {setSecretSearchParams} from '@sanity/preview-url-secret/without-secret-search-params'\nimport {\n  Box,\n  Card,\n  Grid,\n  Menu,\n  MenuDivider,\n  Spinner,\n  Stack,\n  Switch,\n  Text,\n  useToast,\n} from '@sanity/ui'\nimport {AnimatePresence, motion} from 'motion/react'\nimport {lazy, Suspense, useCallback, useEffect, useMemo, useState} from 'react'\nimport {useClient, useCurrentUser, useTranslation} from 'sanity'\nimport {styled} from 'styled-components'\n\nimport {Button, MenuButton, MenuItem, Tooltip} from '../../ui-components'\nimport {API_VERSION} from '../constants'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\nimport {type PreviewProps} from './Preview'\n\nconst QRCodeSVG = lazy(() => import('./QRCodeSVG'))\n\nexport interface SharePreviewMenuProps {\n  canToggleSharePreviewAccess: boolean\n  canUseSharedPreviewAccess: boolean\n  previewLocationRoute: string\n  initialUrl: PreviewProps['initialUrl']\n  perspective: ClientPerspective\n}\n\nconst QrCodeLogoSize = 24\nconst QrCodeLogoPadding = 16\nconst QrSize = 224\n\nconst StyledSanityMonogram = styled(SanityMonogram)`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  height: ${QrCodeLogoSize}px;\n  width: ${QrCodeLogoSize}px;\n`\n\nconst MotionSpinner = motion.create(Spinner)\nconst MotionText = motion.create(Text)\nconst MotionMonogram = motion.create(StyledSanityMonogram)\n\nexport function SharePreviewMenu(props: SharePreviewMenuProps): React.JSX.Element {\n  const {\n    canToggleSharePreviewAccess,\n    canUseSharedPreviewAccess,\n    initialUrl,\n    previewLocationRoute,\n    perspective,\n  } = props\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {push: pushToast} = useToast()\n  const client = useClient({apiVersion: API_VERSION})\n  const currentUser = useCurrentUser()\n  const [loading, setLoading] = useState(true)\n  const [enabling, setEnabling] = useState(false)\n  const [disabling, setDisabling] = useState(false)\n  const [secret, setSecret] = useState<string | null>(null)\n  const busy = enabling || disabling || loading\n  const url = useMemo(\n    () =>\n      secret\n        ? setSecretSearchParams(\n            initialUrl,\n            secret,\n            previewLocationRoute,\n            encodeStudioPerspective(perspective),\n          )\n        : null,\n    [initialUrl, perspective, previewLocationRoute, secret],\n  )\n\n  const [error, setError] = useState<unknown>(null)\n  if (error) {\n    throw error\n  }\n\n  const handleUnableToToggle = useCallback(() => {\n    pushToast({\n      closable: true,\n      status: 'warning',\n      title: t('share-preview-menu.error_toggle-sharing', {context: 'toggle-sharing'}),\n    })\n  }, [pushToast, t])\n\n  const handleDisableSharing = async () => {\n    // Workaround for React Compiler not yet fully supporting try/catch/finally syntax\n    const run = async () => {\n      setDisabling(true)\n      await disablePreviewAccessSharing(\n        client,\n        'sanity/presentation',\n        typeof window === 'undefined' ? '' : location.href,\n        currentUser?.id,\n      )\n      setSecret(null)\n    }\n    try {\n      await run()\n    } catch (error) {\n      setError(error)\n    }\n    setDisabling(false)\n  }\n  const handleEnableSharing = async () => {\n    // Workaround for React Compiler not yet fully supporting try/catch/finally syntax\n    const run = async () => {\n      setEnabling(true)\n\n      const previewUrlSecret = await enablePreviewAccessSharing(\n        client,\n        'sanity/presentation',\n        typeof window === 'undefined' ? '' : location.href,\n        currentUser?.id,\n      )\n      setSecret(previewUrlSecret.secret)\n    }\n    try {\n      await run()\n    } catch (error) {\n      setError(error)\n    }\n    setEnabling(false)\n  }\n\n  const handleCopyUrl = useCallback(async () => {\n    // Workaround for React Compiler not yet fully supporting try/catch/finally syntax\n    const run = async () => {\n      if (!url) {\n        throw new Error('No URL to copy')\n      }\n      await navigator.clipboard.writeText(url.toString())\n      pushToast({\n        closable: true,\n        status: 'success',\n        title: t('share-url.clipboard.status', {context: 'success'}),\n      })\n    }\n    try {\n      await run()\n    } catch (error) {\n      setError(error)\n    }\n  }, [pushToast, t, url])\n\n  useEffect(() => {\n    let controller = new AbortController()\n    let usedTags: SyncTag[] = []\n    async function fetchShareSecret(lastLiveEventId: string | null, signal: AbortSignal) {\n      const {result, syncTags} = await client.fetch<string | null>(\n        fetchSharedAccessQuery,\n        {},\n        {filterResponse: false, lastLiveEventId, tag: 'presentation.fetch-shared-access-secret'},\n      )\n      if (Array.isArray(syncTags)) {\n        usedTags = syncTags\n      }\n      if (!signal.aborted) {\n        setSecret(result)\n      }\n    }\n    const subscription = client.live.events().subscribe({\n      next: (event) => {\n        if (event.type === 'message') {\n          controller.abort()\n          controller = new AbortController()\n          if (event.tags.some((tag) => usedTags.includes(tag))) {\n            void fetchShareSecret(event.id, controller.signal)\n          }\n        }\n      },\n      error: setError,\n    })\n\n    void fetchShareSecret(null, controller.signal).finally(() => setLoading(false))\n\n    return () => {\n      subscription.unsubscribe()\n      controller.abort()\n    }\n  }, [client])\n\n  return (\n    <MenuButton\n      button={\n        <Button\n          aria-label={t('preview-frame.share-button.aria-label')}\n          icon={ShareIcon}\n          mode=\"bleed\"\n          tooltipProps={null}\n        />\n      }\n      id=\"share-menu\"\n      menu={\n        <Menu style={{maxWidth: 248}} padding={canUseSharedPreviewAccess ? undefined : 0}>\n          {canUseSharedPreviewAccess ? (\n            <>\n              <label style={{cursor: 'pointer'}}>\n                <Grid\n                  columns={2}\n                  rows={2}\n                  gapX={3}\n                  gapY={1}\n                  style={{\n                    justifyContent: 'center',\n                    alignItems: 'center',\n                    gridTemplateColumns: 'min-content 1fr',\n                    gridTemplateRows: 'min-content',\n                  }}\n                  paddingTop={3}\n                  paddingX={3}\n                >\n                  <Tooltip\n                    animate\n                    content={\n                      <Text size={1}>\n                        {t('share-preview-menu.toggle-button.tooltip', {\n                          context: url ? 'disable' : 'enable',\n                        })}\n                      </Text>\n                    }\n                    fallbackPlacements={['bottom-start']}\n                    placement=\"bottom\"\n                    portal\n                  >\n                    <Switch\n                      checked={enabling || (url !== null && !disabling)}\n                      readOnly={enabling || disabling}\n                      indeterminate={loading}\n                      onChange={\n                        !canToggleSharePreviewAccess\n                          ? handleUnableToToggle\n                          : url\n                            ? handleDisableSharing\n                            : handleEnableSharing\n                      }\n                    />\n                  </Tooltip>\n                  <Text size={1} weight=\"medium\">\n                    {t('share-preview-menu.toggle-button.label', {context: 'first-line'})}\n                  </Text>\n                  <span />\n                  <Text muted size={1}>\n                    {t('share-preview-menu.toggle-button.label', {context: 'second-line'})}\n                  </Text>\n                </Grid>\n              </label>\n              <Box padding={3} paddingTop={2}>\n                <Stack space={3}>\n                  <Card\n                    tone={busy || !url ? 'transparent' : undefined}\n                    style={{\n                      position: 'relative',\n                      aspectRatio: '1 / 1',\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                    }}\n                  >\n                    <AnimatePresence>\n                      {busy ? (\n                        <MotionSpinner\n                          muted\n                          initial={{opacity: 0}}\n                          animate={{opacity: 1}}\n                          exit={{opacity: 0}}\n                        />\n                      ) : url ? (\n                        <>\n                          <Suspense fallback={<Spinner />}>\n                            <QRCodeSVG\n                              title={t('share-preview-menu.qr-code.title', {url: url.toString()})}\n                              value={url.toString()}\n                              size={QrSize}\n                              color=\"var(--card-fg-color)\"\n                              logoSize={QrCodeLogoSize + QrCodeLogoPadding}\n                            />\n                            <MotionMonogram\n                              initial={{opacity: -0.5}}\n                              animate={{opacity: 1.5}}\n                              exit={{opacity: 0}}\n                            />\n                          </Suspense>\n                        </>\n                      ) : (\n                        <MotionText\n                          muted\n                          size={1}\n                          style={{maxWidth: '100px', textWrap: 'pretty', textAlign: 'center'}}\n                          initial={{opacity: 0}}\n                          animate={{opacity: 1}}\n                          exit={{opacity: 0}}\n                        >\n                          {t('share-preview-menu.qr-code.placeholder')}\n                        </MotionText>\n                      )}\n                    </AnimatePresence>\n                  </Card>\n                  <Text muted size={1}>\n                    {t('share-preview-menu.qr-code.instructions')}\n                  </Text>\n                </Stack>\n              </Box>\n              <MenuDivider />\n              <MenuItem\n                disabled={!url || disabling}\n                icon={CopyIcon}\n                onClick={handleCopyUrl}\n                text={t('share-preview-menu.copy-url.text')}\n              />\n            </>\n          ) : (\n            <Card padding={2} tone=\"caution\" radius={3}>\n              <Text style={{textWrap: 'pretty'}}>\n                {t('share-preview-menu.error', {context: 'missing-grants'})}\n              </Text>\n            </Card>\n          )}\n        </Menu>\n      }\n      popover={{\n        constrainSize: true,\n        placement: 'bottom',\n        portal: true,\n      }}\n    />\n  )\n}\n", "import {DesktopIcon, MobileDeviceIcon, PanelLeftIcon, RefreshIcon} from '@sanity/icons'\nimport {withoutSecretSearchParams} from '@sanity/preview-url-secret/without-secret-search-params'\nimport {Box, Card, Flex, Hotkeys, Switch, Text} from '@sanity/ui'\nimport {useSelector} from '@xstate/react'\nimport {type RefObject, useCallback, useMemo} from 'react'\nimport {useTranslation} from 'sanity'\n\nimport {Button, Tooltip} from '../../ui-components'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {type HeaderOptions} from '../types'\nimport {useId} from '../useId'\nimport {OpenPreviewButton} from './OpenPreviewButton'\nimport {type PreviewProps} from './Preview'\nimport {PreviewLocationInput} from './PreviewLocationInput'\nimport {SharePreviewMenu} from './SharePreviewMenu'\n\n/** @public */\nexport interface PreviewHeaderProps extends PreviewProps {\n  iframeRef: RefObject<HTMLIFrameElement | null>\n  renderDefault: (props: PreviewHeaderProps) => React.JSX.Element\n}\n\nconst PreviewHeaderDefault = (props: Omit<PreviewHeaderProps, 'renderDefault'>) => {\n  const {\n    canSharePreviewAccess,\n    canToggleSharePreviewAccess,\n    canUseSharedPreviewAccess,\n    iframeRef,\n    initialUrl,\n    navigatorEnabled,\n    onPathChange,\n    onRefresh,\n    openPopup,\n    overlaysConnection,\n    presentationRef,\n    perspective,\n    previewUrl,\n    setViewport,\n    targetOrigin,\n    toggleNavigator,\n    toggleOverlay,\n    viewport,\n    previewUrlRef,\n  } = props\n\n  const {t} = useTranslation(presentationLocaleNamespace)\n\n  const toggleViewportSize = useCallback(\n    () => setViewport(viewport === 'desktop' ? 'mobile' : 'desktop'),\n    [setViewport, viewport],\n  )\n\n  const previewLocationOrigin = useMemo(() => {\n    return targetOrigin === location.origin ? '' : targetOrigin\n  }, [targetOrigin])\n\n  const handleRefresh = () => {\n    onRefresh(() => {\n      if (!iframeRef.current) {\n        return\n      }\n      presentationRef.send({type: 'iframe reload'})\n      // Funky way to reload an iframe without CORS issues\n      // ref.current.src = ref.current.src\n      Object.assign(iframeRef.current, {src: new URL(previewUrl || '/', targetOrigin).toString()})\n    })\n  }\n\n  const isLoading = useSelector(presentationRef, (state) => state.matches('loading'))\n  const isLoaded = useSelector(presentationRef, (state) => state.matches('loaded'))\n  const isRefreshing = useSelector(presentationRef, (state) =>\n    state.matches({loaded: 'refreshing'}),\n  )\n  const isReloading = useSelector(presentationRef, (state) => state.matches({loaded: 'reloading'}))\n  const overlaysEnabled = useSelector(\n    presentationRef,\n    (state) => state.context.visualEditingOverlaysEnabled,\n  )\n\n  const previewLocationRoute = useMemo(() => {\n    const previewURL = new URL(previewUrl || '/', targetOrigin)\n    const {pathname, search} = withoutSecretSearchParams(previewURL)\n\n    return `${pathname}${search}`\n  }, [previewUrl, targetOrigin])\n\n  const perspectiveToggleTooltipId = useId()\n\n  /**\n   * If the preview URL machine is busy it means it's about to change the target origin and reload the iframe,\n   * so we show a spinner\n   */\n  const previewUrlBusy = useSelector(previewUrlRef, (state) => state.hasTag('busy'))\n\n  return (\n    <Flex align=\"center\" gap={1} paddingX={1} style={{width: '100%'}}>\n      {toggleNavigator && (\n        <Button\n          aria-label={t('preview-frame.navigator.toggle-button.aria-label')}\n          icon={PanelLeftIcon}\n          mode=\"bleed\"\n          onClick={toggleNavigator}\n          selected={navigatorEnabled}\n          tooltipProps={{\n            content: <Text size={1}>{t('preview-frame.navigator.toggle-button.tooltip')}</Text>,\n            fallbackPlacements: ['bottom-start'],\n            placement: 'bottom',\n          }}\n        />\n      )}\n\n      <Tooltip\n        animate\n        content={\n          <Flex align=\"center\" style={{whiteSpace: 'nowrap'}}>\n            <Box padding={1}>\n              <Text size={1}>\n                {t('preview-frame.overlay.toggle-button.tooltip', {\n                  context: overlaysEnabled ? 'disable' : 'enable',\n                })}\n              </Text>\n            </Box>\n            <Box paddingY={1}>\n              <Hotkeys keys={['Alt']} style={{marginTop: -4, marginBottom: -4}} />\n            </Box>\n          </Flex>\n        }\n        fallbackPlacements={['bottom-start']}\n        placement=\"bottom\"\n        portal\n      >\n        <Card\n          as=\"label\"\n          flex=\"none\"\n          padding={3}\n          marginX={1}\n          style={{\n            lineHeight: 0,\n            borderRadius: 999,\n            userSelect: 'none',\n          }}\n          tone={overlaysEnabled ? 'transparent' : undefined}\n        >\n          <Flex align=\"center\" gap={3}>\n            <div style={{margin: -4}}>\n              <Switch\n                indeterminate={!isLoaded}\n                checked={overlaysEnabled}\n                onChange={toggleOverlay}\n                disabled={isLoading || overlaysConnection !== 'connected'}\n              />\n            </div>\n            <Box>\n              <Text muted={!overlaysEnabled} size={1} weight=\"medium\">\n                {t('preview-frame.overlay.toggle-button.text')}\n              </Text>\n            </Box>\n          </Flex>\n        </Card>\n      </Tooltip>\n\n      <Box flex={1}>\n        <PreviewLocationInput\n          previewUrlRef={previewUrlRef}\n          prefix={\n            <Box padding={1}>\n              <Tooltip\n                animate\n                content={\n                  <Text size={1}>\n                    {isLoaded\n                      ? t('preview-frame.refresh-button.tooltip')\n                      : t('preview-frame.status', {\n                          context: isLoading\n                            ? 'loading'\n                            : isRefreshing\n                              ? 'refreshing'\n                              : isReloading\n                                ? 'reloading'\n                                : 'unknown',\n                        })}\n                  </Text>\n                }\n                fallbackPlacements={['bottom-end']}\n                placement=\"bottom\"\n                portal\n              >\n                <Button\n                  aria-label={t('preview-frame.refresh-button.aria-label')}\n                  icon={RefreshIcon}\n                  mode=\"bleed\"\n                  loading={isReloading || isRefreshing || previewUrlBusy}\n                  onClick={handleRefresh}\n                  tooltipProps={null}\n                />\n              </Tooltip>\n            </Box>\n          }\n          onChange={onPathChange}\n          suffix={\n            <Box padding={1}>\n              <OpenPreviewButton\n                openPopup={openPopup}\n                previewLocationOrigin={previewLocationOrigin}\n                previewLocationRoute={previewLocationRoute}\n                perspective={perspective}\n                targetOrigin={targetOrigin}\n              />\n            </Box>\n          }\n          value={previewLocationRoute}\n        />\n      </Box>\n\n      <Flex align=\"center\" flex=\"none\" gap={1}>\n        <Tooltip\n          animate\n          ref={(node) => {\n            node?.style.setProperty('view-transition-name', perspectiveToggleTooltipId)\n          }}\n          content={\n            <Text size={1}>\n              {t('preview-frame.viewport-button.tooltip', {\n                context: viewport === 'desktop' ? 'narrow' : 'full',\n              })}\n            </Text>\n          }\n          fallbackPlacements={['bottom-start']}\n          placement=\"bottom\"\n          portal\n        >\n          <Button\n            data-testid=\"preview-viewport-toggle\"\n            data-viewport={viewport}\n            aria-label={t('preview-frame.viewport-button.aria-label')}\n            icon={viewport === 'desktop' ? MobileDeviceIcon : DesktopIcon}\n            mode=\"bleed\"\n            onClick={toggleViewportSize}\n            tooltipProps={null}\n          />\n        </Tooltip>\n      </Flex>\n\n      {canSharePreviewAccess && (\n        <Flex align=\"center\" flex=\"none\" gap={1}>\n          <SharePreviewMenu\n            canToggleSharePreviewAccess={canToggleSharePreviewAccess}\n            canUseSharedPreviewAccess={canUseSharedPreviewAccess}\n            previewLocationRoute={previewLocationRoute}\n            initialUrl={initialUrl}\n            perspective={perspective}\n          />\n        </Flex>\n      )}\n    </Flex>\n  )\n}\n\n/** @internal */\nexport function PreviewHeader(\n  props: Omit<PreviewHeaderProps, 'renderDefault'> & {options?: HeaderOptions},\n): React.JSX.Element {\n  // eslint-disable-next-line @typescript-eslint/no-shadow\n  const renderDefault = useCallback((props: Omit<PreviewHeaderProps, 'renderDefault'>) => {\n    return <PreviewHeaderDefault {...props} />\n  }, [])\n\n  const HeaderComponent = props.options?.component\n  const header = HeaderComponent ? (\n    <HeaderComponent {...props} renderDefault={renderDefault} />\n  ) : (\n    renderDefault(props)\n  )\n\n  return (\n    <Card flex=\"none\" padding={2} borderBottom style={{position: 'relative'}}>\n      <Flex align=\"center\" style={{minHeight: 0}}>\n        {header}\n      </Flex>\n    </Card>\n  )\n}\n", "/* eslint-disable react/no-unused-prop-types */\nimport {createConnectionMachine, createController} from '@sanity/comlink'\nimport {\n  createCompatibilityActors,\n  type VisualEditingControllerMsg,\n  type VisualEditingNodeMsg,\n} from '@sanity/presentation-comlink'\nimport {\n  urlSearchParamPreviewPerspective,\n  urlSearchParamVercelProtectionBypass,\n  urlSearchParamVercelSetBypassCookie,\n  type VercelSetBypassCookieValue,\n} from '@sanity/preview-url-secret/constants'\nimport {\n  Card,\n  Code,\n  Flex,\n  Label,\n  Spinner,\n  Stack,\n  Text,\n  usePrefersReducedMotion,\n  useToast,\n} from '@sanity/ui'\nimport {useSelector} from '@xstate/react'\nimport {AnimatePresence, motion, MotionConfig} from 'motion/react'\nimport {\n  forwardRef,\n  memo,\n  useCallback,\n  useEffect,\n  useEffectEvent,\n  useImperativeHandle,\n  useMemo,\n  useRef,\n  useState,\n  useSyncExternalStore,\n} from 'react'\nimport {flushSync} from 'react-dom'\nimport {Translate, useTranslation} from 'sanity'\n\nimport {Button, TooltipDelayGroupProvider} from '../../ui-components'\nimport {ErrorCard} from '../components/ErrorCard'\nimport {MAX_TIME_TO_OVERLAYS_CONNECTION} from '../constants'\nimport {presentationLocaleNamespace} from '../i18n'\nimport {type PresentationMachineRef} from '../machines/presentation-machine'\nimport {type PreviewUrlRef} from '../machines/preview-url'\nimport {\n  type ConnectionStatus,\n  type HeaderOptions,\n  type PresentationPerspective,\n  type PresentationViewport,\n} from '../types'\nimport {useAllowPatterns} from '../useAllowPatterns'\nimport {usePresentationNavigate} from '../usePresentationNavigate'\nimport {usePresentationTool} from '../usePresentationTool'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\nimport {IFrame} from './IFrame'\nimport {PreviewHeader} from './PreviewHeader'\n\nconst MotionFlex = motion.create(Flex)\n\n/** @public */\nexport interface PreviewProps {\n  canSharePreviewAccess: boolean\n  canToggleSharePreviewAccess: boolean\n  canUseSharedPreviewAccess: boolean\n  header?: HeaderOptions\n  initialUrl: URL\n  loadersConnection: ConnectionStatus\n  navigatorEnabled: boolean\n  onPathChange: (nextPath: string) => void\n  onRefresh: (fallback: () => void) => void\n  openPopup: (url: string) => void\n  overlaysConnection: ConnectionStatus\n  presentationRef: PresentationMachineRef\n  perspective: PresentationPerspective\n  previewUrl?: string\n  setViewport: (mode: 'desktop' | 'mobile') => void\n  targetOrigin: string\n  toggleNavigator?: () => void\n  toggleOverlay: () => void\n  viewport: PresentationViewport\n  vercelProtectionBypass: string | null\n  previewUrlRef: PreviewUrlRef\n}\n\nexport const Preview = memo(\n  forwardRef<HTMLIFrameElement, PreviewProps>(function PreviewComponent(props, forwardedRef) {\n    const {\n      header,\n      initialUrl,\n      loadersConnection,\n      overlaysConnection,\n      perspective,\n      viewport,\n      vercelProtectionBypass,\n      presentationRef,\n      previewUrlRef,\n    } = props\n\n    const [stablePerspective, setStablePerspective] = useState<typeof perspective | null>(null)\n    const urlPerspective = encodeStudioPerspective(\n      stablePerspective === null ? perspective : stablePerspective,\n    )\n    const previewUrl = useMemo(() => {\n      const url = new URL(initialUrl)\n      // Always set the perspective that's being used, even if preview mode isn't configured\n      if (!url.searchParams.get(urlSearchParamPreviewPerspective)) {\n        url.searchParams.set(urlSearchParamPreviewPerspective, urlPerspective)\n      }\n\n      if (vercelProtectionBypass || url.searchParams.get(urlSearchParamVercelProtectionBypass)) {\n        // samesitenone is required since the request is from an iframe\n        url.searchParams.set(\n          urlSearchParamVercelSetBypassCookie,\n          'samesitenone' satisfies VercelSetBypassCookieValue,\n        )\n      }\n      // If there's a vercel protection bypass secret in the context, set it if none exists already\n      if (vercelProtectionBypass && !url.searchParams.get(urlSearchParamVercelProtectionBypass)) {\n        url.searchParams.set(urlSearchParamVercelProtectionBypass, vercelProtectionBypass)\n      }\n\n      return url\n    }, [initialUrl, urlPerspective, vercelProtectionBypass])\n\n    useEffect(() => {\n      /**\n       * If the preview iframe is connected to the loader, we know that switching the perspective can be done without reloading the iframe.\n       */\n      if (loadersConnection === 'connected') {\n        /**\n         * Only set the stable perspective if it hasn't been set yet.\n         */\n        setStablePerspective((prev) => (prev === null ? perspective : prev))\n      }\n    }, [loadersConnection, perspective])\n\n    const {t} = useTranslation(presentationLocaleNamespace)\n    const {devMode} = usePresentationTool()\n    const prefersReducedMotion = usePrefersReducedMotion()\n    const ref = useRef<HTMLIFrameElement | null>(null)\n\n    const previewHeader = <PreviewHeader {...props} iframeRef={ref} options={header} />\n\n    // Forward the iframe ref to the parent component\n    useImperativeHandle<HTMLIFrameElement | null, HTMLIFrameElement | null>(\n      forwardedRef,\n      () => ref.current,\n    )\n\n    const isLoading = useSelector(\n      presentationRef,\n      (state) => state.matches('loading') || state.matches({loaded: 'reloading'}),\n    )\n\n    const [timedOut, setTimedOut] = useState(false)\n    const isRefreshing = useSelector(presentationRef, (state) =>\n      state.matches({loaded: 'refreshing'}),\n    )\n    const [somethingIsWrong, setSomethingIsWrong] = useState(false)\n    const iframeIsBusy = isLoading || isRefreshing || overlaysConnection === 'connecting'\n\n    const handleRetry = useCallback(() => {\n      if (!ref.current) {\n        return\n      }\n\n      ref.current.src = previewUrl.toString()\n\n      presentationRef.send({type: 'iframe reload'})\n    }, [presentationRef, previewUrl])\n\n    const [continueAnyway, setContinueAnyway] = useState(false)\n    const handleContinueAnyway = useCallback(() => {\n      setContinueAnyway(true)\n    }, [])\n    const [showOverlaysConnectionStatus, setShowOverlaysConnectionState] = useState(false)\n    useEffect(() => {\n      if (isLoading || isRefreshing) {\n        return undefined\n      }\n\n      if (overlaysConnection === 'connecting' || overlaysConnection === 'reconnecting') {\n        const timeout = setTimeout(() => {\n          setShowOverlaysConnectionState(true)\n        }, 5_000)\n        return () => clearTimeout(timeout)\n      }\n      return undefined\n    }, [overlaysConnection, isLoading, isRefreshing])\n\n    useEffect(() => {\n      if (isLoading || isRefreshing || !showOverlaysConnectionStatus) {\n        return undefined\n      }\n      if (overlaysConnection === 'connected') {\n        setSomethingIsWrong(false)\n        setShowOverlaysConnectionState(false)\n        setTimedOut(false)\n        setContinueAnyway(false)\n      }\n      if (overlaysConnection === 'connecting') {\n        const timeout = setTimeout(() => {\n          setTimedOut(true)\n          console.error(\n            `Unable to connect to visual editing. Make sure you've setup '@sanity/visual-editing' correctly`,\n          )\n        }, MAX_TIME_TO_OVERLAYS_CONNECTION)\n        return () => clearTimeout(timeout)\n      }\n      if (overlaysConnection === 'reconnecting') {\n        const timeout = setTimeout(() => {\n          setTimedOut(true)\n          setSomethingIsWrong(true)\n        }, MAX_TIME_TO_OVERLAYS_CONNECTION)\n        return () => clearTimeout(timeout)\n      }\n      return undefined\n    }, [isLoading, overlaysConnection, isRefreshing, showOverlaysConnectionStatus])\n\n    const onIFrameLoad = useCallback(() => {\n      presentationRef.send({type: 'iframe loaded'})\n    }, [presentationRef])\n\n    const preventIframeInteraction = useMemo(() => {\n      return (\n        (isLoading || (overlaysConnection === 'connecting' && !isRefreshing)) && !continueAnyway\n      )\n    }, [continueAnyway, isLoading, isRefreshing, overlaysConnection])\n\n    const canUseViewTransition = useSyncExternalStore(\n      // eslint-disable-next-line no-empty-function\n      useCallback(() => () => {}, []),\n      () => CSS.supports(`(view-transition-name: test)`),\n    )\n    const iframeAnimations = useMemo(() => {\n      return [\n        preventIframeInteraction ? 'background' : 'active',\n        isLoading ? 'reloading' : 'idle',\n        // If CSS View Transitions are supported, then transition iframe viewport dimensions with that instead of Motion\n        canUseViewTransition ? '' : viewport,\n        showOverlaysConnectionStatus && !continueAnyway ? 'timedOut' : '',\n      ]\n    }, [\n      canUseViewTransition,\n      continueAnyway,\n      isLoading,\n      preventIframeInteraction,\n      showOverlaysConnectionStatus,\n      viewport,\n    ])\n\n    const [currentViewport, setCurrentViewport] = useState(viewport)\n    const [iframeStyle, setIframeStyle] = useState(iframeVariants[viewport])\n    useEffect(() => {\n      if (canUseViewTransition && viewport !== currentViewport) {\n        const update = () => {\n          setCurrentViewport(viewport)\n          setIframeStyle(iframeVariants[viewport])\n        }\n        if (\n          !prefersReducedMotion &&\n          'startViewTransition' in document &&\n          typeof document.startViewTransition === 'function'\n        ) {\n          document.startViewTransition({\n            update: () => flushSync(() => update()),\n            types: ['sanity-iframe-viewport'],\n          })\n        } else {\n          update()\n        }\n      }\n    }, [canUseViewTransition, prefersReducedMotion, currentViewport, viewport])\n\n    const toast = useToast()\n    const allowOrigins = useAllowPatterns(previewUrlRef)\n    const [checkOrigin, setCheckOrigin] = useState<false | string>(false)\n    const [reportedMismatches] = useState(new Set<string>())\n    const reportMismatchingOrigin = useEffectEvent((reportedOrigin: string) => {\n      if (allowOrigins.some((allow) => allow.test(reportedOrigin))) {\n        setCheckOrigin(reportedOrigin)\n        return\n      }\n      if (reportedMismatches.has(reportedOrigin)) return\n      reportedMismatches.add(reportedOrigin)\n      console.warn('Visual Editing is here but misconfigured', {reportedOrigin})\n      toast.push({\n        closable: true,\n        id: `presentation-iframe-origin-mismatch-${reportedOrigin}`,\n        status: 'error',\n        duration: Infinity,\n        title: t('preview-frame.configuration.error.title'),\n        description: (\n          <Translate\n            t={t}\n            i18nKey=\"preview-frame.configuration.error.description\"\n            components={{Code: 'code'}}\n            values={{\n              targetOrigin: previewUrl.origin,\n              reportedOrigin,\n            }}\n          />\n        ),\n      })\n    })\n    const navigate = usePresentationNavigate()\n    const navigateEvent = useEffectEvent((url: string) => {\n      if (!checkOrigin) return\n      const nextUrl = new URL(url, checkOrigin)\n      navigate(`${checkOrigin}${nextUrl.pathname}${nextUrl.search}${nextUrl.hash}`)\n    })\n    useEffect(() => {\n      if (!checkOrigin) {\n        return undefined\n      }\n      const target = ref.current?.contentWindow\n      if (!target) {\n        return undefined\n      }\n      const controller = createController({targetOrigin: checkOrigin})\n      controller.addTarget(target)\n      const comlink = controller.createChannel<VisualEditingControllerMsg, VisualEditingNodeMsg>(\n        {\n          name: 'presentation',\n          heartbeat: true,\n          connectTo: 'visual-editing',\n        },\n        createConnectionMachine<VisualEditingControllerMsg, VisualEditingNodeMsg>().provide({\n          actors: createCompatibilityActors<VisualEditingControllerMsg>(),\n        }),\n      )\n\n      comlink.on('visual-editing/navigate', (data) => {\n        navigateEvent(data.url)\n      })\n      const stop = comlink.start()\n\n      return () => {\n        stop()\n        controller.destroy()\n      }\n    }, [checkOrigin])\n    useEffect(() => {\n      if (overlaysConnection === 'connecting' || overlaysConnection === 'reconnecting') {\n        const interval = setInterval(() => {\n          ref.current?.contentWindow?.postMessage(\n            {domain: 'sanity/channels', from: 'presentation', type: 'presentation/status'},\n            /**\n             * The targetOrigin is set to '*' intentionally here, as we need to find out if the iframe is misconfigured and has the wrong origin\n             */\n            '*',\n          )\n        }, 1_000)\n\n        const controller = new AbortController()\n        window.addEventListener(\n          'message',\n          ({data}: MessageEvent<unknown>) => {\n            /**\n             * Listen for replies to presentation/status\n             */\n            if (\n              data &&\n              typeof data === 'object' &&\n              'domain' in data &&\n              data.domain === 'sanity/channels' &&\n              'type' in data &&\n              data.type === 'visual-editing/status' &&\n              'data' in data &&\n              typeof data.data === 'object' &&\n              data.data &&\n              'origin' in data.data &&\n              typeof data.data.origin === 'string'\n            ) {\n              reportMismatchingOrigin(data.data.origin)\n            }\n          },\n          {signal: controller.signal},\n        )\n\n        return () => {\n          controller.abort()\n          clearInterval(interval)\n        }\n      }\n      return undefined\n    }, [overlaysConnection, timedOut])\n\n    return (\n      <MotionConfig transition={prefersReducedMotion ? {duration: 0} : undefined}>\n        <TooltipDelayGroupProvider>\n          {previewHeader}\n          <Card flex={1} tone=\"transparent\">\n            <Flex\n              align=\"center\"\n              height=\"fill\"\n              justify=\"center\"\n              padding={(canUseViewTransition ? currentViewport : viewport) === 'desktop' ? 0 : 2}\n              sizing=\"border\"\n              style={{\n                position: 'relative',\n                cursor: iframeIsBusy ? 'wait' : undefined,\n              }}\n            >\n              <AnimatePresence>\n                {!somethingIsWrong &&\n                !isLoading &&\n                !isRefreshing &&\n                // viewport, // using CSS View Transitions instead of framer motion to drive this\n                showOverlaysConnectionStatus &&\n                !continueAnyway ? (\n                  <MotionFlex\n                    initial=\"initial\"\n                    animate=\"animate\"\n                    exit=\"exit\"\n                    variants={spinnerVariants}\n                    justify=\"center\"\n                    align=\"center\"\n                    style={{\n                      inset: '0',\n                      position: 'absolute',\n                      backdropFilter: timedOut\n                        ? 'blur(16px) saturate(0.5) grayscale(0.5)'\n                        : 'blur(2px)',\n                      ['transition' as string]: 'backdrop-filter 0.2s ease-in-out',\n                      // @TODO Because of Safari we have to do this\n                      WebkitBackdropFilter: timedOut\n                        ? 'blur(16px) saturate(0.5) grayscale(0.5)'\n                        : 'blur(2px)',\n                      WebkitTransition: '-webkit-backdrop-filter 0.2s ease-in-out',\n                      zIndex: 1,\n                    }}\n                  >\n                    <Flex\n                      style={{...sizes[viewport]}}\n                      justify=\"center\"\n                      align=\"center\"\n                      direction=\"column\"\n                      gap={4}\n                    >\n                      {timedOut && (\n                        <Button\n                          disabled\n                          mode=\"ghost\"\n                          text={t('preview-frame.continue-button.text')}\n                          style={{opacity: 0}}\n                        />\n                      )}\n                      <Card\n                        radius={2}\n                        tone={timedOut ? 'caution' : 'inherit'}\n                        padding={4}\n                        shadow={1}\n                      >\n                        <Flex justify=\"center\" align=\"center\" direction=\"column\" gap={4}>\n                          <Spinner muted />\n                          <Text muted size={1}>\n                            {timedOut\n                              ? t('preview-frame.status', {context: 'timeout'})\n                              : t('preview-frame.status', {context: 'connecting'})}\n                          </Text>\n                        </Flex>\n                      </Card>\n                      {timedOut && (\n                        <Button\n                          // mode=\"ghost\"\n                          tone=\"critical\"\n                          onClick={handleContinueAnyway}\n                          text={t('preview-frame.continue-button.text')}\n                        />\n                      )}\n                    </Flex>\n                  </MotionFlex>\n                ) : (isLoading || (overlaysConnection === 'connecting' && !isRefreshing)) &&\n                  !continueAnyway ? (\n                  <MotionFlex\n                    initial=\"initial\"\n                    animate=\"animate\"\n                    exit=\"exit\"\n                    variants={spinnerVariants}\n                    justify=\"center\"\n                    align=\"center\"\n                    style={{\n                      inset: '0',\n                      position: 'absolute',\n                      // boxShadow: '0 0 0 1px var(--card-shadow-outline-color)',\n                    }}\n                  >\n                    <Flex\n                      style={{...sizes[viewport]}}\n                      justify=\"center\"\n                      align=\"center\"\n                      direction=\"column\"\n                      gap={4}\n                    >\n                      <Spinner muted />\n                      <Text muted size={1}>\n                        {t('preview-frame.status', {context: 'loading'})}\n                      </Text>\n                    </Flex>\n                  </MotionFlex>\n                ) : somethingIsWrong && !continueAnyway ? (\n                  <MotionFlex\n                    initial=\"initial\"\n                    animate=\"animate\"\n                    exit=\"exit\"\n                    variants={errorVariants}\n                    justify=\"center\"\n                    align=\"center\"\n                    style={{\n                      background: 'var(--card-bg-color)',\n                      inset: '0',\n                      position: 'absolute',\n                    }}\n                  >\n                    <ErrorCard\n                      flex={1}\n                      message={t('preview-frame.connection.error.text')}\n                      onRetry={handleRetry}\n                      onContinueAnyway={handleContinueAnyway}\n                    >\n                      {devMode && (\n                        <>\n                          {overlaysConnection !== 'connected' && (\n                            <Card padding={3} radius={2} tone=\"critical\">\n                              <Stack space={3}>\n                                <Label muted size={0}>\n                                  {t('preview-frame.overlay.connection-status.label')}\n                                </Label>\n                                <Code size={1}>\n                                  {t('channel.status', {context: overlaysConnection})}\n                                </Code>\n                              </Stack>\n                            </Card>\n                          )}\n\n                          {loadersConnection !== 'connected' && (\n                            <Card padding={3} radius={2} tone=\"critical\">\n                              <Stack space={3}>\n                                <Label muted size={0}>\n                                  {t('preview-frame.loader.connection-status.label')}\n                                </Label>\n                                <Code size={1}>\n                                  {t('channel.status', {context: loadersConnection})}\n                                </Code>\n                              </Stack>\n                            </Card>\n                          )}\n                        </>\n                      )}\n                    </ErrorCard>\n                  </MotionFlex>\n                ) : null}\n              </AnimatePresence>\n              <IFrame\n                animate={iframeAnimations}\n                initial={['background']}\n                onLoad={onIFrameLoad}\n                preventClick={preventIframeInteraction}\n                ref={ref}\n                src={previewUrl.toString()}\n                style={iframeStyle}\n                variants={iframeVariants}\n              />\n            </Flex>\n          </Card>\n        </TooltipDelayGroupProvider>\n      </MotionConfig>\n    )\n  }),\n)\nPreview.displayName = 'Memo(ForwardRef(Preview))'\n\nconst sizes = {\n  desktop: {\n    width: '100%',\n    height: '100%',\n  },\n  mobile: {\n    width: 375,\n    height: 650,\n  },\n}\n\nconst spinnerVariants = {\n  initial: {opacity: 1},\n  animate: {opacity: [0, 0, 1]},\n  exit: {opacity: [1, 0, 0]},\n}\n\nconst errorVariants = {\n  initial: {opacity: 1},\n  animate: {opacity: [0, 0, 1]},\n  exit: {opacity: [1, 0, 0]},\n}\n\nconst iframeVariants = {\n  desktop: {\n    ...sizes.desktop,\n    boxShadow: '0 0 0 0px var(--card-border-color)',\n  },\n  mobile: {\n    ...sizes.mobile,\n    boxShadow: '0 0 0 1px var(--card-border-color)',\n  },\n  background: {\n    opacity: 0,\n    scale: 1,\n  },\n  idle: {\n    scale: 1,\n  },\n  reloading: {\n    scale: [1, 1, 1, 0.98],\n  },\n  active: {\n    opacity: [0, 0, 1],\n    scale: 1,\n  },\n  timedOut: {\n    opacity: [0, 0, 1],\n  },\n}\n", "/** @internal */\nexport function defineWarnOnce() {\n  let warned = false\n  // oxlint-disable-next-line no-explicit-any\n  return (...args: any[]): void => {\n    if (!warned) {\n      console.warn(...args)\n      warned = true\n    }\n  }\n}\n", "import {validateApiPerspective} from '@sanity/client'\nimport isEqual from 'fast-deep-equal'\nimport {type MutableRefObject, useCallback, useMemo, useRef, useState} from 'react'\n\nimport {type FrameState, type PresentationPerspective} from './types'\nimport {defineWarnOnce} from './util/warnOnce'\n\nexport type DocumentOnPage = {\n  _id: string\n  _type: string\n}\n\ntype DocumentCache = Record<string, DocumentOnPage>\ntype KeyedDocumentCache = Record<string, DocumentCache>\n\nconst warnOnceAboutCrossDatasetReference = defineWarnOnce()\n\n/**\n * @TODO should be refactored to an lru-cache that is keyed by the perspective, which could be an array (if it is, it should use consistent sorting),\n *       and the url path (optionally the origin too), so that swapping between perspectives and urls is fast.\n */\nexport function useDocumentsOnPage(\n  perspective: PresentationPerspective,\n  frameStateRef: MutableRefObject<FrameState>,\n): [\n  DocumentOnPage[],\n  (key: string, perspective: PresentationPerspective, state: DocumentOnPage[]) => void,\n] {\n  validateApiPerspective(perspective)\n\n  const [published, setPublished] = useState<KeyedDocumentCache>({})\n  const [previewDrafts, setPreviewDrafts] = useState<KeyedDocumentCache>({})\n\n  // Used to compare the frame url with its value when the cache was last updated\n  // If the url has changed, the entire cache is replaced\n  const urlRef = useRef<string | undefined>('')\n\n  const setDocumentsOnPage = useCallback(\n    // eslint-disable-next-line @typescript-eslint/no-shadow\n    (key: string, perspective: PresentationPerspective, sourceDocuments: DocumentOnPage[] = []) => {\n      const documents = sourceDocuments.filter((sourceDocument) => {\n        if ('_projectId' in sourceDocument && sourceDocument._projectId) {\n          // @TODO Handle cross dataset references\n\n          warnOnceAboutCrossDatasetReference(\n            'Cross dataset references are not supported yet, ignoring source document',\n            sourceDocument,\n          )\n          return false\n        }\n        return sourceDocument\n      })\n\n      const setCache = perspective === 'published' ? setPublished : setPreviewDrafts\n\n      setCache((cache) => {\n        // Create the `next` documents, dedupe by `_id`\n        const next: Record<string, DocumentOnPage> = {}\n        for (const document of documents) {\n          next[document._id] = document\n        }\n\n        // If the frame url has changed, replace the entire cache with the next documents\n        if (urlRef.current !== frameStateRef.current.url) {\n          urlRef.current = frameStateRef.current.url\n          return {[key]: next}\n        }\n\n        // If the keyed cache has changed, return the entire cache and replace the keyed part\n        const prev = cache[key]\n        if (!isEqual(prev, next)) {\n          return {...cache, [key]: next}\n        }\n\n        // Otherwise return the entire cache as is\n        return cache\n      })\n    },\n    [frameStateRef],\n  )\n\n  const documentsOnPage = useMemo(() => {\n    const keyedCache = perspective === 'published' ? published : previewDrafts\n    const uniqueDocuments = Object.values(keyedCache).reduce((acc, cache) => {\n      Object.values(cache).forEach((doc) => {\n        acc[doc._id] = doc\n      })\n      return acc\n    }, {})\n\n    return Object.values(uniqueDocuments)\n  }, [perspective, previewDrafts, published])\n\n  return [documentsOnPage, setDocumentsOnPage]\n}\n", "import {type ResponseQueryOptions} from '@sanity/client'\nimport {match, type Path} from 'path-to-regexp'\nimport {useEffect, useEffectEvent, useRef, useState} from 'react'\nimport {useClient} from 'sanity'\nimport {type RouterState, useRouter} from 'sanity/router'\n\nimport {API_VERSION} from './constants'\nimport {\n  type DocumentResolver,\n  type DocumentResolverContext,\n  type MainDocument,\n  type MainDocumentState,\n  type PresentationNavigate,\n  type PresentationPerspective,\n} from './types'\n\n// Helper function to \"unwrap\" a result when it is either explicitly provided or\n// returned as the result of a passed function\nfunction fnOrObj<T, U>(arg: T | ((ctx: U) => T), context: U): T {\n  return arg instanceof Function ? arg(context) : arg\n}\n\nfunction getQueryFromResult(\n  resolver: DocumentResolver,\n  context: DocumentResolverContext,\n): string | undefined {\n  if (resolver.resolve) {\n    const filter = resolver.resolve(context)?.filter\n    return filter\n      ? `// groq\n*[${filter}][0]{_id, _type}`\n      : undefined\n  }\n\n  if ('type' in resolver) {\n    return `// groq\n*[_type == \"${resolver.type}\"][0]{_id, _type}`\n  }\n\n  return `// groq\n*[${fnOrObj(resolver.filter, context)}][0]{_id, _type}`\n}\n\nfunction getParamsFromResult(\n  resolver: DocumentResolver,\n  context: DocumentResolverContext,\n): Record<string, string> {\n  if (resolver.resolve) {\n    return resolver.resolve(context)?.params ?? context.params\n  }\n\n  if ('type' in resolver) {\n    return {}\n  }\n\n  return fnOrObj(resolver.params, context) ?? context.params\n}\n\nexport function getRouteContext(route: Path, url: URL): DocumentResolverContext | undefined {\n  const routes = Array.isArray(route) ? route : [route]\n\n  for (route of routes) {\n    let {origin} = url\n    let path = route\n\n    // Handle absolute URLs\n    if (typeof route === 'string') {\n      try {\n        const absolute = new URL(route)\n\n        // If we are dealing with an absolute URL, ensure the origins match\n        if (absolute.origin !== origin) continue\n\n        origin = absolute.origin\n        path = absolute.pathname\n      } catch {\n        // Ignore, as we assume a relative path\n      }\n    }\n\n    try {\n      const matcher = match<Record<string, string>>(path, {decode: decodeURIComponent})\n      const result = matcher(url.pathname)\n      if (result) {\n        // eslint-disable-next-line @typescript-eslint/no-shadow\n        const {params, path} = result\n        return {origin, params, path}\n      }\n    } catch (e) {\n      throw new Error(`\"${route}\" is not a valid route pattern`, {cause: e})\n    }\n  }\n  return undefined\n}\n\nexport function useMainDocument(props: {\n  navigate?: PresentationNavigate\n  navigationHistory: RouterState[]\n  path?: string\n  targetOrigin: string\n  resolvers?: DocumentResolver[]\n  perspective: PresentationPerspective\n}): MainDocumentState | undefined {\n  const {navigate, navigationHistory, path, targetOrigin, resolvers = [], perspective} = props\n  const {state: routerState} = useRouter()\n  const client = useClient({apiVersion: API_VERSION})\n  const relativeUrl =\n    path || routerState._searchParams?.find(([key]) => key === 'preview')?.[1] || ''\n\n  const [mainDocumentState, setMainDocumentState] = useState<MainDocumentState | undefined>(\n    undefined,\n  )\n  const mainDocumentIdRef = useRef<string | undefined>(undefined)\n\n  const handleResponse = useEffectEvent((doc: MainDocument | undefined, url: URL) => {\n    if (!doc || mainDocumentIdRef.current !== doc._id) {\n      setMainDocumentState({\n        document: doc,\n        path: url.pathname,\n      })\n      mainDocumentIdRef.current = doc?._id\n\n      // We only want to force a navigation to the main document if\n      // the path changed but the document ID did not. An explicit\n      // document navigation should take precedence over displaying\n      // the main document. We determine if an explicit document\n      // navigation has occured by comparing the IDs of the last two\n      // resultant navigation states.\n      if (navigationHistory.at(-1)?.id === navigationHistory.at(-2)?.id) {\n        navigate?.({\n          state: {\n            id: doc?._id,\n            type: doc?._type,\n          },\n        })\n      }\n    }\n  })\n\n  useEffect(() => {\n    const url = new URL(relativeUrl, targetOrigin)\n\n    if (resolvers.length) {\n      let result:\n        | {\n            context: DocumentResolverContext\n            resolver: DocumentResolver\n          }\n        | undefined\n      for (const resolver of resolvers) {\n        const context = getRouteContext(resolver.route, url)\n        if (context) {\n          result = {context, resolver}\n          break\n        }\n      }\n\n      if (result) {\n        const query = getQueryFromResult(result.resolver, result.context)\n        const params = getParamsFromResult(result.resolver, result.context)\n        if (query) {\n          const controller = new AbortController()\n          const options: ResponseQueryOptions = {\n            perspective: perspective,\n            signal: controller.signal,\n            tag: 'use-main-document',\n          }\n\n          client\n            .fetch<MainDocument | undefined>(query, params, options)\n            .then((doc) => handleResponse(doc, url))\n            .catch((e) => {\n              if (e instanceof Error && e.name === 'AbortError') return\n              setMainDocumentState({document: undefined, path: url.pathname})\n              mainDocumentIdRef.current = undefined\n            })\n          return () => {\n            controller.abort()\n          }\n        }\n      }\n    }\n    setMainDocumentState(undefined)\n    mainDocumentIdRef.current = undefined\n    return undefined\n  }, [client, perspective, relativeUrl, resolvers, targetOrigin])\n\n  return mainDocumentState\n}\n", "import {studioPath} from '@sanity/client/csm'\nimport {urlStringToPath} from '@sanity/visual-editing-csm'\n\nimport {type PresentationStateParams} from '../types'\n\nexport function parseId(rawId: string | undefined): string | undefined {\n  if (rawId === undefined) {\n    return undefined\n  }\n\n  const segments = decodeURIComponent(rawId)?.split('.')\n\n  if (segments[0] === 'drafts') {\n    segments.shift()\n  }\n\n  return segments.join('.')\n}\n\nexport function parsePath(rawPath: string | undefined): string | undefined {\n  if (rawPath === undefined) {\n    return undefined\n  }\n\n  return studioPath.toString(urlStringToPath(decodeURIComponent(rawPath)))\n}\n\nexport function parseRouterState(state: PresentationStateParams): PresentationStateParams {\n  return {\n    id: parseId(state.id),\n    path: parsePath(state.path),\n    type: state.type,\n  }\n}\n", "/* eslint-disable @typescript-eslint/no-shadow */\nimport {type MutableRefObject, useCallback, useLayoutEffect, useMemo, useRef, useState} from 'react'\nimport {getPublishedId} from 'sanity'\nimport {type RouterContextValue, type RouterState, type SearchParam} from 'sanity/router'\n\nimport {\n  type CombinedSearchParams,\n  type FrameState,\n  type PresentationNavigate,\n  type PresentationParamsContextValue,\n  type PresentationSearchParams,\n  type PresentationStateParams,\n  type StructureDocumentPaneParams,\n} from './types'\nimport {parseRouterState} from './util/parse'\n\nfunction pruneObject<T extends RouterState | PresentationParamsContextValue>(obj: T): T {\n  return Object.fromEntries(\n    Object.entries(obj).filter(\n      ([, value]) => value !== undefined && value !== '' && value !== null,\n    ),\n  ) as T\n}\n\n/**\n * Ensures the array contains all members of the union T.\n */\nconst exhaustiveTupleOf =\n  <T>() =>\n  <U extends T[]>(array: U & ([T] extends [U[number]] ? unknown : 'Invalid') & {0: T}) =>\n    array\n\nconst maintainOnDocumentChange = exhaustiveTupleOf<keyof PresentationSearchParams>()([\n  'perspective',\n  'preview',\n  'viewport',\n])\n\nconst maintainOnSameDocument = exhaustiveTupleOf<keyof StructureDocumentPaneParams>()([\n  'changesInspectorTab',\n  'comment',\n  'inspect',\n  'instruction',\n  'scheduledDraft',\n  'parentRefPath',\n  'path',\n  'pathKey',\n  'rev',\n  'since',\n  'template',\n  'templateParams',\n  'version',\n  'view',\n])\n\nexport function useParams({\n  initialPreviewUrl,\n  routerNavigate,\n  routerState,\n  routerSearchParams,\n  frameStateRef,\n}: {\n  initialPreviewUrl: URL\n  routerNavigate: RouterContextValue['navigate']\n  routerState: RouterState & PresentationStateParams\n  routerSearchParams: {\n    [k: string]: string\n  }\n  frameStateRef: MutableRefObject<FrameState>\n}): {\n  isSameDocument: (state: PresentationStateParams) => boolean\n  navigate: PresentationNavigate\n  navigationHistory: RouterState[]\n  params: PresentationParamsContextValue\n  searchParams: PresentationSearchParams\n  structureParams: StructureDocumentPaneParams\n} {\n  const params = useMemo<PresentationParamsContextValue>(() => {\n    const {id, path, type} = parseRouterState(routerState)\n\n    return {\n      id,\n      type,\n      path,\n      preview: routerSearchParams.preview || initialPreviewUrl.toString(),\n      perspective: routerSearchParams.perspective,\n      viewport: routerSearchParams.viewport,\n      inspect: routerSearchParams.inspect,\n      scheduledDraft: routerSearchParams.scheduledDraft,\n\n      parentRefPath: routerSearchParams.parentRefPath,\n      rev: routerSearchParams.rev,\n      since: routerSearchParams.since,\n      template: routerSearchParams.template,\n      templateParams: routerSearchParams.templateParams,\n      view: routerSearchParams.view,\n      // assist\n      pathKey: routerSearchParams.pathKey,\n      instruction: routerSearchParams.instruction,\n      // comments\n      comment: routerSearchParams.comment,\n      changesInspectorTab: routerSearchParams.changesInspectorTab as 'history' | 'review',\n    }\n  }, [routerState, routerSearchParams, initialPreviewUrl])\n\n  const structureParams = useMemo<StructureDocumentPaneParams>(() => {\n    const pruned = pruneObject({\n      inspect: params.inspect,\n      scheduledDraft: params.scheduledDraft,\n      path: params.path,\n      parentRefPath: params.parentRefPath,\n      rev: params.rev,\n      since: params.since,\n      template: params.template,\n      templateParams: params.templateParams,\n      view: params.view,\n      // assist\n      pathKey: params.pathKey,\n      instruction: params.instruction,\n      // comments\n      comment: params.comment,\n      changesInspectorTab: params.changesInspectorTab,\n    })\n    return pruned\n  }, [\n    params.changesInspectorTab,\n    params.comment,\n    params.inspect,\n    params.instruction,\n    params.path,\n    params.pathKey,\n    params.parentRefPath,\n    params.rev,\n    params.since,\n    params.template,\n    params.templateParams,\n    params.view,\n    params.scheduledDraft,\n  ])\n\n  const searchParams = useMemo<PresentationSearchParams>(() => {\n    const pruned = pruneObject({\n      perspective: params.perspective,\n      preview: params.preview,\n      viewport: params.viewport,\n    })\n    return pruned\n  }, [params.perspective, params.preview, params.viewport])\n\n  const routerStateRef = useRef(routerState)\n\n  useLayoutEffect(() => {\n    routerStateRef.current = routerState\n  }, [routerState])\n\n  const [navigationHistory, setNavigationHistory] = useState<RouterState[]>([routerState])\n\n  // Helper function to check if a given document is the same as the one in the\n  // current router state\n  const isSameDocument = useCallback(({id, type}: PresentationStateParams) => {\n    const {current} = routerStateRef\n    return id === current.id && type === current.type\n  }, [])\n\n  const navigate = useCallback<PresentationNavigate>(\n    (options) => {\n      const {state, params, replace = false} = options\n\n      // Force navigation to use published IDs only\n      if (state?.id) state.id = getPublishedId(state.id)\n\n      // Get the current state and params\n      const {current} = routerStateRef\n      const currentState = {\n        id: current.id,\n        type: current.type,\n        path: current.path,\n      } satisfies PresentationStateParams\n      const currentParams = Object.fromEntries(current._searchParams || []) as CombinedSearchParams\n\n      // If state is provided, replace the current state with the provided\n      // state, otherwise maintain the current state\n      const nextState = state || currentState\n\n      // Different params need to be maintained under different conditions\n      const maintainedParamKeys = [\n        ...maintainOnDocumentChange,\n        ...(isSameDocument(nextState) ? maintainOnSameDocument : []),\n      ] satisfies (keyof CombinedSearchParams)[]\n\n      const maintainedParams = maintainedParamKeys.reduce((acc, key) => {\n        // @ts-expect-error changesInspectorTab union type doesn't play nicely\n        // here, if it were just a string it would be fine\n        acc[key] = currentParams[key]\n        return acc\n      }, {} as Partial<CombinedSearchParams>)\n\n      // If params are provided, merge them with the maintained params\n      const nextParams = {...maintainedParams, ...params}\n\n      const nextRouterState = {\n        ...nextState,\n        _searchParams: Object.entries(nextParams).reduce(\n          (acc, [key, value]) => [...acc, [key, value] as SearchParam],\n          [] as SearchParam[],\n        ),\n      } satisfies RouterState\n\n      setNavigationHistory((prev) => [...prev, nextRouterState])\n      routerNavigate(nextRouterState, {replace})\n    },\n    [isSameDocument, routerNavigate],\n  )\n\n  return {\n    isSameDocument,\n    navigate,\n    navigationHistory,\n    params,\n    searchParams,\n    structureParams,\n  }\n}\n", "import {type Controller} from '@sanity/comlink'\nimport {useCallback, useEffect, useState} from 'react'\n\nimport {POPUP_CHECK_INTERVAL} from './constants'\n\n/**\n * A hook for managing popup Window contexts\n *\n * This hook handles:\n * - Opening new popup Windows, and adding them as targets to the controller\n * - Tracking existing popup windows, and cleaning up closed popups\n *\n * @param controller - Comlink controller instance that manages communication\n * between Window contexts\n *\n * @returns An object containing:\n * - popups: A Set of currently open popup Window objects\n * - open: Function to open a new popup Window with the specified URL\n *\n */\nexport const usePopups = (\n  controller?: Controller,\n): {\n  popups: Set<Window>\n  open: (url: string) => void\n} => {\n  // State to keep track of open popup windows\n  const [popups, setPopups] = useState<Set<Window>>(() => new Set())\n\n  // Function to open a new popup window\n  const open = useCallback((url: string) => {\n    const source = window.open(url, '_blank')\n    if (source) {\n      setPopups((prev) => new Set(prev).add(source))\n    }\n  }, [])\n\n  // Handles syncing the existing popups with the controller\n  useEffect(() => {\n    const unsubs: Array<() => void> = []\n    if (popups.size && controller) {\n      // loop popups and add targets\n      for (const source of popups) {\n        if (source && 'closed' in source && !source.closed) {\n          unsubs.push(controller.addTarget(source))\n        }\n      }\n    }\n    return () => {\n      unsubs.forEach((unsub) => unsub())\n    }\n  }, [controller, popups])\n\n  // Checks for closed popups and removes them from the tracked Set\n  useEffect(() => {\n    if (popups.size) {\n      const interval = setInterval(() => {\n        const closed = new Set<Window>()\n        for (const source of popups) {\n          if (source && 'closed' in source && source.closed) {\n            closed.add(source)\n          }\n        }\n        if (closed.size) {\n          setPopups((prev) => {\n            const next = new Set(prev)\n            for (const source of closed) {\n              next.delete(source)\n            }\n            return next\n          })\n        }\n      }, POPUP_CHECK_INTERVAL)\n\n      return () => {\n        clearInterval(interval)\n      }\n    }\n    return undefined\n  }, [popups])\n\n  return {popups, open}\n}\n", "import {usePerspective} from 'sanity'\n\nimport {type PresentationPerspective} from './types'\n\n/**\n * @internal\n */\nexport function usePresentationPerspective({\n  scheduledDraft,\n}: {\n  scheduledDraft: string | undefined\n}): PresentationPerspective {\n  const {selectedPerspectiveName = 'drafts', selectedReleaseId, perspectiveStack} = usePerspective()\n\n  const perspective = (\n    selectedReleaseId || scheduledDraft\n      ? [scheduledDraft, ...perspectiveStack]\n      : selectedPerspectiveName\n  ) as PresentationPerspective\n  return perspective\n}\n", "import {type StatusEvent} from '@sanity/comlink'\nimport {useCallback, useMemo, useState} from 'react'\n\nimport {type ConnectionStatus} from './types'\n\n/**\n * A hook that manages and returns the connection status of multiple channels\n *\n * returns an array containing the\n * current status and a function to update the status based on incoming events\n *\n * The status can be one of the following:\n * - 'connected': If any channel is connected\n * - 'connecting': If the first connection is being established\n * - 'reconnecting': If a reconnection is in progress\n * - 'idle': If no connections have been made yet\n *\n * The function to update the status takes a `StatusEvent` object which includes\n * the channel and the status\n */\nexport function useStatus(): [ConnectionStatus, (event: StatusEvent) => void] {\n  // State to keep track of the status of each channel\n  const [statusMap, setStatusMap] = useState(\n    new Map<string, {status: ConnectionStatus; hasConnected: boolean}>(),\n  )\n\n  // Memoized computation of the overall status based on the status of individual channels\n  const memoStatus = useMemo(() => {\n    const values = Array.from(statusMap.values())\n    // If any channel is connected, return the `connected` status\n    if (values.find(({status}) => status === 'connected')) {\n      return 'connected'\n    }\n    // If the initial connection is being established, return `connecting` status\n    const handshaking = values.filter(({status}) => status === 'connecting')\n    if (handshaking.length) {\n      return handshaking.some(({hasConnected}) => !hasConnected) ? 'connecting' : 'reconnecting'\n    }\n    // If nothing has happened yet, return `idle` status\n    return 'idle'\n  }, [statusMap])\n\n  // Callback to update the status map based on the received event\n  const setStatusFromEvent = useCallback((event: StatusEvent) => {\n    setStatusMap((prev) => {\n      const next = new Map(prev)\n      if (event.status === 'disconnected') {\n        // Remove the channel from the map if a disconnect event is received\n        next.delete(event.connection)\n      } else {\n        // Update the status and connection flag for the channel\n        const hasConnected =\n          next.get(event.connection)?.hasConnected || event.status === 'connected'\n        const status = event.status === 'handshaking' ? 'connecting' : event.status\n        next.set(event.connection, {status, hasConnected})\n      }\n      return next\n    })\n  }, [])\n\n  // Return the overall status and the function to update the status\n  return [memoStatus, setStatusFromEvent]\n}\n", "/* eslint-disable @typescript-eslint/no-shadow */\nimport {\n  type Controller,\n  createConnectionMachine,\n  createController,\n  type Message,\n} from '@sanity/comlink'\nimport {\n  createCompatibilityActors,\n  type PreviewKitNodeMsg,\n  type VisualEditingControllerMsg,\n  type VisualEditingNodeMsg,\n} from '@sanity/presentation-comlink'\nimport {\n  urlSearchParamVercelProtectionBypass,\n  urlSearchParamVercelSetBypassCookie,\n} from '@sanity/preview-url-secret/constants'\nimport {BoundaryElementProvider, Flex} from '@sanity/ui'\nimport {useActorRef, useSelector} from '@xstate/react'\nimport {\n  lazy,\n  Suspense,\n  useCallback,\n  useEffect,\n  useEffectEvent,\n  useMemo,\n  useRef,\n  useState,\n} from 'react'\nimport {\n  type CommentIntentGetter,\n  COMMENTS_INSPECTOR_NAME,\n  type SanityDocument,\n  type Tool,\n  useDataset,\n  useProjectId,\n  useUnique,\n  useWorkspace,\n} from 'sanity'\nimport {type RouterContextValue, useRouter} from 'sanity/router'\nimport {styled} from 'styled-components'\n\nimport {DEFAULT_TOOL_NAME, EDIT_INTENT_MODE} from './constants'\nimport PostMessageFeatures from './features/PostMessageFeatures'\nimport {presentationMachine} from './machines/presentation-machine'\nimport {type PreviewUrlRef} from './machines/preview-url'\nimport {SharedStateProvider} from './overlays/SharedStateProvider'\nimport {Panel} from './panels/Panel'\nimport {Panels} from './panels/Panels'\nimport {PresentationContent} from './PresentationContent'\nimport {PresentationNavigateProvider} from './PresentationNavigateProvider'\nimport {usePresentationNavigator} from './PresentationNavigator'\nimport {PresentationParamsProvider} from './PresentationParamsProvider'\nimport {PresentationProvider} from './PresentationProvider'\nimport {Preview} from './preview/Preview'\nimport {\n  type FrameState,\n  type PresentationNavigate,\n  type PresentationPluginOptions,\n  type PresentationStateParams,\n  type PresentationViewport,\n  type StructureDocumentPaneParams,\n  type VisualEditingConnection,\n} from './types'\nimport {useAllowPatterns} from './useAllowPatterns'\nimport {useDocumentsOnPage} from './useDocumentsOnPage'\nimport {useMainDocument} from './useMainDocument'\nimport {useParams} from './useParams'\nimport {usePopups} from './usePopups'\nimport {usePresentationPerspective} from './usePresentationPerspective'\nimport {useStatus} from './useStatus'\nimport {useTargetOrigin} from './useTargetOrigin'\nimport {debounce} from './util/debounce'\n\nconst LiveQueries = lazy(() => import('./loader/LiveQueries'))\nconst PostMessageDocuments = lazy(() => import('./overlays/PostMessageDocuments'))\nconst PostMessageRefreshMutations = lazy(() => import('./editor/PostMessageRefreshMutations'))\nconst PostMessagePerspective = lazy(() => import('./PostMessagePerspective'))\nconst PostMessagePreviewSnapshots = lazy(() => import('./editor/PostMessagePreviewSnapshots'))\nconst PostMessageSchema = lazy(() => import('./overlays/schema/PostMessageSchema'))\nconst PostMessageTelemetry = lazy(() => import('./PostMessageTelemetry'))\n\nconst Container = styled(Flex)`\n  overflow-x: auto;\n`\n\nexport default function PresentationTool(props: {\n  tool: Tool<PresentationPluginOptions>\n  canToggleSharePreviewAccess: boolean\n  canUseSharedPreviewAccess: boolean\n  vercelProtectionBypass: string | null\n  initialPreviewUrl: URL\n  previewUrlRef: PreviewUrlRef\n}): React.JSX.Element {\n  const {\n    canToggleSharePreviewAccess,\n    canUseSharedPreviewAccess,\n    tool,\n    vercelProtectionBypass,\n    initialPreviewUrl,\n    previewUrlRef,\n  } = props\n\n  const allowOrigins = useAllowPatterns(previewUrlRef)\n  const targetOrigin = useTargetOrigin(previewUrlRef)\n\n  const components = tool.options?.components\n  const name = tool.name || DEFAULT_TOOL_NAME\n  const {unstable_navigator, unstable_header} = components || {}\n\n  const {navigate: routerNavigate, state: routerState} = useRouter() as RouterContextValue & {\n    state: PresentationStateParams\n  }\n  const routerSearchParams = useUnique(Object.fromEntries(routerState._searchParams || []))\n\n  const canSharePreviewAccess = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewMode?.shareAccess !== false,\n  )\n\n  const [devMode] = useState(() => {\n    const option = tool.options?.devMode\n\n    if (typeof option === 'function') return option()\n    if (typeof option === 'boolean') return option\n\n    return typeof window !== 'undefined' && window.location.hostname === 'localhost'\n  })\n\n  const iframeRef = useRef<HTMLIFrameElement>(null)\n\n  const [controller, setController] = useState<Controller>()\n  const [visualEditingComlink, setVisualEditingComlink] = useState<VisualEditingConnection | null>(\n    null,\n  )\n\n  const frameStateRef = useRef<FrameState>({\n    title: undefined,\n    url: undefined,\n  })\n\n  const {isSameDocument, navigate, navigationHistory, params, searchParams, structureParams} =\n    useParams({\n      initialPreviewUrl,\n      routerNavigate,\n      routerState,\n      routerSearchParams,\n      frameStateRef,\n    })\n  const perspective = usePresentationPerspective({scheduledDraft: params.scheduledDraft})\n\n  const presentationRef = useActorRef(presentationMachine)\n\n  const viewport = useMemo(() => (params.viewport ? 'mobile' : 'desktop'), [params.viewport])\n\n  const [documentsOnPage, setDocumentsOnPage] = useDocumentsOnPage(perspective, frameStateRef)\n\n  const projectId = useProjectId()\n  const dataset = useDataset()\n\n  const mainDocumentState = useMainDocument({\n    navigate,\n    navigationHistory,\n    path: params.preview,\n    targetOrigin,\n    resolvers: tool.options?.resolve?.mainDocuments,\n    perspective,\n  })\n\n  const [overlaysConnection, setOverlaysConnection] = useStatus()\n  const [loadersConnection, setLoadersConnection] = useStatus()\n  const [previewKitConnection, setPreviewKitConnection] = useStatus()\n\n  const {open: handleOpenPopup} = usePopups(controller)\n\n  const isLoading = useSelector(presentationRef, (state) => state.matches('loading'))\n\n  useEffect(() => {\n    const target = iframeRef.current?.contentWindow\n\n    if (!target || isLoading) return undefined\n\n    const controller = createController({targetOrigin})\n    controller.addTarget(target)\n    setController(controller)\n\n    return () => {\n      controller.destroy()\n      setController(undefined)\n    }\n  }, [targetOrigin, isLoading])\n\n  const handleNavigate = useEffectEvent<PresentationNavigate>((options) => {\n    navigate(options)\n  })\n\n  const refreshRef = useRef<number>(undefined)\n\n  useEffect(() => {\n    if (!controller) return undefined\n\n    const comlink = controller.createChannel<VisualEditingControllerMsg, VisualEditingNodeMsg>(\n      {\n        name: 'presentation',\n        heartbeat: true,\n        connectTo: 'visual-editing',\n      },\n      createConnectionMachine<VisualEditingControllerMsg, VisualEditingNodeMsg>().provide({\n        actors: createCompatibilityActors<VisualEditingControllerMsg>(),\n      }),\n    )\n\n    comlink.on('visual-editing/focus', (data) => {\n      if (!('id' in data)) return\n      handleNavigate({\n        state: {\n          type: data.type,\n          id: data.id,\n          path: data.path,\n        },\n      })\n    })\n\n    comlink.on('visual-editing/navigate', (data) => {\n      const {title} = data\n      let url = data.url\n      /**\n       * The URL is relative, we need to resolve it to an absolute URL\n       */\n      if (!url.startsWith('http')) {\n        try {\n          url = new URL(url, targetOrigin).toString()\n        } catch {\n          // ignore\n        }\n      }\n\n      if (frameStateRef.current.url !== url) {\n        // Workaround for React Compiler not yet fully supporting try/catch/finally syntax\n        const run = () => {\n          // Handle bypass params being forwarded to the final URL\n          const [urlWithoutSearch, search] = url.split('?')\n          const searchParams = new URLSearchParams(search)\n          searchParams.delete(urlSearchParamVercelProtectionBypass)\n          searchParams.delete(urlSearchParamVercelSetBypassCookie)\n          handleNavigate({\n            params: {\n              preview: `${urlWithoutSearch}${searchParams.size > 0 ? '?' : ''}${searchParams}`,\n            },\n          })\n        }\n        try {\n          run()\n        } catch {\n          handleNavigate({params: {preview: url}})\n        }\n      }\n      frameStateRef.current = {title, url}\n    })\n\n    comlink.on('visual-editing/meta', (data) => {\n      frameStateRef.current.title = data.title\n    })\n\n    comlink.on('visual-editing/toggle', (data) => {\n      presentationRef.send({type: 'toggle visual editing overlays', enabled: data.enabled})\n    })\n\n    comlink.on('visual-editing/documents', (data) => {\n      setDocumentsOnPage(\n        'visual-editing',\n        // oxlint-disable-next-line no-explicit-any\n        data.perspective as unknown as any,\n        data.documents,\n      )\n    })\n\n    // @todo This won't work for multiple window contexts?\n    comlink.on('visual-editing/refreshing', (data) => {\n      if (data.source === 'manual') {\n        clearTimeout(refreshRef.current)\n      } else if (data.source === 'mutation') {\n        presentationRef.send({type: 'iframe refresh'})\n      }\n    })\n\n    comlink.on('visual-editing/refreshed', () => {\n      presentationRef.send({type: 'iframe loaded'})\n    })\n\n    comlink.onStatus(setOverlaysConnection)\n\n    const stop = comlink.start()\n    setVisualEditingComlink(comlink)\n    return () => {\n      stop()\n      setVisualEditingComlink(null)\n    }\n  }, [controller, presentationRef, setDocumentsOnPage, setOverlaysConnection, targetOrigin])\n\n  useEffect(() => {\n    if (!controller) return undefined\n    const comlink = controller.createChannel<Message, PreviewKitNodeMsg>(\n      {\n        name: 'presentation',\n        connectTo: 'preview-kit',\n        heartbeat: true,\n      },\n      createConnectionMachine<Message, PreviewKitNodeMsg>().provide({\n        actors: createCompatibilityActors(),\n      }),\n    )\n\n    comlink.onStatus(setPreviewKitConnection)\n\n    comlink.on('preview-kit/documents', (data) => {\n      if (data.projectId === projectId && data.dataset === dataset) {\n        setDocumentsOnPage(\n          'preview-kit',\n          // oxlint-disable-next-line no-explicit-any\n          data.perspective as unknown as any,\n          data.documents,\n        )\n      }\n    })\n\n    return comlink.start()\n  }, [controller, dataset, projectId, setDocumentsOnPage, setPreviewKitConnection, targetOrigin])\n\n  const handleFocusPath = useMemo(\n    () =>\n      // When moving from one field to another, blur and focus events will trigger\n      // this handler. We debounce to avoid unwanted intermediate navigations this\n      // would cause.\n      debounce<(state: Required<PresentationStateParams>) => void>((state) => {\n        // We only ever want to update the path if we are still viewing the\n        // document that was active when the focus event was triggered\n        if (isSameDocument(state)) {\n          navigate({\n            state,\n            replace: true,\n          })\n        }\n      }, 0),\n    [isSameDocument, navigate],\n  )\n\n  const handlePreviewPath = useCallback(\n    (nextPath: string) => {\n      const url = new URL(nextPath, targetOrigin)\n      const preview = url.toString()\n      if (params.preview === preview) {\n        return\n      }\n      if (Array.isArray(allowOrigins)) {\n        if (allowOrigins.some((pattern) => pattern.test(preview))) {\n          navigate({params: {preview}})\n        }\n      } else if (url.origin === targetOrigin) {\n        navigate({params: {preview}})\n      }\n    },\n    [targetOrigin, params.preview, allowOrigins, navigate],\n  )\n\n  const handleStructureParams = useCallback(\n    (params: StructureDocumentPaneParams) => {\n      navigate({params})\n    },\n    [navigate],\n  )\n\n  const handleEditReference = useCallback<PresentationNavigate>(\n    (options) => {\n      navigate(options)\n    },\n    [navigate],\n  )\n\n  // Dispatch a focus or blur message when the id or path change\n  useEffect(() => {\n    if (params.id && params.path) {\n      visualEditingComlink?.post('presentation/focus', {id: params.id, path: params.path})\n    } else {\n      visualEditingComlink?.post('presentation/blur')\n    }\n  }, [params.id, params.path, visualEditingComlink])\n\n  // Dispatch a navigation message when the preview param changes\n  useEffect(() => {\n    if (\n      frameStateRef.current.url &&\n      params.preview &&\n      frameStateRef.current.url !== params.preview\n    ) {\n      try {\n        const frameOrigin = new URL(frameStateRef.current.url, targetOrigin).origin\n        const previewOrigin = new URL(params.preview, targetOrigin).origin\n        if (frameOrigin !== previewOrigin) {\n          return\n        }\n      } catch {\n        // ignore\n      }\n\n      frameStateRef.current.url = params.preview\n      if (overlaysConnection === 'connected') {\n        /**\n         * Translate the possibly absolute params url back to a relative URL\n         */\n        let url = params.preview\n        if (url.startsWith('http')) {\n          try {\n            const newUrl = new URL(params.preview, targetOrigin)\n            url = newUrl.pathname + newUrl.search + newUrl.hash\n          } catch {\n            // ignore\n          }\n        }\n        visualEditingComlink?.post('presentation/navigate', {\n          url,\n          type: 'replace',\n        })\n      }\n    }\n  }, [overlaysConnection, targetOrigin, params.preview, visualEditingComlink])\n\n  const toggleOverlay = useCallback(\n    () => visualEditingComlink?.post('presentation/toggle-overlay'),\n    [visualEditingComlink],\n  )\n\n  const [displayedDocument, setDisplayedDocument] = useState<\n    Partial<SanityDocument> | null | undefined\n  >(null)\n\n  useEffect(() => {\n    const handleKeyUp = (e: KeyboardEvent) => {\n      if (isAltKey(e)) {\n        toggleOverlay()\n      }\n    }\n    const handleKeydown = (e: KeyboardEvent) => {\n      if (isAltKey(e)) {\n        toggleOverlay()\n      }\n\n      if (isHotkey(['mod', '\\\\'], e)) {\n        toggleOverlay()\n      }\n    }\n    window.addEventListener('keydown', handleKeydown)\n    window.addEventListener('keyup', handleKeyUp)\n    return () => {\n      window.removeEventListener('keydown', handleKeydown)\n      window.removeEventListener('keyup', handleKeyUp)\n    }\n  }, [toggleOverlay])\n\n  const [boundaryElement, setBoundaryElement] = useState<HTMLDivElement | null>(null)\n\n  const [{navigatorEnabled, toggleNavigator}, PresentationNavigator] = usePresentationNavigator({\n    unstable_navigator,\n  })\n\n  const handleRefresh = useCallback(\n    (fallback: () => void) => {\n      presentationRef.send({type: 'iframe refresh'})\n      if (visualEditingComlink) {\n        // We only wait 300ms for the iframe to ack the refresh request before running the fallback logic\n        refreshRef.current = window.setTimeout(fallback, 300)\n        visualEditingComlink.post('presentation/refresh', {\n          source: 'manual',\n          livePreviewEnabled:\n            previewKitConnection === 'connected' || loadersConnection === 'connected',\n        })\n        return\n      }\n      fallback()\n    },\n    [loadersConnection, presentationRef, previewKitConnection, visualEditingComlink],\n  )\n\n  const workspace = useWorkspace()\n\n  const getCommentIntent = useCallback<CommentIntentGetter>(\n    ({id, type, path}) => {\n      if (frameStateRef.current.url) {\n        return {\n          title: frameStateRef.current.title || frameStateRef.current.url,\n          name: 'edit',\n          params: {\n            id,\n            path,\n            type,\n            inspect: COMMENTS_INSPECTOR_NAME,\n            workspace: workspace.name,\n            mode: EDIT_INTENT_MODE,\n            preview: params.preview,\n          },\n        }\n      }\n      return undefined\n    },\n    [params.preview, workspace.name],\n  )\n\n  const setViewport = useCallback(\n    (next: PresentationViewport) => {\n      // Omit the viewport URL search param if the next viewport state is the\n      // default: 'desktop'\n      const viewport = next === 'desktop' ? undefined : 'mobile'\n      navigate({\n        params: {viewport},\n        replace: true,\n      })\n    },\n    [navigate],\n  )\n\n  return (\n    <>\n      <PresentationProvider\n        devMode={devMode}\n        name={name}\n        navigate={navigate}\n        params={params}\n        searchParams={searchParams}\n        structureParams={structureParams}\n      >\n        <PresentationNavigateProvider navigate={navigate}>\n          <PresentationParamsProvider params={params}>\n            <SharedStateProvider comlink={visualEditingComlink}>\n              <Container data-testid=\"presentation-root\" height=\"fill\">\n                <Panels>\n                  <PresentationNavigator />\n                  <Panel\n                    id=\"preview\"\n                    minWidth={325}\n                    defaultSize={navigatorEnabled ? 50 : 75}\n                    order={3}\n                  >\n                    <Flex direction=\"column\" flex={1} height=\"fill\" ref={setBoundaryElement}>\n                      <BoundaryElementProvider element={boundaryElement}>\n                        <Preview\n                          // @TODO move closer to the <iframe> element itself to allow for more precise handling of when to reload the iframe and when to reconnect when the target origin changes\n                          // Make sure the iframe is unmounted if the targetOrigin has changed\n                          key={targetOrigin}\n                          canSharePreviewAccess={canSharePreviewAccess}\n                          canToggleSharePreviewAccess={canToggleSharePreviewAccess}\n                          canUseSharedPreviewAccess={canUseSharedPreviewAccess}\n                          header={unstable_header}\n                          initialUrl={initialPreviewUrl}\n                          loadersConnection={loadersConnection}\n                          navigatorEnabled={navigatorEnabled}\n                          onPathChange={handlePreviewPath}\n                          onRefresh={handleRefresh}\n                          openPopup={handleOpenPopup}\n                          overlaysConnection={overlaysConnection}\n                          previewUrl={params.preview}\n                          perspective={perspective}\n                          ref={iframeRef}\n                          setViewport={setViewport}\n                          targetOrigin={targetOrigin}\n                          toggleNavigator={toggleNavigator}\n                          toggleOverlay={toggleOverlay}\n                          viewport={viewport}\n                          vercelProtectionBypass={vercelProtectionBypass}\n                          presentationRef={presentationRef}\n                          previewUrlRef={previewUrlRef}\n                        />\n                      </BoundaryElementProvider>\n                    </Flex>\n                  </Panel>\n                  <PresentationContent\n                    documentId={params.id}\n                    documentsOnPage={documentsOnPage}\n                    documentType={params.type}\n                    getCommentIntent={getCommentIntent}\n                    mainDocumentState={mainDocumentState}\n                    onEditReference={handleEditReference}\n                    onFocusPath={handleFocusPath}\n                    onStructureParams={handleStructureParams}\n                    searchParams={searchParams}\n                    setDisplayedDocument={setDisplayedDocument}\n                    structureParams={structureParams}\n                  />\n                </Panels>\n              </Container>\n            </SharedStateProvider>\n          </PresentationParamsProvider>\n        </PresentationNavigateProvider>\n      </PresentationProvider>\n      <Suspense>\n        {controller && (\n          <LiveQueries\n            controller={controller}\n            perspective={perspective}\n            liveDocument={displayedDocument}\n            onDocumentsOnPage={setDocumentsOnPage}\n            onLoadersConnection={setLoadersConnection}\n          />\n        )}\n        {visualEditingComlink && params.id && params.type && (\n          <PostMessageRefreshMutations\n            comlink={visualEditingComlink}\n            id={params.id}\n            type={params.type}\n            loadersConnection={loadersConnection}\n            previewKitConnection={previewKitConnection}\n          />\n        )}\n        {visualEditingComlink && (\n          <PostMessageSchema comlink={visualEditingComlink} perspective={perspective} />\n        )}\n        {visualEditingComlink && documentsOnPage.length > 0 && (\n          <PostMessagePreviewSnapshots\n            comlink={visualEditingComlink}\n            perspective={perspective}\n            refs={documentsOnPage}\n          />\n        )}\n        {visualEditingComlink && (\n          <PostMessageDocuments comlink={visualEditingComlink} perspective={perspective} />\n        )}\n        {visualEditingComlink && <PostMessageFeatures comlink={visualEditingComlink} />}\n        {visualEditingComlink && (\n          <PostMessagePerspective comlink={visualEditingComlink} perspective={perspective} />\n        )}\n        {visualEditingComlink && <PostMessageTelemetry comlink={visualEditingComlink} />}\n      </Suspense>\n    </>\n  )\n}\n\n// @TODO reconcile with core utils\nfunction isAltKey(event: KeyboardEvent): boolean {\n  return event.key === 'Alt'\n}\n\n// @TODO reconcile with core utils\nconst IS_MAC =\n  typeof window != 'undefined' && /Mac|iPod|iPhone|iPad/.test(window.navigator.platform)\nconst MODIFIERS: Record<string, 'altKey' | 'ctrlKey' | 'metaKey' | 'shiftKey'> = {\n  alt: 'altKey',\n  ctrl: 'ctrlKey',\n  mod: IS_MAC ? 'metaKey' : 'ctrlKey',\n  shift: 'shiftKey',\n}\n// @TODO reconcile with core utils\nfunction isHotkey(keys: string[], event: KeyboardEvent): boolean {\n  return keys.every((key) => {\n    if (MODIFIERS[key]) {\n      return event[MODIFIERS[key]]\n    }\n    return event.key === key.toUpperCase()\n  })\n}\n", "import {createPreviewSecret} from '@sanity/preview-url-secret/create-secret'\nimport {type SanityClient} from 'sanity'\nimport {fromPromise, type PromiseActorLogic} from 'xstate'\n\n/** @internal */\nexport function defineCreatePreviewSecretActor({\n  client,\n  currentUserId,\n}: {\n  client: SanityClient\n  currentUserId: string | undefined\n}): PromiseActorLogic<{\n  secret: string\n  expiresAt: Date\n}> {\n  return fromPromise(async () => {\n    return await createPreviewSecret(client, 'sanity/presentation', location.href, currentUserId)\n  })\n}\n", "import {fetchSharedAccessQuery} from '@sanity/preview-url-secret/constants'\nimport {type SanityClient} from 'sanity'\nimport {fromPromise, type PromiseActorLogic} from 'xstate'\n\n/** @internal */\nexport function defineReadSharedSecretActor({\n  client,\n}: {\n  client: SanityClient\n}): PromiseActorLogic<string | null> {\n  return fromPromise(async () => {\n    return client.fetch<string | null>(\n      fetchSharedAccessQuery,\n      {},\n      {tag: 'presentation.fallback-to-shared-access-secret'},\n    )\n  })\n}\n", "import {fromPromise, type PromiseActorLogic} from 'xstate'\n\nimport {type PreviewUrlAllowOption, type PreviewUrlAllowOptionContext} from '../types'\n\ninterface Context extends Pick<PreviewUrlAllowOptionContext, 'client'> {\n  allowOption: PreviewUrlAllowOption | undefined\n}\ntype Input = Omit<PreviewUrlAllowOptionContext, 'client' | 'origin'>\n\n/** @internal */\nexport function defineResolveAllowPatternsActor({\n  client,\n  allowOption,\n}: Context): PromiseActorLogic<URLPattern[], Input> {\n  return fromPromise<URLPattern[], Input>(async ({input}) => {\n    const {initialUrl} = input\n\n    /**\n     * Lazy load the URLPattern polyfill on-demand, if needed\n     */\n    if (typeof URLPattern === 'undefined') {\n      await import('urlpattern-polyfill')\n    }\n\n    /**\n     * If no allow option is provided, we use the initial URL to infer the pattern\n     */\n    if (!allowOption) {\n      return [new URLPattern(initialUrl.origin)]\n    }\n\n    const maybePatterns =\n      typeof allowOption === 'function'\n        ? await allowOption({client, origin, initialUrl})\n        : allowOption\n    const patterns = Array.isArray(maybePatterns) ? maybePatterns : [maybePatterns]\n    const urlPatterns = patterns.map((value) => {\n      const urlPattern = new URLPattern(value)\n      if (urlPattern.hostname === '*') {\n        throw new Error(\n          `It's insecure to allow any hostname, it could disclose data to a malicious site`,\n        )\n      }\n      return urlPattern\n    })\n    /**\n     * If the declared patterns don't consider the initial URL valid, we add it to the list of patterns\n     */\n    if (!urlPatterns.some((pattern) => pattern.test(initialUrl.origin))) {\n      return [...urlPatterns, new URLPattern(initialUrl.origin)]\n    }\n\n    return urlPatterns\n  })\n}\n", "import {type SanityClient} from 'sanity'\nimport {fromPromise, type PromiseActorLogic} from 'xstate'\n\nimport {type PresentationPerspective, type PreviewUrlOption} from '../types'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\n\n/** @internal */\nexport function defineResolveInitialUrlActor({\n  client,\n  studioBasePath,\n  previewUrlOption,\n  perspective,\n}: {\n  client: SanityClient\n  studioBasePath: string\n  previewUrlOption: PreviewUrlOption | undefined\n  perspective: PresentationPerspective\n}): PromiseActorLogic<URL, {previewSearchParam: string | null}> {\n  return fromPromise<URL, {previewSearchParam: string | null}>(\n    async ({input}: {input: {previewSearchParam: string | null}}) => {\n      const {origin} = location\n      /**\n       * If the previewUrlOption is a function, we need to resolve it and maintain backwards compatibility\n       */\n      if (typeof previewUrlOption === 'function') {\n        const initial = await previewUrlOption({\n          client,\n          studioBasePath,\n          // @TODO handle checking permissions here, and then generating a secret\n          previewUrlSecret: '',\n          studioPreviewPerspective: encodeStudioPerspective(perspective),\n          previewSearchParam: input.previewSearchParam,\n        })\n        return new URL(initial, origin)\n      }\n\n      /**\n       * Provide backwards compatibility for versions where `previewUrl` where optional\n       */\n      if (!previewUrlOption) {\n        return new URL('/', origin)\n      }\n      /**\n       * Support setting `previewUrl` as a string shorthand\n       */\n      if (typeof previewUrlOption === 'string') {\n        return new URL(previewUrlOption, origin)\n      }\n\n      if (typeof previewUrlOption.initial === 'function') {\n        const initial = await previewUrlOption.initial({\n          client,\n          origin,\n        })\n        return new URL(initial, origin)\n      }\n\n      if (typeof previewUrlOption.initial === 'string') {\n        return new URL(previewUrlOption.initial, origin)\n      }\n\n      return new URL(previewUrlOption.preview || '/', previewUrlOption.origin || origin)\n    },\n  )\n}\n", "import {fromPromise, type PromiseActorLogic} from 'xstate'\n\nimport {\n  type PreviewUrlOption,\n  type PreviewUrlPreviewMode,\n  type PreviewUrlPreviewModeOptionContext,\n} from '../types'\n\ntype Options = Omit<PreviewUrlPreviewModeOptionContext, 'origin'>\n\ninterface Context extends Pick<Options, 'client'> {\n  previewUrlOption: PreviewUrlOption | undefined\n}\ntype Input = Omit<Options, 'client'>\n\n/** @internal */\nexport function defineResolvePreviewModeActor({\n  client,\n  previewUrlOption,\n}: Context): PromiseActorLogic<PreviewUrlPreviewMode | false, Input> {\n  return fromPromise<PreviewUrlPreviewMode | false, Input>(async ({input}) => {\n    const {targetOrigin} = input\n\n    /**\n     * Handle legacy draftMode options\n     */\n    if (typeof previewUrlOption === 'object' && previewUrlOption?.draftMode) {\n      return {\n        enable: previewUrlOption.draftMode.enable,\n        shareAccess: previewUrlOption.draftMode.shareAccess ?? true,\n      }\n    }\n\n    /**\n     * If no preview mode option is provided, we disable preview mode\n     */\n    if (\n      !previewUrlOption ||\n      typeof previewUrlOption === 'string' ||\n      typeof previewUrlOption === 'function' ||\n      !previewUrlOption.previewMode\n    ) {\n      return false\n    }\n\n    /**\n     * If the option is a function, we resolve it\n     */\n    const previewMode =\n      typeof previewUrlOption.previewMode === 'function'\n        ? await previewUrlOption.previewMode({client, origin, targetOrigin})\n        : previewUrlOption.previewMode\n\n    if (previewMode === false) {\n      return false\n    }\n\n    /**\n     * Return only supported preview mode options, filter out unknowns\n     */\n    return {\n      enable: previewMode.enable,\n      shareAccess: previewMode.shareAccess ?? true,\n    }\n  })\n}\n", "import {\n  urlSearchParamPreviewPathname,\n  urlSearchParamPreviewPerspective,\n  urlSearchParamPreviewSecret,\n} from '@sanity/preview-url-secret/constants'\nimport {type SanityClient} from 'sanity'\nimport {fromPromise, type PromiseActorLogic} from 'xstate'\n\nimport {\n  type PresentationPerspective,\n  type PreviewUrlOption,\n  type PreviewUrlPreviewMode,\n} from '../types'\nimport {encodeStudioPerspective} from '../util/encodeStudioPerspective'\n\n/** @internal */\nexport interface ResolvePreviewModeUrlInput {\n  previewUrlSecret: string\n  resolvedPreviewMode: PreviewUrlPreviewMode\n  initialUrl: URL\n}\n\n/** @internal */\nexport function defineResolvePreviewModeUrlActor({\n  client,\n  studioBasePath,\n  previewUrlOption,\n  perspective,\n}: {\n  client: SanityClient\n  studioBasePath: string\n  previewUrlOption: PreviewUrlOption | undefined\n  perspective: PresentationPerspective\n}): PromiseActorLogic<URL, ResolvePreviewModeUrlInput> {\n  return fromPromise<URL, ResolvePreviewModeUrlInput>(async ({input}) => {\n    const {previewUrlSecret, resolvedPreviewMode, initialUrl} = input\n\n    /**\n     * If the previewUrlOption is a function, we need to resolve it and maintain backwards compatibility\n     */\n    if (typeof previewUrlOption === 'function') {\n      const initial = await previewUrlOption({\n        client,\n        studioBasePath,\n        previewUrlSecret,\n        studioPreviewPerspective: encodeStudioPerspective(perspective),\n        previewSearchParam: initialUrl.toString(),\n      })\n      return new URL(initial, initialUrl)\n    }\n\n    /**\n     * If the resolved preview mode is false then we have an unexpected state that shouldn't be possible\n     */\n    if (!resolvedPreviewMode) {\n      throw new Error('Resolved preview mode is false')\n    }\n\n    const url = new URL(resolvedPreviewMode.enable, initialUrl)\n\n    url.searchParams.set(urlSearchParamPreviewSecret, previewUrlSecret)\n    url.searchParams.set(urlSearchParamPreviewPerspective, encodeStudioPerspective(perspective))\n    if (initialUrl.pathname !== url.pathname) {\n      url.searchParams.set(\n        urlSearchParamPreviewPathname,\n        `${initialUrl.pathname}${initialUrl.search}${initialUrl.hash}`,\n      )\n    }\n\n    return url\n  })\n}\n", "import {fromPromise} from 'xstate'\n\n/** @internal */\nexport const resolveUrlFromPreviewSearchParamActor = fromPromise<\n  URL,\n  {initialUrl: URL; previewSearchParam: string | null | undefined; allowOrigins: URLPattern[]}\n>(async ({input}) => {\n  const {previewSearchParam, initialUrl, allowOrigins} = input\n\n  /**\n   * If the preview search param is falsy we can skip\n   */\n  if (!previewSearchParam) {\n    return initialUrl\n  }\n\n  /**\n   * Validate the previewSearchParam\n   */\n  try {\n    const previewSearchParamUrl = new URL(previewSearchParam, initialUrl.origin)\n    if (!allowOrigins.some((pattern) => pattern.test(previewSearchParamUrl.origin))) {\n      return initialUrl\n    }\n    return previewSearchParamUrl\n  } catch {\n    return initialUrl\n  }\n})\n", "import {\n  schemaIdSingleton,\n  schemaType,\n  schemaTypeSingleton,\n} from '@sanity/preview-url-secret/constants'\nimport {type SanityDocument} from '@sanity/types'\nimport {uuid} from '@sanity/uuid'\nimport {throwError} from 'rxjs'\nimport {type DocumentValuePermission, type PermissionCheckResult} from 'sanity'\nimport {type ActorRefFrom, assign, fromObservable, fromPromise, log, setup} from 'xstate'\n\nimport {type ResolvePreviewModeUrlInput} from '../actors/resolve-preview-mode-url'\nimport {resolveUrlFromPreviewSearchParamActor} from '../actors/resolve-url-from-preview-search-param'\nimport {type PreviewUrlPreviewMode} from '../types'\n\ninterface Context {\n  initialUrl: URL | null\n  previewUrl: URL | null\n  allowOrigins: URLPattern[] | null\n  error: Error | null\n  previewSearchParam: string | null\n  previewUrlSecret: {secret: string; expiresAt: Date} | null\n  previewAccessSharingCreatePermission: PermissionCheckResult | null\n  previewAccessSharingReadPermission: PermissionCheckResult | null\n  previewAccessSharingUpdatePermission: PermissionCheckResult | null\n  previewUrlSecretPermission: PermissionCheckResult | null\n  previewMode: PreviewUrlPreviewMode | null\n}\n\ntype SetPreviewSearchParamEvent = {\n  type: 'set preview search param'\n  previewSearchParam: string | null\n}\ntype Event = SetPreviewSearchParamEvent\n\ntype Input = Omit<SetPreviewSearchParamEvent, 'type'>\n\nexport interface CheckPermissionInput {\n  checkPermissionName: DocumentValuePermission\n  document: Partial<SanityDocument> | null\n}\n\n/**\n * Used for permissions checks\n */\nexport const shareAccessSingletonDocument = {_id: schemaIdSingleton, _type: schemaTypeSingleton}\nexport const previewUrlSecretDocument = {\n  _id: `drafts.${uuid()}`,\n  _type: schemaType,\n}\n\nexport const previewUrlMachine = setup({\n  types: {} as {\n    context: Context\n    events: Event\n    input: Input\n    tags: 'busy' | 'error'\n  },\n  actions: {\n    'notify preview will likely fail': log(\n      `Missing permissions to create preview secret, or read shared preview secret. Preview will likely fail loading.`,\n    ),\n    'assign preview search param': assign({\n      previewSearchParam: (_, params: {previewSearchParam: string | null}) =>\n        params.previewSearchParam,\n    }),\n    'assign error': assign({\n      error: (_, params: {message: string; error: unknown}) => {\n        return params.error instanceof Error\n          ? params.error\n          : new Error(params.message, {cause: params.error})\n      },\n    }),\n  },\n  actors: {\n    'check permission': fromObservable<PermissionCheckResult, CheckPermissionInput>(() =>\n      throwError(\n        () =>\n          new Error(\n            `The 'check permission' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'check permission': fromObservable(({input}: {input: CheckPermissionInput}) => ...)}})`,\n          ),\n      ),\n    ),\n    'resolve initial url': fromPromise<URL, {previewSearchParam: string | null}>(() =>\n      Promise.reject(\n        new Error(\n          `The 'resolve initial url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve initial url': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'resolve allow patterns': fromPromise<URLPattern[], {initialUrl: URL}>(() =>\n      Promise.reject(\n        new Error(\n          `The 'resolve allow patterns' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve allow pattern': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'resolve url from preview search param': resolveUrlFromPreviewSearchParamActor,\n    'resolve preview mode': fromPromise<PreviewUrlPreviewMode | false, {targetOrigin: string}>(() =>\n      Promise.reject(\n        new Error(\n          `The 'resolve preview mode' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'create preview secret': fromPromise<{\n      secret: string\n      expiresAt: Date\n    }>(async () =>\n      Promise.reject(\n        new Error(\n          `The 'create preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'create preview secret': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'read shared preview secret': fromPromise<string | null>(async () =>\n      Promise.reject(\n        new Error(\n          `The 'read shared preview secret' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'read shared preview secret': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n    'resolve preview mode url': fromPromise<URL, ResolvePreviewModeUrlInput>(() =>\n      Promise.reject(\n        new Error(\n          `The 'resolve preview mode url' actor is not implemented. Add it to previewUrlMachine.provide({actors: {'resolve preview mode url': fromPromise(...)}})`,\n        ),\n      ),\n    ),\n  },\n  guards: {\n    'has checked permissions': ({context}) => {\n      return Boolean(\n        context.previewAccessSharingCreatePermission &&\n        context.previewAccessSharingReadPermission &&\n        context.previewAccessSharingUpdatePermission &&\n        context.previewUrlSecretPermission,\n      )\n    },\n    'search param has new origin': ({context, event}) => {\n      if (!context.previewUrl || !event.previewSearchParam) {\n        return false\n      }\n      try {\n        const previewSearchParamUrl = new URL(event.previewSearchParam, context.previewUrl)\n        return context.previewUrl.origin !== previewSearchParamUrl.origin\n      } catch {\n        return false\n      }\n    },\n    'can create preview secret': ({context}) => {\n      return context.previewUrlSecretPermission?.granted === true\n    },\n\n    'has preview mode with created secret': ({context}, params: PreviewUrlPreviewMode | false) => {\n      if (params === false) {\n        return false\n      }\n      return context.previewUrlSecretPermission?.granted === true\n    },\n    'has preview mode with share access': ({context}, params: PreviewUrlPreviewMode | false) => {\n      if (params === false) {\n        return false\n      }\n      return context.previewAccessSharingReadPermission?.granted === true\n    },\n    'has preview mode without permissions': ({context}, params: PreviewUrlPreviewMode | false) => {\n      if (params === false) {\n        return false\n      }\n      return (\n        context.previewAccessSharingReadPermission?.granted === false &&\n        context.previewUrlSecretPermission?.granted === false\n      )\n    },\n  },\n  delays: {\n    expiredSecret: ({context}) => {\n      if (!context.previewUrlSecret?.expiresAt) {\n        return 0\n      }\n      const now = Date.now()\n      const expiresAt = context.previewUrlSecret.expiresAt.getTime()\n      return Math.max(expiresAt - now, 0)\n    },\n  },\n}).createMachine({\n  // eslint-disable-next-line tsdoc/syntax\n  /** @xstate-layout N4IgpgJg5mDOIC5QAUBOYBuBLMB3ABAKoBKAMgMRiqoD2qAdAA4A2AhgC4BmdAtvWphwESpBFgB2GGgGMOWGuIDaABgC6K1YlCMasLO3nitIAB6IArAA56AZgCcAdkcBGS8vMAmO+YBszgDQgAJ6Izs4+9M7KACzKztGWHg4OPubmAL7pgQLYeERklNR0TGxcvPzoucJkYpIycgqKzupqxjp6BgrGZggAtM520ZHRdjZjNjFe7oEhCGERUbHxicmpGVkgOUL5FFS0DCwc3Kh8W3kitVKynUoeLZpIIO36ht2IvV62Hl7elmE2lh83xmoXCkRicQSSRS5gSmWylW2IkK+xKR3KZ2qogkVwaShs9zauheXUePV6gPo3jSUyi-xBczBi0hKxh5mc8M2iPOBVgYHY+EY3IIfNYqGkAAtBWLWDwNESOq8yaCbM56A4bB5fGllHYvD4fAz4h56CNfG5LKqHMpLdFOZidvRJWBpABrCRQZBUHhYWB6BSwcjyx7PG5vPrs5TqjWqyyjTXRDwMjwxei68J2ZQ2nyWXN2jYOkT0dCwGjMbDiKAASXEL1YzEIqGY5AgCjA9BxNFd7cLZGLcDLFertYM9cbzEu9RuGmD2mJYeVfRGdipyh86Yc0XiE3MDK3JssIwcrmtPjGSXzCMEPNI-dL5Y9NbrDabKOKhzKJwq16xd8Hj5HLAxybSdrkMGdWhDeclVAclN3odlzBsKwBjSSxjwcZM7DVeJ1w8P4xmidk7HtYVHRLf9KwAQWYZgaFwZAOHYKhxEDVtxHbTtu2-KpyIHB9qNo+jGPYZjUFY0C8Qgh450VUlYPedkHHoHwnDSZDVOiGwfGiBlUhXXwwjsQYtKSYzSJ-Pj7yHGi6IYpiWMDPZ31KY5TjIosKIEqBbOEhzxNgSTpzUWcnmg+TTHePV6Hw3MYgzaItJ0hlYRNTNkLiHxBl1GILN4zz+KHccADFaB4TEAGUwDFSVGNQWUWzbDs6m43tby8oqm1KmhyuFKqaolOrZSC8CQsg2SSSMRdel8ZSNUTdlcw8M07AZQZrDXdaDRtUZnHWK98r7DqPRKsrKuq8VBplHg3wOVyMQ8o7CpOrqzr6i7auukbGjGmSwrkqaFL6MJlLiWFlC1EGty0hknAiXVVPMRx12UJwOQLR72ueytMQAWRoCAwEajjmqkVrMb-by8YJsBvqUX6FUm8Nem2+hbWPUZErGTcjS8NUJg8AE9T1ZwHHwvKkSe6yPWpwnic4lqewp46ceFfHCbpmdmkZhcgZmyxzFsDmTPcXUUiNRKDy3ZQJlVLSkYlm9KaHWWifYhWyaVyyCul1Wf3V2nOzAn71DuHWYMivovGsBxPCy74beWaJDWCUJzBSFTrUcQYdMzIFHd-FXPTVmn5dJrsvcOrHfeL-2ac1kKCXDiLyWcNKJiiHM-BtONwgtnMEM1DVNwhhI7B8AurMo2uqgD260U-dzval6fXYbwkoIB5moijLLkm5tvYRBo1nGQtND11ZaIdzEiMeX6vV5LuW+QFIVLNFS7pXquVxv+pnF1FtYP4OY7AG3QohJMqcEDeGUq4NwYQBhLEnkWWAABXaQ0g4CBhfoKMiH9JRf1lKFUMEceiizVPA0+7gtQQy8LzXU6obaJTFtEJwHhXDIL7G-WepccHcO2PgqUjBrrEPCoDSOFI3C2AGHtQ8sIiJJGTILZS7JRaeGSKw7CnDbz8LwAHJ06AOBgHOtIdA7Ay5cUrpLHRT92ymOqsxExZj16iK3gAqI6oaQ6QtE4YylhkynzmkCBGNgNR7VvgdaxTBbEGIccY969jzHOTuuiL8bVol10JrEoxTj+QuN-iQlu7xwjKX1P8bSTC0hGhcKaBIOZAQGkBKE7RGSeFZMMRACqEoxRgCohgrBFjFY8Sibo3A+iOldJ6X0zBfp8l-UKeIshjgqTGTiPYPaGotS7igd8QWtgsp6iQnFOEd8q6tKEOM6qnTunoGmQM5JC83LDKdqMy5rBrlTP6bMoOUkGab3-kDU+ERVEpnsEjDRVSdljBXKeQY3h5gOBaa8mmzt4k-nHIMz2zzfzIvaYVNFVRxxzObosxAfg1Q2jSOERIh5kIBNGKaNZ2lvjhFhEimJHUCVCAxQ8j8Tz0m4vbJyzERKfnBQ3hNXWkdyWeJsCMVhqNsK6mTO4Q2Q9DysLCEhDw7LMntjQV8wMJhYDsCMfQVgnAxIAAowAmEYFgdAnSXRmIAJTkAFTEg1MzYCuIBZHKYKlUiqWwrCMJkDZgDAYceRMfwUisPYZYTIGxxA03gI8NqJLmZ6msKqENcjErqIZL0cethvDGXLew9hiYWnOjdDLb0vp-SsUzdNcwEMEJ7WTohDMfgU4RpTCpUJnhYrHghuEFpRcnyjhfMwFtet2Q2FNOwsWZarBan8TsuMkRvhIzPJGDwmkWnJLnf6g0aZl0mQTURDdsxYiGwwsRIEgwEwTuxj5IS9lRKORPeSJCOF4XgrUZqbZsxwZszcJtbC4RUg2FfTXU6PVzoDSGjwH9ik-gxRGG4NtxkkZblhgyxIhFQG5lSPEODj89VoYjKqGKURkij0zImXSUCwiozZuDLUCQQY6tOVEr1WDqMsxNCkP4RFPBZj+I4I0qoRMODjIlceBzkK6raWAIT7DDZlNPhUuVkKI0pEXbHBISF1yAiIqpi5KL7E5ISWYoTna2b6Qg+DcFN7EAphLdpdOWVoPJ0RXxl5HKrmTNuYahzaQviaQPVERa8mlGeBUnnQyDStSwcCzi4L1kuV4HHNR4DCFdRaVVFSzcZ4VVIVsDEVhZ5QnWlYZZvRKLj3-KlT0FIKjVRZghkCXwqkjQGzVFxvOMisoWYy46QV9ABN+mo3mFZZ427lp032jzVa2bJGtCUtciak1AA */\n  id: 'Preview URL',\n  context: ({input}) => ({\n    initialUrl: null,\n    previewUrl: null,\n    error: null,\n    allowOrigins: null,\n    previewSearchParam: input.previewSearchParam,\n    previewUrlSecret: null,\n    previewAccessSharingCreatePermission: null,\n    previewAccessSharingReadPermission: null,\n    previewAccessSharingUpdatePermission: null,\n    previewUrlSecretPermission: null,\n    previewMode: null,\n  }),\n\n  invoke: [\n    {\n      src: 'check permission',\n      input: () => ({checkPermissionName: 'read', document: shareAccessSingletonDocument}),\n      onError: {\n        target: '.error',\n        actions: {\n          type: 'assign error',\n          params: ({event}) => ({\n            message: 'Failed to check permission',\n            error: event.error,\n          }),\n        },\n      },\n      onSnapshot: {\n        actions: assign({\n          previewAccessSharingReadPermission: ({event}) => event.snapshot.context ?? null,\n        }),\n      },\n    },\n    {\n      src: 'check permission',\n      input: () => ({checkPermissionName: 'create', document: shareAccessSingletonDocument}),\n      onError: {\n        target: '.error',\n        actions: {\n          type: 'assign error',\n          params: ({event}) => ({\n            message: 'Failed to check permission',\n            error: event.error,\n          }),\n        },\n      },\n      onSnapshot: {\n        actions: assign({\n          previewAccessSharingCreatePermission: ({event}) => event.snapshot.context ?? null,\n        }),\n      },\n    },\n    {\n      src: 'check permission',\n      input: () => ({checkPermissionName: 'update', document: shareAccessSingletonDocument}),\n      onError: {\n        target: '.error',\n        actions: {\n          type: 'assign error',\n          params: ({event}) => ({\n            message: 'Failed to check permission',\n            error: event.error,\n          }),\n        },\n      },\n      onSnapshot: {\n        actions: assign({\n          previewAccessSharingUpdatePermission: ({event}) => event.snapshot.context ?? null,\n        }),\n      },\n    },\n    {\n      src: 'check permission',\n      input: () => ({checkPermissionName: 'create', document: previewUrlSecretDocument}),\n      onError: {\n        target: '.error',\n        actions: {\n          type: 'assign error',\n          params: ({event}) => ({\n            message: 'Failed to check permission',\n            error: event.error,\n          }),\n        },\n      },\n      onSnapshot: {\n        actions: assign({\n          previewUrlSecretPermission: ({event}) => event.snapshot.context ?? null,\n        }),\n      },\n    },\n  ],\n\n  on: {\n    'set preview search param': {\n      actions: {\n        type: 'assign preview search param',\n        params: ({event}) => ({previewSearchParam: event.previewSearchParam}),\n      },\n    },\n  },\n\n  states: {\n    checkingPermissions: {\n      always: {\n        guard: 'has checked permissions',\n        target: 'resolvingInitialUrl',\n      },\n      tags: 'busy',\n    },\n\n    resolvingInitialUrl: {\n      invoke: {\n        src: 'resolve initial url',\n        input: ({context}) => ({previewSearchParam: context.previewSearchParam}),\n        onError: {\n          target: 'error',\n          actions: {\n            type: 'assign error',\n            params: ({event}) => ({\n              message: 'Failed to resolve initial url',\n              error: event.error,\n            }),\n          },\n        },\n        onDone: {\n          target: 'resolvingAllowPatterns',\n          actions: assign({initialUrl: ({event}) => event.output}),\n        },\n      },\n\n      tags: 'busy',\n    },\n\n    error: {\n      type: 'final',\n      tags: 'error',\n    },\n\n    resolvingAllowPatterns: {\n      invoke: {\n        src: 'resolve allow patterns',\n        input: ({context}) => ({initialUrl: context.initialUrl!}),\n        onError: {\n          target: 'error',\n          actions: {\n            type: 'assign error',\n            params: ({event}) => ({\n              message: 'Failed to resolve preview url allow patterns',\n              error: event.error,\n            }),\n          },\n        },\n        onDone: {\n          target: 'resolvingUrlFromPreviewSearchParam',\n          actions: assign({allowOrigins: ({event}) => event.output}),\n        },\n      },\n      tags: ['busy'],\n    },\n\n    resolvingUrlFromPreviewSearchParam: {\n      id: 'loop',\n      invoke: {\n        src: 'resolve url from preview search param',\n        input: ({context}) => ({\n          initialUrl: context.initialUrl!,\n          allowOrigins: context.allowOrigins!,\n          previewSearchParam: context.previewSearchParam,\n        }),\n        onError: {\n          target: 'error',\n          actions: {\n            type: 'assign error',\n            params: ({event}) => ({\n              message: 'Failed to resolve preview url from search param',\n              error: event.error,\n            }),\n          },\n        },\n        onDone: {\n          target: 'resolvingPreviewMode',\n          actions: assign({initialUrl: ({event}) => event.output}),\n        },\n      },\n      tags: ['busy'],\n    },\n\n    resolvingPreviewMode: {\n      on: {\n        'set preview search param': {\n          guard: 'search param has new origin',\n          actions: {\n            type: 'assign preview search param',\n            params: ({event}) => ({previewSearchParam: event.previewSearchParam}),\n          },\n          target: '#loop',\n          reenter: true,\n        },\n      },\n      invoke: {\n        src: 'resolve preview mode',\n        input: ({context}) => ({targetOrigin: context.initialUrl!.origin}),\n        onError: {\n          target: 'error',\n          actions: {\n            type: 'assign error',\n            params: ({event}) => ({\n              message: 'Failed to resolve preview url allow patterns',\n              error: event.error,\n            }),\n          },\n        },\n        onDone: [\n          {\n            guard: {\n              type: 'has preview mode with created secret',\n              params: ({event}) => event.output,\n            },\n            actions: assign({\n              previewMode: ({event}) => event.output as unknown as PreviewUrlPreviewMode,\n            }),\n            target: 'previewMode.createPreviewSecret',\n          },\n          {\n            guard: {\n              type: 'has preview mode with share access',\n              params: ({event}) => event.output,\n            },\n            actions: assign({\n              previewMode: ({event}) => event.output as unknown as PreviewUrlPreviewMode,\n            }),\n            target: 'previewMode.readShareAccess',\n          },\n          {\n            guard: {\n              type: 'has preview mode without permissions',\n              params: ({event}) => event.output,\n            },\n            actions: [\n              assign({\n                previewUrl: ({context}) => context.initialUrl,\n              }),\n              'notify preview will likely fail',\n            ],\n            target: 'success',\n          },\n          {\n            actions: assign({\n              previewUrl: ({context}) => context.initialUrl,\n            }),\n            target: 'success',\n          },\n        ],\n      },\n      tags: ['busy'],\n    },\n\n    success: {\n      on: {\n        'set preview search param': {\n          guard: 'search param has new origin',\n          actions: {\n            type: 'assign preview search param',\n            params: ({event}) => ({previewSearchParam: event.previewSearchParam}),\n          },\n          target: '#loop',\n          reenter: true,\n        },\n      },\n    },\n\n    previewMode: {\n      on: {\n        'set preview search param': {\n          guard: 'search param has new origin',\n          actions: {\n            type: 'assign preview search param',\n            params: ({event}) => ({previewSearchParam: event.previewSearchParam}),\n          },\n          target: '#loop',\n          reenter: true,\n        },\n      },\n\n      states: {\n        createPreviewSecret: {\n          invoke: {\n            src: 'create preview secret',\n            onError: {\n              target: 'error',\n              actions: {\n                type: 'assign error',\n                params: ({event}) => ({\n                  message: 'Failed to create preview secret',\n                  error: event.error,\n                }),\n              },\n            },\n            onDone: {\n              target: 'resolvePreviewUrl',\n              actions: assign({previewUrlSecret: ({event}) => event.output}),\n            },\n          },\n          tags: ['busy'],\n        },\n        readShareAccess: {\n          invoke: {\n            src: 'read shared preview secret',\n            onError: {\n              target: 'error',\n              actions: {\n                type: 'assign error',\n                params: ({event}) => ({\n                  message: 'Failed to read shared preview secret',\n                  error: event.error,\n                }),\n              },\n            },\n            onDone: {\n              target: 'resolvePreviewUrl',\n              actions: assign({\n                previewUrlSecret: ({event}) => ({\n                  secret: event.output!,\n                  expiresAt: new Date(Date.now() + 1000 * 60 * 60 * 60 * 24),\n                }),\n              }),\n            },\n          },\n          tags: ['busy'],\n        },\n        resolvePreviewUrl: {\n          invoke: {\n            src: 'resolve preview mode url',\n            input: ({context}) => ({\n              initialUrl: context.initialUrl!,\n              resolvedPreviewMode: context.previewMode!,\n              previewUrlSecret: context.previewUrlSecret!.secret,\n            }),\n            onError: {\n              target: 'error',\n              actions: {\n                type: 'assign error',\n                params: ({event}) => ({\n                  message: 'Failed to resolve preview url',\n                  error: event.error,\n                }),\n              },\n            },\n            onDone: {\n              target: 'success',\n              actions: assign({previewUrl: ({event}) => event.output}),\n            },\n          },\n          tags: ['busy'],\n        },\n        error: {\n          type: 'final',\n          tags: ['error'],\n        },\n        success: {\n          after: {\n            expiredSecret: {\n              guard: 'can create preview secret',\n              actions: assign({previewUrlSecret: null}),\n              target: 'createPreviewSecret',\n              reenter: true,\n            },\n          },\n        },\n      },\n      initial: 'readShareAccess',\n    },\n  },\n\n  initial: 'checkingPermissions',\n})\nexport type PreviewUrlRef = ActorRefFrom<typeof previewUrlMachine>\n", "import {useToast} from '@sanity/ui'\nimport {useActorRef, useSelector} from '@xstate/react'\nimport {useEffect} from 'react'\nimport {useActiveWorkspace, useClient, useCurrentUser, useGrantsStore, useTranslation} from 'sanity'\nimport {useRouter} from 'sanity/router'\nimport {fromObservable} from 'xstate'\n\nimport {defineCreatePreviewSecretActor} from './actors/create-preview-secret'\nimport {defineReadSharedSecretActor} from './actors/read-shared-secret'\nimport {defineResolveAllowPatternsActor} from './actors/resolve-allow-patterns'\nimport {defineResolveInitialUrlActor} from './actors/resolve-initial-url'\nimport {defineResolvePreviewModeActor} from './actors/resolve-preview-mode'\nimport {defineResolvePreviewModeUrlActor} from './actors/resolve-preview-mode-url'\nimport {API_VERSION} from './constants'\nimport {presentationLocaleNamespace} from './i18n'\nimport {previewUrlMachine, type PreviewUrlRef} from './machines/preview-url'\nimport {type PreviewUrlAllowOption, type PreviewUrlOption} from './types'\nimport {usePresentationPerspective} from './usePresentationPerspective'\n\nexport function usePreviewUrlActorRef(\n  previewUrlOption: PreviewUrlOption | undefined,\n  allowOption: PreviewUrlAllowOption | undefined,\n): PreviewUrlRef {\n  const grantsStore = useGrantsStore()\n  const client = useClient({apiVersion: API_VERSION})\n  const currentUser = useCurrentUser()\n  const currentUserId = currentUser?.id\n  const workspace = useActiveWorkspace()\n  const studioBasePath = workspace?.activeWorkspace?.basePath || '/'\n  const router = useRouter()\n  const routerSearchParams = new URLSearchParams(router.state._searchParams)\n  const previewSearchParam = routerSearchParams.get('preview')\n  const {push: pushToast} = useToast()\n  const {t} = useTranslation(presentationLocaleNamespace)\n\n  // TODO: Do we need to pass the scheduled draft perspective here?\n  // Scheduled draft are a \"local\" perspective which applies only when the user is in the document pane and has selected the scheduled draft.\n  const perspective = usePresentationPerspective({scheduledDraft: undefined})\n\n  const actorRef = useActorRef(\n    previewUrlMachine.provide({\n      actions: {\n        'notify preview will likely fail': () =>\n          pushToast({\n            id: 'preview-url-secret.missing-grants',\n            closable: true,\n            status: 'error',\n            duration: Infinity,\n            title: t('preview-url-secret.missing-grants'),\n          }),\n      },\n      actors: {\n        'create preview secret': defineCreatePreviewSecretActor({client, currentUserId}),\n        'read shared preview secret': defineReadSharedSecretActor({client}),\n        'resolve allow patterns': defineResolveAllowPatternsActor({\n          client,\n          allowOption,\n        }),\n        'resolve initial url': defineResolveInitialUrlActor({\n          client,\n          studioBasePath,\n          previewUrlOption,\n          perspective,\n        }),\n        'resolve preview mode': defineResolvePreviewModeActor({\n          client,\n          previewUrlOption,\n        }),\n        'resolve preview mode url': defineResolvePreviewModeUrlActor({\n          client,\n          studioBasePath,\n          previewUrlOption,\n          perspective,\n        }),\n        'check permission': fromObservable(({input}) =>\n          grantsStore.checkDocumentPermission(input.checkPermissionName, input.document),\n        ),\n      },\n    }),\n    {input: {previewSearchParam}},\n  )\n\n  /**\n   * Sync changes to router state for the preview search param\n   */\n  useEffect(() => {\n    actorRef.send({type: 'set preview search param', previewSearchParam})\n  }, [actorRef, previewSearchParam])\n\n  const error = useSelector(actorRef, (state) =>\n    state.status === 'error' ? state.error : state.hasTag('error') ? state.context.error : null,\n  )\n\n  // Propagate the error to the nearest error boundary\n  if (error) throw error\n\n  return actorRef\n}\n", "import {useToast} from '@sanity/ui'\nimport {useSelector} from '@xstate/react'\nimport {useEffect} from 'react'\nimport {Translate, useTranslation} from 'sanity'\nimport {useRouter} from 'sanity/router'\n\nimport {presentationLocaleNamespace} from './i18n'\nimport {type PreviewUrlRef} from './machines/preview-url'\n\nexport function useReportInvalidPreviewSearchParam(previewUrlRef: PreviewUrlRef): void {\n  const {t} = useTranslation(presentationLocaleNamespace)\n  const {push: pushToast} = useToast()\n  const router = useRouter()\n  const routerSearchParams = new URLSearchParams(router.state._searchParams)\n  const previewSearchParam = routerSearchParams.get('preview')\n\n  const allowOrigins = useSelector(previewUrlRef, (state) => state.context.allowOrigins)\n  const currentOrigin = useSelector(previewUrlRef, (state) => state.context.previewUrl?.origin)\n  useEffect(() => {\n    if (!Array.isArray(allowOrigins) || !previewSearchParam || !currentOrigin) return\n    const nextOrigin = new URL(previewSearchParam, currentOrigin).origin\n    if (!allowOrigins.some((pattern) => pattern.test(nextOrigin))) {\n      pushToast({\n        closable: true,\n        id: `presentation-iframe-origin-mismatch-${nextOrigin}`,\n        status: 'error',\n        duration: Infinity,\n        title: t('preview-search-param.configuration.error.title'),\n        description: (\n          <Translate\n            t={t}\n            i18nKey=\"preview-search-param.configuration.error.description\"\n            components={{Code: 'code'}}\n            values={{\n              previewSearchParam,\n              blockedOrigin: nextOrigin,\n            }}\n          />\n        ),\n      })\n    }\n  }, [allowOrigins, currentOrigin, previewSearchParam, pushToast, t])\n}\n", "import {subscribeToVercelProtectionBypass} from '@sanity/preview-url-secret/toggle-vercel-protection-bypass'\nimport {useEffect, useReducer, useState} from 'react'\nimport {useClient} from 'sanity'\n\nimport {API_VERSION} from './constants'\n\ntype VercelProtectionBypassReadyState = 'loading' | 'ready'\n\nexport function useVercelBypassSecret(): [\n  vercelProtectionBypassSecret: string | null,\n  vercelProtectionBypassReadyState: VercelProtectionBypassReadyState,\n] {\n  const client = useClient({apiVersion: API_VERSION})\n  const [vercelProtectionBypassReadyState, ready] = useReducer(\n    () => 'ready' as 'ready' | 'loading',\n    'loading',\n  )\n  const [vercelProtectionBypassSecret, setVercelProtectionBypassSecret] = useState<string | null>(\n    null,\n  )\n\n  useEffect(() => {\n    const unsubscribe = subscribeToVercelProtectionBypass(client, (secret) => {\n      setVercelProtectionBypassSecret(secret)\n      ready()\n    })\n    return () => unsubscribe()\n  }, [client])\n\n  return [vercelProtectionBypassSecret, vercelProtectionBypassReadyState]\n}\n", "import {useSelector} from '@xstate/react'\nimport {type Tool} from 'sanity'\n\nimport {PresentationSpinner} from './PresentationSpinner'\nimport PresentationTool from './PresentationTool'\nimport {type PresentationPluginOptions} from './types'\nimport {usePreviewUrlActorRef} from './usePreviewUrlActorRef'\nimport {useReportInvalidPreviewSearchParam} from './useReportInvalidPreviewSearchParam'\nimport {useVercelBypassSecret} from './useVercelBypassSecret'\n\nexport default function PresentationToolGrantsCheck({\n  tool,\n}: {\n  tool: Tool<PresentationPluginOptions>\n}): React.JSX.Element {\n  const previewUrlRef = usePreviewUrlActorRef(tool.options?.previewUrl, tool.options?.allowOrigins)\n  useReportInvalidPreviewSearchParam(previewUrlRef)\n\n  const previewAccessSharingCreatePermission = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewAccessSharingCreatePermission,\n  )\n  const previewAccessSharingUpdatePermission = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewAccessSharingUpdatePermission,\n  )\n  const previewAccessSharingReadPermission = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewAccessSharingReadPermission,\n  )\n  const previewUrlSecretPermission = useSelector(\n    previewUrlRef,\n    (state) => state.context.previewUrlSecretPermission,\n  )\n  const url = useSelector(previewUrlRef, (state) => state.context.previewUrl)\n  // @TODO the vercel protection bypass can be moved to the iframe level\n  const [vercelProtectionBypass, vercelProtectionBypassReadyState] = useVercelBypassSecret()\n\n  if (\n    !url ||\n    vercelProtectionBypassReadyState === 'loading' ||\n    !previewAccessSharingCreatePermission ||\n    typeof previewAccessSharingCreatePermission.granted === 'undefined' ||\n    !previewAccessSharingUpdatePermission ||\n    typeof previewAccessSharingUpdatePermission.granted === 'undefined' ||\n    !previewUrlSecretPermission ||\n    !previewAccessSharingReadPermission ||\n    typeof previewAccessSharingReadPermission.granted === 'undefined' ||\n    typeof previewUrlSecretPermission.granted === 'undefined'\n  ) {\n    return <PresentationSpinner />\n  }\n\n  return (\n    <PresentationTool\n      tool={tool}\n      initialPreviewUrl={url}\n      vercelProtectionBypass={vercelProtectionBypass}\n      canToggleSharePreviewAccess={\n        Boolean(previewAccessSharingCreatePermission?.granted) &&\n        Boolean(previewAccessSharingUpdatePermission?.granted)\n      }\n      canUseSharedPreviewAccess={Boolean(previewAccessSharingReadPermission?.granted)}\n      previewUrlRef={previewUrlRef}\n    />\n  )\n}\n"],
  "mappings": "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",
  "names": ["c", "URL", "URL", "v4_default", "c", "URL", "_id", "_type", "parse", "value", "_a", "result", "char", "prefix", "i", "parse", "tag", "PostMessageFeatures", "props", "$", "_c", "comlink", "t0", "t1", "on", "_temp", "useEffect", "memo", "features", "optimistic", "presentationMachine", "setup", "types", "actions", "actors", "guards", "createMachine", "id", "context", "url", "error", "visualEditingOverlaysEnabled", "assign", "target", "states", "description", "tags", "loading", "loaded", "event", "enabled", "idle", "refreshing", "reloading", "initial", "SharedStateProvider", "children", "Symbol", "for", "sharedState", "useRef", "t2", "state", "current", "t3", "key", "value", "post", "setValue", "t4", "key_0", "removeValue", "t5", "t6", "Root", "styled", "div", "Panel", "defaultSize", "minWidth", "maxWidth", "order", "undefined", "useContext", "PresentationPanelsContext", "Error", "getPanelStyle", "registerElement", "unregisterElement", "style", "type", "useLayoutEffect", "debounce", "fn", "timeout", "timer", "args", "clearTimeout", "setTimeout", "apply", "itemKey", "getStoredItem", "JSON", "parse", "localStorage", "getItem", "setStoredItem", "data", "setItem", "stringify", "getKeyForPanels", "panels", "map", "panel", "join", "usePanelsStorage", "get", "_temp2", "set", "_temp3", "setDebounced", "panels_0", "widths", "stored_0", "stored", "Array", "isArray", "some", "val", "getNextWidth", "nextWidth", "containerWidth", "maxWidthPx", "minWidthPx", "Math", "min", "max", "getNextWidths", "delta", "panelBefore", "panelAfter", "panelsState", "initialDragState", "prevWidths", "initialWidths", "nextWidths", "pivotPanel", "index", "findIndex", "width", "abs", "deltaApplied", "deltaRemaining", "toPrecision", "localeCompare", "numeric", "length", "getPanelWidth", "getOffset", "handleElement", "initialOffset", "initialHandleElementRect", "pointerOffset", "clientX", "elementOffset", "getBoundingClientRect", "left", "isPanel", "element", "isResizer", "getSortedElements", "elements", "from", "values", "sort", "a", "b", "validateWidths", "widthsToValidate", "total", "reduce", "remainingWidth", "toFixed", "getDefaultWidths", "panelsWithoutWidth", "remainingWidthTotal", "widthsWithNulls", "defaultWidth", "PanelsWrapper", "Panels", "panelsEl", "Map", "setElements", "useState", "filter", "setWidths", "activeResizer", "setActiveResizer", "panelsRef", "flexGrow", "pointerEvents", "id_0", "prev", "has", "next", "t7", "id_1", "prev_0", "next_0", "delete", "t8", "window", "innerWidth", "dragOffset", "resizerIndex", "resizerRect", "startX", "dragRef", "t9", "id_2", "elementsArr", "el", "resizer", "resizeElement", "acc", "el_0", "i", "acc_0", "el_1", "i_0", "pageX", "startDragging", "t10", "stopDragging", "t11", "id_3", "event_0", "preventDefault", "stopPropagation", "resizer_0", "resizeElement_0", "offset", "rect", "prevWidth", "i_1", "drag", "t12", "t13", "storage", "t14", "t15", "widths_0", "storedWidths", "validatedStoredWidths", "defaultWidths", "t16", "t17", "t18", "t19", "resizeObserver", "ResizeObserver", "prevWidths_0", "nextWidths_0", "prevWidth_0", "i_2", "observe", "disconnect", "t20", "t21", "t22", "ErrorCard", "message", "onContinueAnyway", "onRetry", "restProps", "t", "useTranslation", "presentationLocaleNamespace", "retryButton", "continueAnywayButton", "Container", "ChildLink", "forwardRef", "ref", "childId", "childParameters", "childType", "rest", "searchParams", "childPayload", "Object", "entries", "_searchParams", "ReferenceChildLink", "documentId", "documentType", "parentRefPath", "template", "getPublishedId", "params", "pathToString", "encodeQueryString", "parts", "resolveQueryStringFromParams", "nextParams", "allowed", "safeNextParams", "includes", "obj", "BackLink", "PresentationPaneRouterProvider", "onEditReference", "onStructureParams", "structureParams", "refs", "routerState", "resolvePathFromState", "useRouter", "fromEntries", "routerSearchParams", "useUnique", "path", "qs", "createPathWithParams", "childLinkProps", "doc", "find", "r", "_id", "_type", "console", "warn", "backLinkProps", "ref_0", "childLinkProps_0", "ref_1", "options", "version", "groupIndex", "siblingIndex", "payload", "hasGroupSiblings", "groupLength", "routerPanesState", "ParameterizedLink", "closeCurrentAndAfter", "handleEditReference", "replaceCurrent", "closeCurrent", "_temp4", "duplicateCurrent", "_temp5", "setView", "_temp6", "setParams", "setPayload", "_temp7", "navigateIntent", "_temp8", "intentName", "intentParams", "options_0", "viewId", "pane_0", "pane", "RootLayout", "PaneLayout", "Flex", "WrappedCode", "Code", "DocumentListPane", "mainDocumentState", "devMode", "usePresentationTool", "document", "ids", "schemaTypeName", "title", "errorParams", "setErrorParams", "handleRetry", "StructureDocumentListPane", "r_0", "DocumentPane", "onFocusPath", "templateParams", "decodeJsonParams", "templateParameters", "paneDocumentNode", "studioPath", "toString", "handleFocusPath", "height", "StructureDocumentPane", "DocumentPanel", "StructureToolProvider", "usePreviewState", "schemaType", "documentPreviewStore", "useDocumentPreviewStore", "preview", "setPreview", "perspectiveStack", "usePerspective", "subscription", "getPreviewStateObservable", "subscribe", "unsubscribe", "ContentEditor", "schema", "useSchema", "props_0", "MainDocumentLink", "previewState", "bb0", "snapshot", "getPreviewValueWithFallback", "fallback", "usePanelId", "uuid", "panelId", "Resizer", "ResizerInner", "$disabled", "PanelResizer", "propId", "disabled", "isDragging", "nativeEvent", "onMouseDown", "e", "onDrag", "blur", "onDragStop", "resetDocumentStyles", "bodyStyle", "body", "documentStyle", "documentElement", "cursor", "userSelect", "removeProperty", "addEventListener", "removeEventListener", "PresentationContentWrapper", "setDisplayedDocument", "getCommentIntent", "PresentationContent", "documentsOnPage", "PresentationNavigateProvider", "navigate", "_navigate", "useLocalState", "defaultValue", "usePresentationNavigator", "unstable_navigator", "navigatorProvided", "component", "_navigatorEnabled", "setNavigatorEnabled", "navigatorEnabled", "toggleNavigator", "Component", "NavigatorComponent", "navigatorDisabled", "Navigator", "PresentationParamsProvider", "PresentationProvider", "name", "useAllowPatterns", "previewUrlRef", "allowPatterns", "useSelector", "TypeError", "allowOrigins", "encodeStudioPerspective", "studioPerspective", "useId", "useReactId", "startsWith", "replace", "IFrame", "forwardedRef", "animate", "onLoad", "preventClick", "src", "variants", "useImperativeHandle", "instance", "handleBlur", "activeElement", "dispatchEvent", "MouseEvent", "bubbles", "cancelable", "viewTransitionName", "IFrameElement", "motion", "create", "iframe", "IFrameOverlay", "Box", "GlobalViewTransition", "createGlobalStyle", "OpenPreviewButton", "openPopup", "previewLocationOrigin", "previewLocationRoute", "perspective", "targetOrigin", "URL", "urlSearchParamPreviewPerspective", "pathname", "search", "openPreviewLink", "currentTarget", "href", "handleOpenPopup", "LaunchIcon", "useTargetOrigin", "previewUrl", "origin", "PreviewLocationInput", "fontSize", "onChange", "padding", "prefix", "suffix", "basePath", "useActiveWorkspace", "activeWorkspace", "inputRef", "sessionValue", "setSessionValue", "customValidity", "setCustomValidity", "handleChange", "absoluteValue", "pattern", "test", "reportValidity", "nextValue", "handleKeyDown", "nextValue_0", "handleClear", "icon", "ResetIcon", "zIndex", "QRCodeSVG", "lazy", "QrCodeLogoSize", "QrCodeLogoPadding", "QrSize", "StyledSanityMonogram", "SanityMonogram", "MotionSpinner", "Spinner", "MotionText", "Text", "MotionMonogram", "SharePreviewMenu", "canToggleSharePreviewAccess", "canUseSharedPreviewAccess", "initialUrl", "push", "pushToast", "useToast", "apiVersion", "API_VERSION", "client", "useClient", "currentUser", "useCurrentUser", "setLoading", "enabling", "setEnabling", "disabling", "setDisabling", "secret", "setSecret", "busy", "setSecretSearchParams", "setError", "closable", "status", "handleUnableToToggle", "run", "disablePreviewAccessSharing", "location", "handleDisableSharing", "run_0", "previewUrlSecret", "enablePreviewAccessSharing", "handleEnableSharing", "run_1", "navigator", "clipboard", "writeText", "handleCopyUrl", "controller", "AbortController", "usedTags", "fetchShareSecret", "lastLiveEventId", "signal", "result", "syncTags", "fetch", "fetchSharedAccessQuery", "filterResponse", "tag", "aborted", "live", "events", "abort", "finally", "ShareIcon", "justifyContent", "alignItems", "gridTemplateColumns", "gridTemplateRows", "position", "aspectRatio", "display", "opacity", "textWrap", "textAlign", "CopyIcon", "constrainSize", "placement", "portal", "PreviewHeaderDefault", "canSharePreviewAccess", "iframeRef", "onPathChange", "onRefresh", "overlaysConnection", "presentationRef", "setViewport", "toggleOverlay", "viewport", "toggleViewportSize", "send", "handleRefresh", "isLoading", "isLoaded", "isRefreshing", "isReloading", "overlaysEnabled", "previewURL", "withoutSecretSearchParams", "perspectiveToggleTooltipId", "previewUrlBusy", "PanelLeftIcon", "content", "fallbackPlacements", "whiteSpace", "marginTop", "marginBottom", "lineHeight", "borderRadius", "margin", "t23", "t24", "t25", "t26", "t27", "t28", "t29", "RefreshIcon", "t30", "t31", "t32", "t33", "node", "setProperty", "t34", "t35", "t36", "t37", "t38", "t39", "MobileDeviceIcon", "DesktopIcon", "t40", "t41", "t42", "t43", "PreviewHeader", "renderDefault", "HeaderComponent", "header", "minHeight", "matches", "state_0", "state_1", "state_2", "state_3", "state_4", "hasTag", "MotionFlex", "Preview", "loadersConnection", "vercelProtectionBypass", "stablePerspective", "setStablePerspective", "urlPerspective", "useMemo", "urlSearchParamVercelProtectionBypass", "urlSearchParamVercelSetBypassCookie", "prefersReducedMotion", "usePrefersReducedMotion", "previewHeader", "timedOut", "setTimedOut", "somethingIsWrong", "setSomethingIsWrong", "iframeIsBusy", "useCallback", "continueAnyway", "setContinueAnyway", "handleContinueAnyway", "showOverlaysConnectionStatus", "setShowOverlaysConnectionState", "MAX_TIME_TO_OVERLAYS_CONNECTION", "onIFrameLoad", "preventIframeInteraction", "canUseViewTransition", "useSyncExternalStore", "CSS", "supports", "iframeAnimations", "currentViewport", "setCurrentViewport", "iframeStyle", "setIframeStyle", "iframeVariants", "update", "startViewTransition", "flushSync", "toast", "checkOrigin", "setCheckOrigin", "reportedMismatches", "Set", "reportMismatchingOrigin", "useEffectEvent", "reportedOrigin", "allow", "add", "duration", "Infinity", "usePresentationNavigate", "navigateEvent", "nextUrl", "hash", "contentWindow", "createController", "addTarget", "createChannel", "heartbeat", "connectTo", "createConnectionMachine", "provide", "createCompatibilityActors", "stop", "start", "destroy", "interval", "setInterval", "postMessage", "domain", "clearInterval", "spinnerVariants", "inset", "backdropFilter", "WebkitBackdropFilter", "WebkitTransition", "sizes", "errorVariants", "background", "displayName", "desktop", "mobile", "exit", "boxShadow", "scale", "active", "defineWarnOnce", "warned", "warnOnceAboutCrossDatasetReference", "useDocumentsOnPage", "frameStateRef", "validateApiPerspective", "published", "setPublished", "previewDrafts", "setPreviewDrafts", "urlRef", "perspective_0", "documents", "setCache", "cache", "isEqual", "setDocumentsOnPage", "keyedCache", "uniqueDocuments", "cache_0", "forEach", "sourceDocument", "_projectId", "fnOrObj", "arg", "Function", "getQueryFromResult", "resolver", "resolve", "getParamsFromResult", "getRouteContext", "route", "routes", "absolute", "match", "decode", "decodeURIComponent", "cause", "useMainDocument", "navigationHistory", "resolvers", "relativeUrl", "setMainDocumentState", "mainDocumentIdRef", "at", "handleResponse", "url_0", "query", "then", "doc_0", "catch", "parseId", "rawId", "segments", "split", "shift", "parsePath", "rawPath", "urlStringToPath", "parseRouterState", "pruneObject", "exhaustiveTupleOf", "array", "maintainOnDocumentChange", "maintainOnSameDocument", "useParams", "initialPreviewUrl", "routerNavigate", "changesInspectorTab", "comment", "inspect", "instruction", "pathKey", "rev", "scheduledDraft", "since", "view", "routerStateRef", "setNavigationHistory", "type_0", "isSameDocument", "params_0", "current_0", "currentState", "currentParams", "nextState", "nextRouterState", "usePopups", "popups", "setPopups", "source", "open", "unsubs", "size", "source_0", "closed", "source_1", "source_2", "POPUP_CHECK_INTERVAL", "unsub", "usePresentationPerspective", "selectedPerspectiveName", "selectedReleaseId", "useStatus", "statusMap", "setStatusMap", "handshaking", "memoStatus", "connection", "hasConnected_0", "hasConnected", "status_1", "setStatusFromEvent", "status_0", "LiveQueries", "PostMessageDocuments", "PostMessageRefreshMutations", "PostMessagePerspective", "PostMessagePreviewSnapshots", "PostMessageSchema", "PostMessageTelemetry", "PresentationTool", "tool", "components", "DEFAULT_TOOL_NAME", "unstable_header", "option", "hostname", "setController", "visualEditingComlink", "setVisualEditingComlink", "useActorRef", "projectId", "useProjectId", "dataset", "useDataset", "mainDocuments", "setOverlaysConnection", "setLoadersConnection", "previewKitConnection", "setPreviewKitConnection", "controller_0", "handleNavigate", "refreshRef", "data_0", "urlWithoutSearch", "searchParams_0", "URLSearchParams", "data_1", "data_2", "data_3", "data_4", "onStatus", "comlink_0", "data_5", "nextPath", "handlePreviewPath", "handleStructureParams", "frameOrigin", "previewOrigin", "url_1", "newUrl", "displayedDocument", "handleKeyUp", "isAltKey", "handleKeydown", "e_0", "isHotkey", "boundaryElement", "setBoundaryElement", "PresentationNavigator", "livePreviewEnabled", "workspace", "useWorkspace", "COMMENTS_INSPECTOR_NAME", "mode", "EDIT_INTENT_MODE", "t44", "t45", "t46", "t47", "t48", "t49", "t50", "t51", "previewMode", "shareAccess", "IS_MAC", "platform", "MODIFIERS", "alt", "ctrl", "mod", "keys", "every", "toUpperCase", "defineCreatePreviewSecretActor", "currentUserId", "fromPromise", "createPreviewSecret", "defineReadSharedSecretActor", "defineResolveAllowPatternsActor", "allowOption", "input", "URLPattern", "maybePatterns", "urlPatterns", "urlPattern", "defineResolveInitialUrlActor", "studioBasePath", "previewUrlOption", "studioPreviewPerspective", "previewSearchParam", "defineResolvePreviewModeActor", "draftMode", "enable", "defineResolvePreviewModeUrlActor", "resolvedPreviewMode", "urlSearchParamPreviewSecret", "urlSearchParamPreviewPathname", "resolveUrlFromPreviewSearchParamActor", "previewSearchParamUrl", "shareAccessSingletonDocument", "schemaIdSingleton", "schemaTypeSingleton", "previewUrlSecretDocument", "previewUrlMachine", "log", "_", "fromObservable", "throwError", "Promise", "reject", "has checked permissions", "Boolean", "previewAccessSharingCreatePermission", "previewAccessSharingReadPermission", "previewAccessSharingUpdatePermission", "previewUrlSecretPermission", "search param has new origin", "can create preview secret", "granted", "has preview mode with created secret", "has preview mode with share access", "has preview mode without permissions", "delays", "expiredSecret", "expiresAt", "now", "Date", "getTime", "invoke", "checkPermissionName", "onError", "onSnapshot", "checkingPermissions", "always", "guard", "resolvingInitialUrl", "onDone", "output", "resolvingAllowPatterns", "resolvingUrlFromPreviewSearchParam", "resolvingPreviewMode", "reenter", "success", "readShareAccess", "resolvePreviewUrl", "after", "usePreviewUrlActorRef", "grantsStore", "useGrantsStore", "router", "checkDocumentPermission", "actorRef", "useReportInvalidPreviewSearchParam", "currentOrigin", "nextOrigin", "blockedOrigin", "useVercelBypassSecret", "vercelProtectionBypassReadyState", "ready", "useReducer", "vercelProtectionBypassSecret", "setVercelProtectionBypassSecret", "subscribeToVercelProtectionBypass", "PresentationToolGrantsCheck"]
}
